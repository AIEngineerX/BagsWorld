class i{config={name:"BagsDungeon",host:"localhost",ssl:!1,serverId:1,sentryDsn:"",acceptLicense:!0,version:"0.5.5-beta",minor:"",port:9001,hub:!1};parameters=new URLSearchParams(window.location.search);token=this.parameters.get("token");id=this.parameters.get("id");confirm=document.querySelector("#confirm-reset");validation=document.querySelectorAll(".validation-summary");password=document.querySelector("#password-input");passwordConfirm=document.querySelector("#password-confirm-input");constructor(){this.token&&this.id?this.confirm.addEventListener("click",(()=>this.reset())):this.setValidation("validation-error","Invalid reset link.")}async reset(){if(!this.token||!this.id)return;let t=this.password.value,e=this.passwordConfirm.value;if(0===t.length)return void this.setValidation("validation-error","Password cannot be empty.");if(t.length<3)return void this.setValidation("validation-error","Password must be at least 3 characters long.");if(t.length>64)return void this.setValidation("validation-error","Password cannot be longer than 64 characters.");if(t!==e)return void this.setValidation("validation-error","Passwords do not match.");let i=await fetch(`${this.config.hub}/api/v1/resetPassword`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:this.id,token:this.token,password:t})}).catch((()=>null));return i?"success"!==(await i.json())?.status?this.setValidation("validation-error","Your password reset link has expired. Please try again."):(this.setValidation("status","Password reset successfully, redirecting in 5 seconds..."),void setTimeout((()=>window.location.href="/"),5e3)):this.setValidation("validation-error","Something went wrong. Please try again later.")}setValidation(t,e=""){this.clearValidation();for(let i of this.validation)i.append(this.createValidation(t,e))}createValidation(t,e=""){let i=document.createElement("span");return i.classList.add(t),i.classList.add("blink"),i.textContent=e,i}clearValidation(){for(let t of this.validation)t.innerHTML=""}}window.addEventListener("load",(()=>new i));