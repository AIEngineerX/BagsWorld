let An=class{constructor(e){this.level=e}info(...e){(this.level==="debug"||this.level==="info")&&console.info(...e)}debug(...e){this.level==="debug"&&console.debug(...e)}error(...e){console.error(...e)}};const L=new An("info"),Nn="modulepreload",Ln=function(i){return"/games/dungeon/"+i},ws={},On=function(e,t,s){if(!t||t.length===0)return e();const a=document.getElementsByTagName("link");return Promise.all(t.map(n=>{if(n=Ln(n),n in ws)return;ws[n]=!0;const r=n.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(!!s)for(let d=a.length-1;d>=0;d--){const c=a[d];if(c.href===n&&(!r||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${o}`))return;const l=document.createElement("link");if(l.rel=r?"stylesheet":Nn,r||(l.as="script",l.crossOrigin=""),l.href=n,document.head.appendChild(l),r)return new Promise((d,c)=>{l.addEventListener("load",d),l.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e()).catch(n=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n})};function Rn(i={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:s,onRegistered:a,onRegisteredSW:n,onRegisterError:r}=i;let o,h;const l=async(c=!0)=>{await h};async function d(){if("serviceWorker"in navigator){const{Workbox:c}=await On(()=>import("./workbox-window.prod.es5.a7b12eab.js"),[]);o=new c("/games/dungeon/sw.js",{scope:"/games/dungeon/",type:"classic"}),o.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),o.addEventListener("installed",u=>{u.isUpdate||s?.()}),o.register({immediate:e}).then(u=>{n?n("/games/dungeon/sw.js",u):a?.(u)}).catch(u=>{r?.(u)})}}return h=d(),l}let pt;async function xn(){pt&&(localStorage.getItem("prompted")!=="true"&&await pt.prompt().catch(i=>L.error("[SW ERROR]",i)),await pt.userChoice,localStorage.setItem("prompted","true"),pt=null)}function Dn(){window.addEventListener("beforeinstallprompt",i=>{i.preventDefault(),pt=i}),Rn({immediate:!0})}"serviceWorker"in navigator&&Dn();let Me=navigator.userAgent.toLowerCase(),Yn=()=>window.innerWidth>=1500,Mn=()=>Me.includes("iphone")||Me.includes("ipad"),le=()=>Me.includes("android")||Me.includes("iphone")||Me.includes("ipad"),Pn=()=>le()&&window.innerWidth>=640,Fn=()=>Me.includes("mac")&&Me.includes("firefox");function Un(){try{let i=document.createElement("canvas");return!!(window.WebGLRenderingContext&&i.getContext("webgl"))}catch{return!1}}var Jt=(i=>(i[i.Login=0]="Login",i[i.Register=1]="Register",i[i.Guest=2]="Guest",i))(Jt||{}),zi=(i=>(i[i.Spawns=0]="Spawns",i[i.Positions=1]="Positions",i))(zi||{}),Be=(i=>(i[i.Batch=0]="Batch",i[i.Equip=1]="Equip",i[i.Unequip=2]="Unequip",i[i.Style=3]="Style",i))(Be||{}),ue=(i=>(i[i.Request=0]="Request",i[i.Started=1]="Started",i[i.Step=2]="Step",i[i.Stop=3]="Stop",i[i.Move=4]="Move",i[i.Follow=5]="Follow",i[i.Entity=6]="Entity",i[i.Speed=7]="Speed",i))(ue||{}),xe=(i=>(i[i.Talk=0]="Talk",i[i.Attack=1]="Attack",i[i.None=2]="None",i[i.Object=3]="Object",i))(xe||{}),va=(i=>(i[i.Initiate=0]="Initiate",i[i.Hit=1]="Hit",i[i.Finish=2]="Finish",i[i.Sync=3]="Sync",i))(va||{}),ei=(i=>(i[i.Ping=0]="Ping",i[i.Pong=1]="Pong",i[i.Sync=2]="Sync",i))(ei||{}),Ne=(i=>(i[i.Batch=0]="Batch",i[i.Add=1]="Add",i[i.Remove=2]="Remove",i[i.Select=3]="Select",i[i.Swap=4]="Swap",i))(Ne||{}),wt=(i=>(i[i.Batch=0]="Batch",i[i.Add=1]="Add",i[i.Update=2]="Update",i[i.Use=3]="Use",i[i.QuickSlot=4]="QuickSlot",i[i.Toggle=5]="Toggle",i))(wt||{}),nt=(i=>(i[i.Batch=0]="Batch",i[i.Progress=1]="Progress",i[i.Finish=2]="Finish",i[i.Start=3]="Start",i))(nt||{}),li=(i=>(i[i.Batch=0]="Batch",i[i.Progress=1]="Progress",i))(li||{}),Bi=(i=>(i[i.Ok=0]="Ok",i[i.YesNo=1]="YesNo",i[i.Text=2]="Text",i[i.Popup=3]="Popup",i))(Bi||{}),Xi=(i=>(i[i.Sync=0]="Sync",i[i.Skill=1]="Skill",i))(Xi||{}),ti=(i=>(i[i.Talk=0]="Talk",i[i.Store=1]="Store",i[i.Bank=2]="Bank",i[i.Enchant=3]="Enchant",i[i.Countdown=4]="Countdown",i))(ti||{}),ce=(i=>(i[i.Request=0]="Request",i[i.Add=1]="Add",i[i.Remove=2]="Remove",i[i.Accept=3]="Accept",i[i.Close=4]="Close",i[i.Open=5]="Open",i))(ce||{}),hi=(i=>(i[i.Select=0]="Select",i[i.Confirm=1]="Confirm",i))(hi||{}),B=(i=>(i[i.Create=0]="Create",i[i.Login=1]="Login",i[i.Logout=2]="Logout",i[i.Join=3]="Join",i[i.Leave=4]="Leave",i[i.Rank=5]="Rank",i[i.Update=6]="Update",i[i.Experience=7]="Experience",i[i.Banner=8]="Banner",i[i.List=9]="List",i[i.Error=10]="Error",i[i.Chat=11]="Chat",i[i.Promote=12]="Promote",i[i.Demote=13]="Demote",i[i.Kick=14]="Kick",i))(B||{}),Ve=(i=>(i[i.Location=0]="Location",i[i.Entity=1]="Entity",i[i.Relative=2]="Relative",i[i.Remove=3]="Remove",i))(Ve||{}),We=(i=>(i[i.Open=0]="Open",i[i.Close=1]="Close",i[i.Buy=2]="Buy",i[i.Sell=3]="Sell",i[i.Update=4]="Update",i[i.Select=5]="Select",i))(We||{}),ii=(i=>(i[i.Set=0]="Set",i[i.Remove=1]="Remove",i[i.Lamp=2]="Lamp",i[i.RemoveLamps=3]="RemoveLamps",i[i.Darkness=4]="Darkness",i))(ii||{}),Ia=(i=>(i[i.CtrlClick=0]="CtrlClick",i))(Ia||{}),Hi=(i=>(i[i.Batch=0]="Batch",i[i.Update=1]="Update",i))(Hi||{}),Nt=(i=>(i[i.TeamWar=0]="TeamWar",i[i.Coursing=1]="Coursing",i))(Nt||{}),_t=(i=>(i[i.Score=0]="Score",i[i.End=1]="End",i[i.Lobby=2]="Lobby",i[i.Exit=3]="Exit",i))(_t||{}),Ca=(i=>(i[i.Entity=0]="Entity",i[i.Position=1]="Position",i))(Ca||{}),Gi=(i=>(i[i.Add=0]="Add",i[i.Remove=1]="Remove",i))(Gi||{}),ge=(i=>(i[i.List=0]="List",i[i.Add=1]="Add",i[i.Remove=2]="Remove",i[i.Status=3]="Status",i[i.Sync=4]="Sync",i))(ge||{}),Lt=(i=>(i[i.Open=0]="Open",i[i.Select=1]="Select",i[i.Craft=2]="Craft",i))(Lt||{}),Tt=(i=>(i[i.Open=0]="Open",i[i.Take=1]="Take",i[i.Close=2]="Close",i))(Tt||{}),Aa=(i=>(i[i.Pickup=0]="Pickup",i))(Aa||{}),Vi=(i=>(i[i.Open=0]="Open",i[i.Close=1]="Close",i))(Vi||{});Ve.Remove;var G=(i=>(i[i.Bank=0]="Bank",i[i.Inventory=1]="Inventory",i[i.Trade=2]="Trade",i[i.LootBag=3]="LootBag",i))(G||{}),A=(i=>(i[i.Up=0]="Up",i[i.Down=1]="Down",i[i.Left=2]="Left",i[i.Right=3]="Right",i))(A||{}),C=(i=>(i[i.Player=0]="Player",i[i.NPC=1]="NPC",i[i.Item=2]="Item",i[i.Mob=3]="Mob",i[i.Chest=4]="Chest",i[i.Projectile=5]="Projectile",i[i.Object=6]="Object",i[i.Pet=7]="Pet",i[i.LootBag=8]="LootBag",i[i.Effect=9]="Effect",i[i.Tree=10]="Tree",i[i.Rock=11]="Rock",i[i.Foraging=12]="Foraging",i[i.FishSpot=13]="FishSpot",i))(C||{}),K=(i=>(i[i.Inventory=0]="Inventory",i[i.Crafting=1]="Crafting",i[i.Spells=2]="Spells",i[i.Bank=3]="Bank",i[i.Store=4]="Store",i[i.Quests=5]="Quests",i[i.Quest=6]="Quest",i[i.Achievements=7]="Achievements",i[i.Skills=8]="Skills",i[i.Trade=9]="Trade",i[i.Settings=10]="Settings",i[i.Warp=11]="Warp",i[i.Leaderboards=12]="Leaderboards",i[i.Guilds=13]="Guilds",i[i.Friends=14]="Friends",i[i.Enchant=15]="Enchant",i[i.Customization=16]="Customization",i[i.Book=17]="Book",i[i.Lootbag=18]="Lootbag",i[i.Equipments=19]="Equipments",i[i.Welcome=20]="Welcome",i))(K||{}),Na=(i=>(i[i.Active=0]="Active",i[i.Passive=1]="Passive",i))(Na||{}),ae=(i=>(i[i.Idle=0]="Idle",i[i.Attack=1]="Attack",i[i.Walk=2]="Walk",i[i.Orientate=3]="Orientate",i))(ae||{}),P=(i=>(i.Attack="attack",i.Equip="equip",i.DropOne="drop-one",i.DropMany="drop-many",i.Eat="eat",i.Interact="interact",i.Trade="trade",i.Potion="potion",i.Follow="follow",i.Examine="examine",i.AddFriend="addfriend",i))(P||{}),X=(i=>(i[i.Normal=0]="Normal",i[i.Poison=1]="Poison",i[i.Heal=2]="Heal",i[i.Mana=3]="Mana",i[i.Experience=4]="Experience",i[i.LevelUp=5]="LevelUp",i[i.Critical=6]="Critical",i[i.Stun=7]="Stun",i[i.Profession=8]="Profession",i[i.Freezing=9]="Freezing",i[i.Burning=10]="Burning",i[i.Terror=11]="Terror",i[i.Explosive=12]="Explosive",i))(X||{}),_=(i=>(i[i.Helmet=0]="Helmet",i[i.Pendant=1]="Pendant",i[i.Arrows=2]="Arrows",i[i.Chestplate=3]="Chestplate",i[i.Weapon=4]="Weapon",i[i.Shield=5]="Shield",i[i.Ring=6]="Ring",i[i.ArmourSkin=7]="ArmourSkin",i[i.WeaponSkin=8]="WeaponSkin",i[i.Legplates=9]="Legplates",i[i.Cape=10]="Cape",i[i.Boots=11]="Boots",i))(_||{});let _s=[10,9,3,0,7,5,4,8];var J=(i=>(i[i.None=0]="None",i[i.Stab=1]="Stab",i[i.Slash=2]="Slash",i[i.Defensive=3]="Defensive",i[i.Crush=4]="Crush",i[i.Shared=5]="Shared",i[i.Hack=6]="Hack",i[i.Chop=7]="Chop",i[i.Accurate=8]="Accurate",i[i.Fast=9]="Fast",i[i.Focused=10]="Focused",i[i.LongRange=11]="LongRange",i))(J||{}),pe=(i=>(i[i.Colliding=0]="Colliding",i[i.Mob=1]="Mob",i[i.Player=2]="Player",i[i.Item=3]="Item",i[i.NPC=4]="NPC",i[i.Chest=5]="Chest",i[i.Object=6]="Object",i[i.Tree=7]="Tree",i[i.Rock=8]="Rock",i[i.FishSpot=9]="FishSpot",i[i.Foraging=10]="Foraging",i))(pe||{}),ne=(i=>(i[i.Lumberjacking=0]="Lumberjacking",i[i.Accuracy=1]="Accuracy",i[i.Archery=2]="Archery",i[i.Health=3]="Health",i[i.Magic=4]="Magic",i[i.Mining=5]="Mining",i[i.Strength=6]="Strength",i[i.Defense=7]="Defense",i[i.Fishing=8]="Fishing",i[i.Cooking=9]="Cooking",i[i.Smithing=10]="Smithing",i[i.Crafting=11]="Crafting",i[i.Chiseling=12]="Chiseling",i[i.Fletching=13]="Fletching",i[i.Smelting=14]="Smelting",i[i.Foraging=15]="Foraging",i[i.Eating=16]="Eating",i[i.Loitering=17]="Loitering",i[i.Alchemy=18]="Alchemy",i))(ne||{});let La=[3,1,6,7,2,4,0,5,8,15,11,9,13,10,18,16,17];var Oa=(i=>(i[i.Bloodsucking=0]="Bloodsucking",i[i.Critical=1]="Critical",i[i.Evasion=2]="Evasion",i[i.Thorns=3]="Thorns",i[i.Explosive=4]="Explosive",i[i.Stun=5]="Stun",i[i.AntiStun=6]="AntiStun",i[i.Splash=7]="Splash",i[i.DoubleEdged=8]="DoubleEdged",i))(Oa||{}),N=(i=>(i[i.None=0]="None",i[i.Critical=1]="Critical",i[i.Terror=2]="Terror",i[i.TerrorStatus=3]="TerrorStatus",i[i.Stun=4]="Stun",i[i.Healing=5]="Healing",i[i.Fireball=6]="Fireball",i[i.Iceball=7]="Iceball",i[i.Poisonball=8]="Poisonball",i[i.Boulder=9]="Boulder",i[i.Running=10]="Running",i[i.HotSauce=11]="HotSauce",i[i.DualistsMark=12]="DualistsMark",i[i.ThickSkin=13]="ThickSkin",i[i.SnowPotion=14]="SnowPotion",i[i.FirePotion=15]="FirePotion",i[i.Burning=16]="Burning",i[i.Freezing=17]="Freezing",i[i.Invincible=18]="Invincible",i[i.AccuracyBuff=19]="AccuracyBuff",i[i.StrengthBuff=20]="StrengthBuff",i[i.DefenseBuff=21]="DefenseBuff",i[i.MagicBuff=22]="MagicBuff",i[i.ArcheryBuff=23]="ArcheryBuff",i[i.AccuracySuperBuff=24]="AccuracySuperBuff",i[i.StrengthSuperBuff=25]="StrengthSuperBuff",i[i.DefenseSuperBuff=26]="DefenseSuperBuff",i[i.MagicSuperBuff=27]="MagicSuperBuff",i[i.ArcherySuperBuff=28]="ArcherySuperBuff",i[i.Bleed=29]="Bleed",i))(N||{}),z=(i=>(i[i.None=0]="None",i[i.Silver=1]="Silver",i[i.Gold=2]="Gold",i[i.Artist=3]="Artist",i[i.Tier1=4]="Tier1",i[i.Tier2=5]="Tier2",i[i.Tier3=6]="Tier3",i[i.Tier4=7]="Tier4",i[i.Tier5=8]="Tier5",i[i.Tier6=9]="Tier6",i[i.Tier7=10]="Tier7",i))(z||{}),Q=(i=>(i[i.None=0]="None",i[i.Moderator=1]="Moderator",i[i.Admin=2]="Admin",i[i.Veteran=3]="Veteran",i[i.Patron=4]="Patron",i[i.Artist=5]="Artist",i[i.Cheater=6]="Cheater",i[i.TierOne=7]="TierOne",i[i.TierTwo=8]="TierTwo",i[i.TierThree=9]="TierThree",i[i.TierFour=10]="TierFour",i[i.TierFive=11]="TierFive",i[i.TierSix=12]="TierSix",i[i.TierSeven=13]="TierSeven",i[i.HollowAdmin=14]="HollowAdmin",i[i.Booster=15]="Booster",i))(Q||{});let bs={0:"",1:"#02f070",2:"#3bbaff",3:"#d84343",4:"#db753c",5:"#b552f7",6:"#ffffff",7:"#db963c",8:"#e6c843",9:"#d6e34b",10:"#a9e03a",11:"#7beb65",12:"#77e691",13:"#77e691",14:"#3bbaff",15:"#f47fff"},qn={0:"",1:"Mod",2:"Admin",3:"Veteran",4:"Patron",5:"Artist",6:"Cheater",7:"T1 Patron",8:"T2 Patron",9:"T3 Patron",10:"T4 Patron",11:"T5 Patron",12:"T6 Patron",13:"T7 Patron",14:"Admin",15:"Booster"},ys={0:{fill:"rgb(255, 50, 50)",stroke:"rgb(255, 180, 180)",inflicted:{fill:"white",stroke:"#373737"}},12:{fill:"rgb(255, 50, 50)",stroke:"rgb(255, 180, 180)",inflicted:{fill:"white",stroke:"#373737"}},6:{fill:"rgb(204, 0, 204)",stroke:"rgb(255, 180, 180)",inflicted:{fill:"rgb(255, 153, 204)",stroke:"#373737"}},1:{fill:"rgb(66, 183, 77)",stroke:"rgb(50, 120 , 50)"},2:{fill:"rgb(80, 255, 80)",stroke:"rgb(50, 120, 50)"},3:{fill:"rgb(73, 94, 228)",stroke:"rgb(56, 63, 133)"},4:{fill:"rgb(80, 180, 255)",stroke:"rgb(15, 85, 138)"},5:{fill:"rgb(80, 180, 255)",stroke:"rgb(15, 85, 138)"},8:{fill:"rgb(204, 0, 153)",stroke:"rgb(112, 17, 112)"},9:{fill:"rgb(52, 195, 235)",stroke:"rgb(14, 138, 227)"},10:{fill:"rgb(227, 170, 14)",stroke:"rgb(235, 135, 52)"},11:{fill:"rgb(89, 21, 125)",stroke:"rgb(136, 29, 194)"}},zn={0:{fill:"rgb(132, 57, 45)",stroke:"rgb(101, 48, 35)"},1:{fill:"rgb(6, 191, 188)",stroke:"rgb(2, 94, 93)"},2:{fill:"rgb(34, 214, 130)",stroke:"rgb(7, 184, 101)"},3:{fill:"rgb(239, 90, 90)",stroke:"rgb(255, 0, 0)"},4:{fill:"rgb(37, 124, 210)",stroke:"rgb(12, 55, 208)"},5:{fill:"rgb(105, 106, 107)",stroke:"rgb(45, 45, 46)"},6:{fill:"rgb(232, 211, 185)",stroke:"rgb(189, 172, 151)"},7:{fill:"rgb(110, 158, 255)",stroke:"rgb(7, 63, 176)"},8:{fill:"rgb(0, 170, 230)",stroke:"rgb(0, 100, 180)"},9:{fill:"rgb(255, 165, 0)",stroke:"rgb(205, 133, 0)"},10:{fill:"rgb(132, 57, 45)",stroke:"rgb(101, 48, 35)"},11:{fill:"rgb(128, 0, 128)",stroke:"rgb(85, 0, 85)"},12:{fill:"rgb(188, 143, 143)",stroke:"rgb(139, 100, 100)"},13:{fill:"rgb(139, 69, 19)",stroke:"rgb(85, 40, 0)"},14:{fill:"rgb(255, 99, 71)",stroke:"rgb(205, 50, 25)"},15:{fill:"rgb(124, 252, 0)",stroke:"rgb(85, 180, 0)"},16:{fill:"rgb(255, 228, 196)",stroke:"rgb(238, 213, 183)"},17:{fill:"rgb(221, 160, 221)",stroke:"rgb(199, 120, 199)"},18:{fill:"rgb(255, 215, 0)",stroke:"rgb(218, 165, 0)"}};var St=(i=>(i[i.Fledgling=0]="Fledgling",i[i.Emergent=1]="Emergent",i[i.Established=2]="Established",i[i.Adept=3]="Adept",i[i.Veteran=4]="Veteran",i[i.Elite=5]="Elite",i[i.Master=6]="Master",i[i.Landlord=7]="Landlord",i))(St||{}),Se=(i=>(i.Grey="grey",i.Green="green",i.Fuchsia="fuchsia",i.Red="red",i.Brown="brown",i.Cyan="cyan",i.DarkGrey="darkgrey",i.Teal="teal",i.GoldenYellow="goldenyellow",i))(Se||{}),bt=(i=>(i[i.StyleOne=0]="StyleOne",i[i.StyleTwo=1]="StyleTwo",i[i.StyleThree=2]="StyleThree",i[i.StyleFour=3]="StyleFour",i[i.StyleFive=4]="StyleFive",i))(bt||{}),Wi=(i=>(i.None="none",i.Star="star",i.Hawk="hawk",i.Phoenix="phoenix",i))(Wi||{});const he={MAX_STACK:2147483647,MAX_LEVEL:120,INVENTORY_SIZE:25,BANK_SIZE:420,DROP_PROBABILITY:1e5,MAX_PROFESSION_LEVEL:99,HEAL_RATE:7e3,EFFECT_RATE:1e4,STORE_UPDATE_FREQUENCY:2e4,MAP_DIVISION_SIZE:48,SPAWN_POINT:"328,892",TUTORIAL_QUEST_KEY:"tutorial",ALCHEMY_QUEST_KEY:"scientistspotion",CRAFTING_QUEST_KEY:"artsandcrafts",TUTORIAL_SPAWN_POINT:"133,562",JAIL_SPAWN_POINT:"110,915",RESOURCE_RESPAWN:3e4,TREE_RESPAWN:25e3,CHEST_RESPAWN:5e4,SKILL_LOOP:1e3,MAX_ACCURACY:.45,EDIBLE_COOLDOWN:1500,CRAFT_COOLDOWN:1500,ARCHER_ATTACK_RANGE:8,MAX_CONNECTIONS:16,EXPERIENCE_PER_HIT:2,SNOW_POTION_DURATION:6e4,FIRE_POTION_DURATION:6e4,FREEZING_DURATION:6e4,BURNING_DURATION:6e4,TERROR_DURATION:6e4,LOITERING_THRESHOLD:9e4,STUN_DURATION:1e4,COLD_EFFECT_DAMAGE:10,BURNING_EFFECT_DAMAGE:20,ATTACKER_TIMEOUT:2e4,MAX_GUILD_MEMBERS:50,EVENTS_CHECK_INTERVAL:36e5};var Re=(i=>(i[i.DIAGONAL_FLAG=536870912]="DIAGONAL_FLAG",i[i.VERTICAL_FLAG=1073741824]="VERTICAL_FLAG",i[i.HORIZONTAL_FLAG=2147483648]="HORIZONTAL_FLAG",i))(Re||{}),at=(i=>(i[i.Default=0]="Default",i[i.Depleted=1]="Depleted",i))(at||{}),p=(i=>(i[i.Connected=0]="Connected",i[i.Handshake=1]="Handshake",i[i.Login=2]="Login",i[i.Welcome=3]="Welcome",i[i.Map=4]="Map",i[i.Spawn=5]="Spawn",i[i.List=6]="List",i[i.Who=7]="Who",i[i.Equipment=8]="Equipment",i[i.Ready=9]="Ready",i[i.Sync=10]="Sync",i[i.Movement=11]="Movement",i[i.Teleport=12]="Teleport",i[i.Despawn=13]="Despawn",i[i.Target=14]="Target",i[i.Combat=15]="Combat",i[i.Animation=16]="Animation",i[i.Points=17]="Points",i[i.Network=18]="Network",i[i.Chat=19]="Chat",i[i.Command=20]="Command",i[i.Container=21]="Container",i[i.Ability=22]="Ability",i[i.Quest=23]="Quest",i[i.Achievement=24]="Achievement",i[i.Notification=25]="Notification",i[i.Blink=26]="Blink",i[i.Heal=27]="Heal",i[i.Experience=28]="Experience",i[i.Death=29]="Death",i[i.Music=30]="Music",i[i.NPC=31]="NPC",i[i.Respawn=32]="Respawn",i[i.Trade=33]="Trade",i[i.Enchant=34]="Enchant",i[i.Guild=35]="Guild",i[i.Pointer=36]="Pointer",i[i.PVP=37]="PVP",i[i.Poison=38]="Poison",i[i.Warp=39]="Warp",i[i.Store=40]="Store",i[i.Overlay=41]="Overlay",i[i.Camera=42]="Camera",i[i.Bubble=43]="Bubble",i[i.Skill=44]="Skill",i[i.Update=45]="Update",i[i.Minigame=46]="Minigame",i[i.Effect=47]="Effect",i[i.Friends=48]="Friends",i[i.Focus=49]="Focus",i[i.Rank=50]="Rank",i[i.Examine=51]="Examine",i[i.Player=52]="Player",i[i.Relay=53]="Relay",i[i.Crafting=54]="Crafting",i[i.Interface=55]="Interface",i[i.LootBag=56]="LootBag",i[i.Countdown=57]="Countdown",i[i.Pet=58]="Pet",i[i.Resource=59]="Resource",i[i.AdminSync=60]="AdminSync",i))(p||{});let Gt=window.localStorage,Si="data";class Bn{data;mapData;newVersion=!1;constructor(){this.data=Gt.data?JSON.parse(Gt.getItem(Si)):this.create(),this.newVersion=this.isNewVersion(),this.newVersion?(this.set(this.create()),this.clearIndexedDB()):this.loadIndexedDB()}create(){return{new:!0,world:1,clientVersion:"0.5.5-beta",errorMessage:"",player:{username:"",password:"",autoLogin:!1,rememberMe:!1,orientation:A.Down,zoom:3},settings:{musicVolume:25,soundVolume:25,brightness:100,audioEnabled:!le(),lowPowerMode:!1,joyStickEnabled:!1,debugMode:!1,showNames:!0,showLevels:!0,disableCaching:!1,webgl:!1,fpsThrottle:Mn()?1:0}}}loadIndexedDB(){let e=window.indexedDB?.open("mapCache",this.getDBVersion());e.addEventListener("error",()=>{this.clearIndexedDB()}),e.addEventListener("upgradeneeded",t=>{let s=t.target.result;s||console.error("Could not open IndexedDB database."),s.createObjectStore("regions"),s.createObjectStore("objects"),s.createObjectStore("cursorTiles"),L.debug(`IndexedDB created with version ${this.getDBVersion()}.`)}),e.addEventListener("success",t=>{this.mapData=t.target.result,L.debug(`Successfully opened IndexedDB with version ${this.getDBVersion()}.`)})}save(){try{this.data&&Gt.setItem(Si,JSON.stringify(this.data))}catch(e){console.error(e)}}clear(){Gt.removeItem(Si),this.set(this.create()),this.save()}clearIndexedDB(){this.mapData?.close(),window.indexedDB.deleteDatabase("mapCache"),this.loadIndexedDB()}set(e){this.data=e,this.save()}setError(e){return this.data.errorMessage=e,this.save(),!0}setRemember(e){this.data.player.rememberMe=e,this.save()}setCredentials(e="",t=""){this.data.player.username=e,this.data.player.password=t,this.save()}setMusicVolume(e=100){this.data.settings.musicVolume=e,this.save()}setSoundVolume(e=100){this.data.settings.soundVolume=e,this.save()}setBrightness(e=100){this.data.settings.brightness=e,this.save()}setAudioEnabled(e){this.data.settings.audioEnabled=e,this.save()}setLowPowerMode(e){this.data.settings.lowPowerMode=e,this.save()}setJoyStickEnabled(e){this.data.settings.joyStickEnabled=e,this.save()}setDebug(e){this.data.settings.debugMode=e,this.save()}setShowNames(e){this.data.settings.showNames=e,this.save()}setShowLevels(e){this.data.settings.showLevels=e,this.save()}setDisableCaching(e){this.data.settings.disableCaching=e,this.save()}setWebGl(e){this.data.settings.webgl=e,this.save()}setOrientation(e){this.data.player.orientation=e,this.save()}setZoom(e){this.data.player.zoom=e,this.save()}setFpsThrottle(e){this.data.settings.fpsThrottle=e,this.save()}setMapData(e,t){if(!this.mapData)return;let s=this.mapData.transaction(["objects","cursorTiles"],"readwrite"),a=s.objectStore("objects"),n=s.objectStore("cursorTiles");a.put(e,0),n.put(t,0)}setRegionData(e,t){if(!this.mapData)return;let s=this.mapData.transaction("regions","readwrite").objectStore("regions"),a=s.get(t);a.addEventListener("success",()=>{a.result||s.put(e,t)})}getError(){let{errorMessage:e}=this.data;return this.data.errorMessage="",this.save(),e}getUsername(){return this.data.player.username}getPassword(){return this.data.player.password}getDBVersion(){return parseInt(this.data.clientVersion.replace(/\D/g,""))||1}hasRemember(){return this.data.player.rememberMe}isNew(){return this.data.new}isWebGl(){return this.data.settings.webgl}isNewVersion(){return this.data.clientVersion!=="0.5.5-beta"}getRegionData(e){let t={regionData:{},objects:[],cursorTiles:{}};if(!this.mapData)return e(t);let s=this.mapData.transaction(["regions","objects","cursorTiles"],"readonly"),a=s.objectStore("regions").openCursor(),n=s.objectStore("objects").get(0),r=s.objectStore("cursorTiles").get(0);s.addEventListener("error",()=>e(t)),a.addEventListener("success",o=>{let h=o.target.result;h&&(t.regionData[h.primaryKey]=h.value,h.continue())}),n.addEventListener("success",()=>t.objects=n.result),r.addEventListener("success",()=>t.cursorTiles=r.result),s.addEventListener("complete",()=>e(t))}getSettings(){return this.data.settings}getDebug(){return this.data.settings.debugMode}}let vt;const Ra=200;function di(){vt!==void 0&&(clearTimeout(vt),vt=void 0)}function xa(i,e){let t=document.querySelector("#game-container");i.addEventListener("contextmenu",s=>{s.preventDefault(),di(),e({x:s.clientX,y:s.clientY})}),t.addEventListener("contextmenu",s=>s.preventDefault()),i.addEventListener("touchstart",s=>{let[a]=s.touches;vt=window.setTimeout(()=>e({x:a.clientX,y:a.clientY}),Ra)}),t.addEventListener("touchmove",di)}function Da(i,e,t){let s=!1,a,n=document.querySelector("#game-container");i.addEventListener("mousedown",()=>r()),n.addEventListener("mousemove",d=>o(d.clientX,d.clientY)),n.addEventListener("mouseup",d=>h(d.clientX,d.clientY)),i.addEventListener("touchstart",()=>r(Ra)),n.addEventListener("touchmove",d=>{let[c]=d.touches;s&&d.preventDefault(),o(c.clientX,c.clientY)}),n.addEventListener("touchend",d=>{let[c]=d.changedTouches;h(c.clientX,c.clientY)}),n.addEventListener("touchcancel",l);function r(d){vt=window.setTimeout(()=>{t?.()||(l(),s=!0,a=i.cloneNode(!0),a.style.position="absolute",a.style.opacity="0.75",a.style.top=`${-i.clientHeight}px`,a.style.left=`${-i.clientWidth}px`,a.style.pointerEvents="none",a.style.touchAction="none",n?.append(a))},d)}function o(d,c){if(di(),!s||!a)return l();a.style.top=`${c-i.clientHeight/2}px`,a.style.left=`${d-i.clientWidth/2}px`}function h(d,c){if(!s)return l();let u=a;l();let g=document.elementFromPoint(d,c);!g||!u||e(u,g)}function l(){di(),s=!1,a?.remove(),a=void 0,i.classList.remove("active")}}class U{constructor(e,t,s,a,n,r=!1){this.name=e,this.length=t,this.row=s,this.width=a,this.height=n,this.withStop=r,this.reset()}frame={index:0,x:0,y:0};count=1;bopIndex=0;bopCount=4;decreaseBop=!1;stopped=!1;lastTime=Date.now();speed=100;bopCallback;endCallback;update(e){if(this.canAnimate()){if(this.lastTime=e,this.length===1)return this.decreaseBop?this.bopIndex--:this.bopIndex++,this.bopIndex>=this.bopCount?this.decreaseBop=!0:this.bopIndex<=0&&(this.decreaseBop=!1),this.bopCallback?.(this.bopIndex);if(this.frame.index>=this.length-1){if(this.count>0&&this.count--,this.count<=0&&this.endCallback?.(),this.withStop){this.stopped=!0;return}return this.reset()}this.frame.index++,this.frame.x=this.frame.index*this.width,this.frame.y=this.row*this.height}}setCount(e,t){this.count=e,this.endCallback=t}setSpeed(e){this.speed=e}setRow(e){this.row=e}canAnimate(){return Date.now()-this.lastTime>this.speed&&!this.stopped}getSecondFrame(){return{index:1,x:this.width,y:this.row*this.height}}reset(){this.lastTime=Date.now(),this.frame={index:0,x:0,y:this.row*this.height}}onBop(e){this.bopCallback=e}}class $i{constructor(e){this.data=e,this.key=e.id,this.path=`/img/sprites/${e.id}.png`;let t=m.getDefaultEquipmentDimension(this.getSubType()),s=m.getDefaultOffset(this.getType());this.width=this.data.width??t,this.height=this.data.height??t,this.preload=this.data.preload??!1,this.offsetX=this.data.offsetX??s.x,this.offsetY=this.data.offsetY??s.y,this.idleSpeed=this.data.idleSpeed||this.idleSpeed,this.loadAnimations()}key="";path="";width=m.tileSize;height=m.tileSize;offsetX=0;offsetY=0;idleSpeed=250;loaded=!1;preload=!1;hasDeathAnimation=!1;animations={};image;hurtSprite;silhouetteSprite;load(){this.loaded||(this.image=new Image,this.image.crossOrigin="Anonymous",this.image.src=this.path,this.image.addEventListener("load",()=>{this.loaded=!0,this.loadCallback?.()}))}loadHurtSprite(){this.hurtSprite||!this.hasHurtSprite()||!this.loaded||(this.hurtSprite=m.getHurtSprite(this))}loadSilhouetteSprite(){this.silhouetteSprite||!this.hasSilhouette()||le()||!this.loaded||(this.silhouetteSprite=m.getSilhouetteSprite(this))}loadAnimations(){this.data.animations||(this.data.animations=m.getDefaultAnimations(this.getType()));for(let e in this.data.animations){let t=this.data.animations[e];e==="death"&&(this.hasDeathAnimation=!0),this.animations[e]=new U(e,t.length,t.row,this.width,this.height)}}getType(){return this.key.includes("/")?this.key.split("/")[0]:"items"}getSubType(){let e=this.key.split("/");return e.length<3?"":e[1]}hasHurtSprite(){let e=this.getType();return e==="mobs"||e==="player"}hasSilhouette(){let e=this.getType();return["mobs","player","npcs","trees","rocks","fishspots","bushes"].includes(e)}onLoad(e){this.loadCallback=e}}const Xn={INVALID_DATA:"Invalid crafting data, please submit a bug report.",INVALID_ITEM:"Invalid item selected.",INVALID_ITEMS:"You do not have the required items to craft that.",SELECT_ITEM:"Please select an item to craft.",FAILED_CRAFT:"You have failed to craft {{failedText}}.",FAILED_CRAFT_ONE:" You have failed to craft the item."},Hn={NO_ITEM_SELECTED:"You have not selected an item to enchant.",CANNOT_ENCHANT:"The item you have selected cannot be enchanted.",NO_SHARD:"You must provide a shard to enchant an item.",FAILED_ENCHANT:"You tried enchanting but nothing happened.",SUCCESSFUL_ENCHANT:"You successfully enchanted your item."},Gn={ALREADY_EXISTS:"A guild with that name already exists.",ALREADY_IN_GUILD:"You are already in a guild.",CANNOT_KICK_YOURSELF:"You cannot kick yourself from the guild.",GUILD_FULL:"This guild is at maximum capacity.",MUST_FINISH_TUTORIAL_CREATE:"You must finish the tutorial before creating a guild.",NO_PERMISSION:"You do not have permission to do that.",NO_PERMISSION_RANK:"You do not have permission to update the rank of that member.",NOT_ENOUGH_GOLD:"You need 30,000 gold in your inventory to create a guild.",NOT_ALLOWED_GUESTS_JOIN:"Guests are not allowed to join guilds.",NOT_ALLOWED_GUESTS_CREATE:"Guests are not allowed to create guilds."},Vn={CANNOT_ACCESS_LOOTBAG:"You cannot access this lootbag right now.",REQUIRES_ACHIEVEMENT:"This item requires a secret achievement to equip.",REQUIRES_QUEST:"You must complete {{quest}} to equip this item.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Your {{skill}} must be at least level {{level}} to equip this.",TOTAL_LEVEL_REQUIREMENT:"Your total level must be at least {{level}} to equip this item."},Wn={ACCEPTED_TRADE:"You have accepted the trade.",ACCEPTED_TRADE_OTHER:"The other player has accepted the trade.",ALREADY_HAVE_PET:"You already have a pet.",BLACK_POTION:"You drink the black potion and start feeling unwell.",CANNOT_ADD_ITEMS_TRADE:"You cannot add any more items to the trade.",CANNOT_ATTACK_CHEATER:"That player is a cheater, you do not wanna attack someone like that",CANNOT_ATTACK_CHEATER_SELF:"Sorry but cheaters cannot attack other players, that would not be fair to them!",CANNOT_ATTACK_MOB:"You have no reason to attack these creatures.",CANNOT_ATTACK_PET:"Are you crazy? Are you out of your mind? Why would you attack a pet?",CANNOT_ATTACK_PREY:"You cannot attack while you are the prey.",CANNOT_ATTACK_TARGET:"You cannot attack someone who is not your target.",CANNOT_ATTACK_LEVEL_DIFF:"You cannot attack someone more than 30 levels above or below you.",CANNOT_DO_THAT:"You cannot do that right now.",CANNOT_DROP_ITEM_DOOR:"You cannot drop this item while standing in a door.",CANNOT_PASS_DOOR:"You cannot pass through this door.",CANNOT_GLOBAL_CHAT_SECONDS:"You must wait another {{duration}} seconds before using global chat.",CANNOT_GLOBAL_CHAT_MINUTES:"You must wait another {{duration}} minutes before using global chat.",CANNOT_GLOBAL_CHAT_JAIL:"You cannot use global chat while you are jailed.",CANNOT_GLOBAL_CHAT_TUTORIAL:"You cannot use global chat while you are in the tutorial.",CANNOT_PICK_UP_ITEM:"This item can only be picked up by {{username}}.",CANNOT_TALK:"You cannot talk right now.",CANNOT_TRADE_ITEM:"You cannot trade this item.",CANNOT_TRADE_CHEATER:"Sorry but cheaters are not allowed to trade.",CANNOT_TRADE_CHEATER_OTHER:"That player is a cheater, he might sell you contraband!",CANNOT_TRADE_ADMIN:"As an administrator, you cannot influence the economy.",CANNOT_TRADE_ADMIN_OTHER:"The player is an administrator and cannot be traded with.",DONT_THINK_GO_IN:"I do not think I should go in there just yet...",ENTERED_LOBBY:"You have entered the lobby for {{name}}.",EXITED_LOBBY:"You have left the lobby for {{name}}.",IN_PVP_ZONE:"You have entered a PvP zone!",INVALID_AMOUNT:"You have entered an invalid amount.",DOOR_KEY_CRUMBLES:"The key crumbles to dust as you pass through the door.",MINIMUM_PLAYERS_MINIGAME:"There must be at least {{minimum}} players to start this minigame.",NEED_COMBAT:"You must be in combat to use this ability.",NEED_WAIT_ABILIY:"You need to wait {{duration}} seconds before using this ability again.",NO_IDEA:"I have no idea what that is.",NO_ARROWS:"You do not have any arrows to shoot.",NO_ACHIEVEMENT_DOOR:"You need to complete the achievement {{achievement}} to pass through this door.",NO_COMBAT_DOOR:"Your combat level must be at least {{level}} to enter.",NO_QUEST_DOOR:"You need to complete the quest {{quest}} to pass through this door.",NO_KEY_DOOR:"You do not have the required key to pass through this door.",NO_SKILL_DOOR:"Your {{skill}} must be at least {{level}} to enter.",NO_KNOWLEDGE_USE:"You do not have the knowledge to use this.",NO_SPACE:"You do not have enough space in your inventory.",NO_SPACE_OTHER:"The other player does not have enough space in their inventory.",NO_SPACE_PET:"You do not have enough space in your pet inventory.",NOT_IN_PVP_ZONE:"You are no longer in a PvP zone!",NOT_ONLINE:"Player @aquamarine@{{username}}@crimson@ is not online.",NOT_ENOUGH_MANA:"You do not have enough mana to use this ability.",NO_NEED_CLICK_REPEATEDLY:"Pstt, you do not have to repeatedly click on that.",PLEASE_MAKE_ROOM_REWARD:"Please make room in your inventory to accept this reward",POISONED:"You have been poisoned!",POISON_WORN_OFF:"The poison has worn off.",PLEASE_REPORT_BUG:"An error has occurred, please report this as a bug.",FREEZE_IMMUNITY:"You are now immune to freeze effects for {{duration}} seconds.",FREEZE_IMMUNITY_WORN_OFF:"Your immunity to freeze effects has worn off.",FIRE_IMMUNITY:"You are now immune to fire effects for {{duration}} seconds.",FIRE_IMMUNITY_WORN_OFF:"Your immunity to fire effects has worn off.",FRIENDS_USERNAME_TOO_LONG:"That username is too long.",FRIENDS_ADD_SELF:"Listen, I get it, you're lonely. But you cannot add yourself to the friends list.",FRIENDS_ALREADY_ADDED:"That player is already on your friends list.",FRIENDS_USER_DOES_NOT_EXIST:"No player with that username exists.",FRIENDS_NOT_IN_LIST:"That player is not on your friends list.",PEOPLE_ONLINE:"There are currently {{population}} people online.",SKILL_LEVEL_UP:"Skill level up!",SKILL_LEVEL_UP_DESC:"Congratulations, your {{name}} has reached level {{level}}!",JAILED:"You are currently jailed for {{duration}}.",MUTED:"You are currently muted.",LOW_MANA:"You are low on mana, your attacks will be weaker.",TRADE_REQUEST:"You have requested to trade with {{username}}.",TRADE_REQUEST_OTHER:"{{username}} has requested to trade with you.",TRADE_EMPTY:"Yo why are y'all trading nothing?",TRADE_COMPLETE:"Thank you for using BagsDungeon trading system!",WELCOME:"Welcome to {{name}}!",WELCOME_BACK:"Welcome back to {{name}}!",WHY_GO_THERE:"Now hang on, why would I wanna go in there?"},$n={MUST_EQUIP_AXE:"You must equip an axe in order to cut trees.",MUST_EQUIP_PICKAXE:"You must be wielding a pickaxe in order to mine rocks.",MUST_EQUIP_FISHING:"You must be wielding a fishing utensil in order to fish.",MUST_EQUIP_FORAGING:"You require a special tool to forage this",INVALID_LEVEL_LUMBERJACKING:"You must be level {{level}} in order to cut this tree.",INVALID_LEVEL_MINING:"You must be level {{level}} in order to mine this rock.",INVALID_LEVEL_FISHING:"You must be level {{level}} in order to fish here.",INVALID_LEVEL_FORAGING:"You must be level {{level}} to harvest this resource.",UNABLE_TO_INTERACT_LUMBERJACKING:"You are unable to cut this tree at the moment.",UNABLE_TO_INTERACT_MINING:"You do not have the necessary knowledge to mine this rock.",UNABLE_TO_INTERACT_FISHING:"You are unable to fish here at the moment.",UNABLE_TO_INTERACT_FORAGING:"You are unable to harvest this resource at the moment.",NO_REASON_TREE:"There is no reason for you to cut this tree.",NO_REASON_FISHING:"There is no reason for you to fish here."},Kn={WARNING_DUPLICATE:"Duplicate item key found in store: ",INVALID_STORE:"Tried to parse a non-existent store.",INVALID_STORE_REFRESH:"Tried to refresh invalid store: ",INVALID_ITEM_SELECTION:"Invalid item selection.",PURCHASE_INVALID_STORE:"tried purchasing an item that does not exist store: ",SELL_INVALID_ITEM:"tried selling an invalid item.",ITEM_OUT_OF_STOCK:"This item is currently out of stock.",NOT_ENOUGH_CURRENCY:"You do not have enough currency to buy this item.",NOT_ENOUGH_SPACE:"You do not have enough space in your inventory.",CANNOT_SELL_ITEM:"You cannot sell this item.",ACTION_STORE_NOT_OPEN:"Tried to perform an action on a store that is not open.",CHEATER:"You have been flagged for cheating. You cannot purchase anything.",RESTRICTED_STORE:"This store does not accept any items.",RESTRICTED_ITEM:"This item cannot be sold here.",INVALID_ITEM_COUNT:"You have entered an invalid amount of items.",HOLLOW_ADMIN:"As an admin you cannot interact with the economy."},jn={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},Zn={WARPED_TO:"You have warped to {{name}}.",CANNOT_WARP_ACHIEVEMENT:"This warp requires an achievement to be finished before use.",CANNOT_WARP_QUEST:"You must complete {{questName}} to warp to {{name}}.",CANNOT_WARP_LEVEL:"You must be at least level {{level}} to warp here.",CANNOT_WARP_JAIL:"You cannot teleport, you are jailed for another {{time}}.",CANNOT_WARP_TUTORIAL:"You must finish the tutorial before warping.",CANNOT_WARP_COMBAT:"You must wait 10 seconds after finishing combat to warp.",CANNOT_WARP_COOLDOWN:"You must wait another {{time}} to warp."},Qn={INVALID_DATA:"Ungültige Crafting-Daten, bitte reiche einen Fehlerbericht ein.",INVALID_ITEM:"Ungültigen Gegenstand ausgewählt.",INVALID_ITEMS:"Du hast nicht die erforderlichen Gegenstände, um dies herzustellen.",SELECT_ITEM:"Bitte wähle einen Gegenstand zum herstellen aus.",FAILED_CRAFT:"Dir ist es nicht gelungen, {{failedText}} herzustellen",FAILED_CRAFT_ONE:"Dir ist es nicht gelungen, den Gegenstand herzustellen."},Jn={NO_ITEM_SELECTED:"Du hast keinen Gegenstand zum Verzaubern ausgewählt.",CANNOT_ENCHANT:"Der von dir ausgewählte Gegenstand kann nicht verzaubert werden.",NO_SHARD:"Du musst einen Scherbe bereitstellen, um einen Gegenstand zu verzaubern.",FAILED_ENCHANT:"Du hast versucht zu verzaubern, aber nichts ist passiert.",SUCCESSFUL_ENCHANT:"Du hast deinen Gegenstand erfolgreich verzaubert."},er={ALREADY_EXISTS:"Eine Gilde mit diesem Namen existiert bereits.",ALREADY_IN_GUILD:"Du bist bereits in einer Gilde.",CANNOT_KICK_YOURSELF:"Du kannst dich nicht selbst aus der Gilde entfernen.",GUILD_FULL:"Diese Gilde ist voll.",MUST_FINISH_TUTORIAL_CREATE:"Du musst das Tutorial beenden, bevor du eine Gilde gründen kannst.",NO_PERMISSION:"Du hast keine Erlaubnis, das zu tun.",NO_PERMISSION_RANK:"Du hast nicht die Erlaubnis, den Rang dieses Mitglieds zu ändern.",NOT_ENOUGH_GOLD:"Du brauchst 30.000 Gold in deinem Inventar, um eine Gilde zu gründen.",NOT_ALLOWED_GUESTS_JOIN:"Gäste dürfen Gilden nicht beitreten.",NOT_ALLOWED_GUESTS_CREATE:"Gäste dürfen keine Gilden gründen."},tr={CANNOT_ACCESS_LOOTBAG:"Du kannst im Moment nicht auf diesen Beutel zugreifen.",REQUIRES_ACHIEVEMENT:"Dieser Gegenstand erfordert eine geheime Errungenschaft, um ihn auszurüsten zu können.",REQUIRES_QUEST:"Du musst {{quest}} abschließen, um diesen Gegenstand auszurüsten zu können.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Dein {{skill}} muss mindestens Level {{level}} sein, um diesen Gegenstand auszurüsten zu können.",TOTAL_LEVEL_REQUIREMENT:"Dein Gesamtlevel muss mindestens {{level}} sein, um diesen Gegenstand ausrüsten zu können."},ir={ACCEPTED_TRADE:"Du hast den Handel akzeptiert.",ACCEPTED_TRADE_OTHER:"Der andere Spieler hat den Handel akzeptiert.",ALREADY_HAVE_PET:"Du hast bereits ein Haustier.",BLACK_POTION:"Du trinkst den schwarzen Trank und fühlst dich unwohl.",CANNOT_ADD_ITEMS_TRADE:"Du kannst keine weiteren Gegenstände zum Handel hinzufügen.",CANNOT_ATTACK_CHEATER:"Dieser Spieler ist ein Betrüger. Du solltest so jemanden nicht angreifen.",CANNOT_ATTACK_CHEATER_SELF:"Sorry, aber Betrüger können andere Spieler nicht angreifen, das wäre ihnen gegenüber nicht fair!",CANNOT_ATTACK_MOB:"Du hast keinen Grund, diese Kreaturen anzugreifen.",CANNOT_ATTACK_PET:"Du bist verrückt? Du hast den Verstand verloren? Warum solltest du ein Haustier angreifen?",CANNOT_ATTACK_PREY:"Du kannst nicht angreifen, wenn du die Beute bist.",CANNOT_ATTACK_TARGET:"Du kannst niemanden angreifen, der nicht dein Ziel ist.",CANNOT_ATTACK_LEVEL_DIFF:"Du kannst niemanden angreifen, der mehr als 30 Levels über oder unter dir ist.",CANNOT_DO_THAT:"Du kannst das im Moment nicht tun.",CANNOT_DROP_ITEM_DOOR:"Du kannst diesen Gegenstand nicht fallen lassen, wenn du in einer Tür stehst.",CANNOT_PASS_DOOR:"Du kannst nicht durch diese Tür gehen.",CANNOT_GLOBAL_CHAT_SECONDS:"Du musst weitere {{duration}} Sekunden warten, bevor du den globalen Chat benutzen kannst.",CANNOT_GLOBAL_CHAT_MINUTES:"Du musst weitere {{duration}} Minuten warten, bevor du den globalen Chat benutzen kannst.",CANNOT_GLOBAL_CHAT_JAIL:"Du kannst den globalen Chat nicht benutzen, solange du inhaftiert bist.",CANNOT_GLOBAL_CHAT_TUTORIAL:"Du kannst den globalen Chat nicht benutzen, während du dich im Tutorial befindest..",CANNOT_PICK_UP_ITEM:"Dieser Gegenstand kann nur von {{username}} aufgehoben werden.",CANNOT_TALK:"Du kannst jetzt nicht reden.",CANNOT_TRADE_ITEM:"Du kannst diesen Gegenstand nicht handeln.",CANNOT_TRADE_CHEATER:"Betrüger dürfen leider nicht handeln.",CANNOT_TRADE_CHEATER_OTHER:"Dieser Spieler ist ein Betrüger, er könnte dir Schmuggelware verkaufen!",CANNOT_TRADE_ADMIN:"Als Administrator kannst du die Wirtschaft nicht beeinflussen.",CANNOT_TRADE_ADMIN_OTHER:"Der Spieler ist ein Administrator und kann nicht mit gehandelt werden.",DONT_THINK_GO_IN:"Ich glaube nicht, dass ich da jetzt schon reingehen sollte...",ENTERED_LOBBY:"Du hast die Lobby betreten für {{name}}.",EXITED_LOBBY:"Du hast die Lobby verlassen für {{name}}.",IN_PVP_ZONE:"Du hast eine PvP-Zone betreten!",INVALID_AMOUNT:"Du hast einen ungültigen Betrag eingegeben.",DOOR_KEY_CRUMBLES:"Der Schlüssel zerbröselt zu Staub, während du durch die Tür gehst.",MINIMUM_PLAYERS_MINIGAME:"Es müssen mindestens {{minimum}} Spieler anwesend sein, um dieses Minispiel zu starten.",NEED_COMBAT:"Du musst im Kampf sein, um diese Fähigkeit zu nutzen.",NEED_WAIT_ABILIY:"Du musst {{duration}} Sekunden warten, bevor du diese Fähigkeit erneut einsetzen kannst.",NO_IDEA:"Ich habe keine Ahnung, was das ist.",NO_ARROWS:"Du hast keine Pfeile zum Schießen.",NO_ACHIEVEMENT_DOOR:"Du musst die Errungenschaft {{achievement}} abschließen, um durch diese Tür gehen zu können.",NO_COMBAT_DOOR:"Dein Kampflevel muss mindestens {{level}} sein, um durch diese Tür gehen zu können.",NO_QUEST_DOOR:"Du musst die Quest {{quest}} abschließen, um durch diese Tür gehen zu können.",NO_KEY_DOOR:"Du hast nicht den nötigen Schlüssel, um durch diese Tür gehen zu können.",NO_SKILL_DOOR:"Dein {{skill}} muss mindestens {{level}} sein, um durch diese Tür gehen zu können.",NO_KNOWLEDGE_USE:"Du hast nicht das Wissen, um dies zu benutzen.",NO_SPACE:"Du hast nicht genug Platz in deinem Inventar.",NO_SPACE_OTHER:"Der andere Spieler hat nicht genug Platz in seinem Inventar.",NO_SPACE_PET:"Du hast nicht genug Platz in deinem Haustierinventar.",NOT_IN_PVP_ZONE:"Du bist nicht mehr in einer PvP-Zone!",NOT_ONLINE:"Spieler @aquamarine@{{username}}@crimson@ ist nicht online.",NOT_ENOUGH_MANA:"Du hast nicht genug Mana, um diese Fähigkeit einzusetzen.",PLEASE_MAKE_ROOM_REWARD:"Bitte mach Platz in deinem Inventar, um diese Belohnung anzunehmen",POISONED:"Du wurdest vergiftet!",POISON_WORN_OFF:"Das Gift hat nachgelassen.",PLEASE_REPORT_BUG:"Es ist ein Problem aufgetreten, bitte melde dies als Fehler.",FREEZE_IMMUNITY:"Du bist jetzt für {{duration} Sekunden immun gegen Einfriereffekte.",FREEZE_IMMUNITY_WORN_OFF:"Deine Immunität gegen Gefriereffekte hat nachgelassen.",FIRE_IMMUNITY:"Du bist jetzt für {{duration}} Sekunden immun gegen Feuereffekte.",FIRE_IMMUNITY_WORN_OFF:"Deine Immunität gegen Feuereffekte hat nachgelassen.",FRIENDS_USERNAME_TOO_LONG:"Dieser Benutzername ist zu lang.",FRIENDS_ADD_SELF:"Hör zu, ich verstehe, dass du einsam bist. Du kannst dich aber nicht selber in deine Freundesliste eintragen.",FRIENDS_ALREADY_ADDED:"Dieser Spieler ist bereits in deiner Freundesliste.",FRIENDS_USER_DOES_NOT_EXIST:"Es gibt keinen Spieler mit diesem Benutzernamen.",FRIENDS_NOT_IN_LIST:"Dieser Spieler ist nicht in deiner Freundesliste.",PEOPLE_ONLINE:"Derzeit sind {{population}} Spieler online.",SKILL_LEVEL_UP:"Fertigkeitslevel erhöht!",SKILL_LEVEL_UP_DESC:"Herzlichen Glückwunsch, dein {{name}} hat Level {{level}} erreicht!",JAILED:"Du bist derzeit inhaftiert für {{duration}}.",MUTED:"Du bist derzeit stummgeschaltet.",LOW_MANA:"Du hast nur noch wenig Mana, deine Angriffe werden schwächer sein.",TRADE_REQUEST:"Du hast angefragt, mit {{username}} zu handeln.",TRADE_REQUEST_OTHER:"{{username}} hat angefragt, mit dir zu handeln.",TRADE_EMPTY:"Yo, warum handelt ihr mit nichts??",TRADE_COMPLETE:"Danke, dass du das BagsDungeon Handelssystem benutzt!",WELCOME:"Willkommen bei {{name}}!",WELCOME_BACK:"Willkommen zurück bei {{name}}!",WHY_GO_THERE:"Moment mal, warum sollte ich da reingehen??"},sr={MUST_EQUIP_AXE:"Du musst eine Axt ausrüsten, um Bäume fällen zu können.",MUST_EQUIP_PICKAXE:"Du musst eine Spitzhacke ausrüsten, um Steine abbauen zu können.",MUST_EQUIP_FISHING:"Du musst ein Angelgerät ausrüsten, um fischen zu können.",MUST_EQUIP_FORAGING:"Du brauchst ein spezielles Werkzeug, um dieses zu ernten",INVALID_LEVEL_LUMBERJACKING:"Du musst Level {{level}} sein, um diesen Baum fällen zu können.",INVALID_LEVEL_MINING:"Du musst Level {{level}} sein, um dieses Gestein abbauen zu können.",INVALID_LEVEL_FISHING:"Du musst Level {{level}} sein, um hier angeln zu können.",INVALID_LEVEL_FORAGING:"Du musst Level {{level}} sein, um diese Ressource ernten zu können.",UNABLE_TO_INTERACT_LUMBERJACKING:"Du kannst diesen Baum im Moment nicht fällen.",UNABLE_TO_INTERACT_MINING:"Du hast nicht das nötige Wissen, um dieses Gestein abzubauen.",UNABLE_TO_INTERACT_FISHING:"Du kannst hier im Moment nicht angeln.",UNABLE_TO_INTERACT_FORAGING:"Du kannst diese Ressource im Moment nicht ernten.",NO_REASON_TREE:"Es gibt keinen Grund für dich, diesen Baum zu fällen.",NO_REASON_FISHING:"Es gibt keinen Grund für dich, hier zu fischen."},ar={WARNING_DUPLICATE:"Duplicate item key found in store: ",INVALID_STORE:"You tried to parse a non-existent store.",INVALID_STORE_REFRESH:"hat versucht, ein ungültiges Geschäft zu aktualisieren: ",INVALID_ITEM_SELECTION:"Ungültige Gegenstandsauswahl.",PURCHASE_INVALID_STORE:"hat versucht, einen Gegenstand zu kaufen, den es im Geschäft nicht gibt: ",SELL_INVALID_ITEM:"hat versucht, einen ungültigen Gegenstand zu verkaufen.",ITEM_OUT_OF_STOCK:"Dieser Gegenstand ist derzeit ausverkauft.",NOT_ENOUGH_CURRENCY:"Du hast nicht genug Währung, um diesen Gegenstand zu kaufen.",NOT_ENOUGH_SPACE:"Du hast nicht genug Platz in deinem Inventar.",CANNOT_SELL_ITEM:"Du kannst diesen Gegenstand nicht verkaufen.",ACTION_STORE_NOT_OPEN:"hat versucht, eine Aktion in einem Geschäft durchzuführen, das nicht geöffnet ist.",CHEATER:"Du wurdest als Betrüger markiert. Du kannst nichts kaufen.",RESTRICTED_STORE:"Dieses Geschäft nimmt keine Gegenstände an.",RESTRICTED_ITEM:"Dieser Gegenstand kann hier nicht verkauft werden.",INVALID_ITEM_COUNT:"Du hast eine ungültige Anzahl von Gegenständen eingegeben.",HOLLOW_ADMIN:"Du kannst als Administrator nicht mit der Wirtschaft interagieren."},nr={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},rr={WARPED_TO:"Du hast dich nach {{name}} teleportiert.",CANNOT_WARP_ACHIEVEMENT:"Dieser Teleport erfordert eine Errungenschaft, die vor der Benutzung abgeschlossen werden muss.",CANNOT_WARP_QUEST:"Du musst {{questName}} abschließen, um nach {{name}} zu teleportieren zu können.",CANNOT_WARP_LEVEL:"Du musst mindestens Level {{level}} sein, um hierher zu teleportieren zu können.",CANNOT_WARP_JAIL:"Du kannst nicht teleportieren, du bist für weitere {{time}} eingesperrt.",CANNOT_WARP_TUTORIAL:"Du musst das Tutorial beenden, bevor du teleportieren kannst.",CANNOT_WARP_COMBAT:"Du musst 10 Sekunden nach Beendigung des Kampfes warten, um zu teleportieren zu können.",CANNOT_WARP_COOLDOWN:"Du musst weitere {{time}} warten, um zu teleportieren zu können."},or={INVALID_DATA:"Datos de creación no válidos, por favor envía un informe de error.",INVALID_ITEM:"Elemento seleccionado no válido.",INVALID_ITEMS:"No tienes los elementos necesarios para fabricar eso.",SELECT_ITEM:"Por favor selecciona un artículo para crear.",FAILED_CRAFT:"Has fallado en crear el {{failedText}}."},lr={NO_ITEM_SELECTED:"No has seleccionado un elemento para encantar.",CANNOT_ENCHANT:"El elemento que has seleccionado no se puede encantar.",NO_SHARD:"Debes proporcionar un fragmento para encantar un objeto.",FAILED_ENCHANT:"Intentaste encantar pero no pasó nada.",SUCCESSFUL_ENCHANT:"Encantaste con éxito tu objeto."},hr={ALREADY_EXISTS:"Ya existe un gremio con ese nombre.",ALREADY_IN_GUILD:"Ya estás en un gremio.",CANNOT_KICK_YOURSELF:"No puedes expulsarte a ti mismo del gremio.",GUILD_FULL:"Este gremio está al máximo de su capacidad.",MUST_FINISH_TUTORIAL_CREATE:"Debes terminar el tutorial antes de poder crear un gremio.",NO_PERMISSION:"No tienes permiso para hacer eso.",NO_PERMISSION_RANK:"No tienes permiso para actualizar el rango de ese miembro.",NOT_ENOUGH_GOLD:"Necesitas 30 000 de oro en tu inventario para crear un gremio.",NOT_ALLOWED_GUESTS_JOIN:"Los invitados no pueden unirse a los gremios.",NOT_ALLOWED_GUESTS_CREATE:"Los invitados no pueden crear gremios."},dr={CANNOT_ACCESS_LOOTBAG:"No puedes acceder a este botín en este momento.",REQUIRES_ACHIEVEMENT:"Este artículo requiere de un logro secreto para equiparlo.",REQUIRES_QUEST:"Debes completar {{quest}} para equipar este artículo.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Tu {{skill}} debe tener al menos el nivel {{level}} para equipar esto.",TOTAL_LEVEL_REQUIREMENT:"Tu nivel total debe ser al menos {{level}} para equipar este artículo."},ur={ACCEPTED_TRADE:"Has aceptado el intercambio.",ACCEPTED_TRADE_OTHER:"El otro jugador ha aceptado el intercambio.",ALREADY_HAVE_PET:"Ya tienes una mascota.",BLACK_POTION:"Bebes la poción negra y empiezas a sentirte mal.",CANNOT_ADD_ITEMS_TRADE:"No puede agregar más artículos al intercambio.",CANNOT_ATTACK_CHEATER:"Ese jugador es un tramposo, no quieres atacar a alguien así.",CANNOT_ATTACK_CHEATER_SELF:"Lo siento, pero los tramposos no pueden atacar a otros jugadores, ¡eso no sería justo para ellos!",CANNOT_ATTACK_MOB:"No tienes motivos para atacar a estas criaturas.",CANNOT_ATTACK_PET:"¿Estás loco? ¿Por qué atacarías a una mascota?",CANNOT_ATTACK_PREY:"No puedes atacar mientras eres la presa.",CANNOT_ATTACK_TARGET:"No puedes atacar a alguien que no es tu objetivo.",CANNOT_ATTACK_LEVEL_DIFF:"No puedes atacar a alguien con 30 niveles por encima o por debajo de ti.",CANNOT_DO_THAT:"No puedes hacer eso ahora mismo.",CANNOT_DROP_ITEM_DOOR:"No puedes dejar caer este artículo mientras estás parado en una puerta.",CANNOT_PASS_DOOR:"No puedes pasar por esta puerta.",CANNOT_GLOBAL_CHAT_SECONDS:"Debes esperar otros {{duration}} segundos antes de usar el chat global.",CANNOT_GLOBAL_CHAT_MINUTES:"Debes esperar otros {{duration}} minutos antes de usar el chat global.",CANNOT_GLOBAL_CHAT_JAIL:"No puedes usar el chat global mientras estás encarcelado.",CANNOT_PICK_UP_ITEM:"Este artículo solo puede ser recogido por {{username}}.",CANNOT_TALK:"No puedes hablar ahora.",CANNOT_TRADE_ITEM:"No puedes intercambiar este artículo.",CANNOT_TRADE_CHEATER:"Lo sentimos, pero los tramposos no pueden comerciar.",CANNOT_TRADE_CHEATER_OTHER:"¡Ese jugador es un tramposo, podría venderte contrabando!",CANNOT_TRADE_ADMIN:"Como administrador, no puedes influenciar la economía.",CANNOT_TRADE_ADMIN_OTHER:"El jugador es un administrador y no se puede comerciar con él.",DONT_THINK_GO_IN:"No creo que deba entrar allí todavía...",ENTERED_LOBBY:"Has entrado en el lobby de {{name}}.",EXITED_LOBBY:"Has dejado el lobby de {{name}}.",IN_PVP_ZONE:"¡Has entrado en una zona PvP!",INVALID_AMOUNT:"Has introducido una cantidad no válida.",DOOR_KEY_CRUMBLES:"La llave se convierte en polvo al pasar por la puerta.",MINIMUM_PLAYERS_MINIGAME:"Debe haber al menos {{minimum}} jugadores para comenzar este minijuego.",NEED_COMBAT:"Debes estar en combate para usar esta habilidad.",NEED_WAIT_ABILIY:"Debes esperar {{duration}} segundos antes de volver a usar esta habilidad.",NO_IDEA:"No tengo idea de qué es eso.",NO_ARROWS:"No tienes flechas para disparar.",NO_ACHIEVEMENT_DOOR:"Debes completar el logro {{achievement}} para pasar por esta puerta.",NO_COMBAT_DOOR:"Tu nivel de combate debe ser al menos {{level}} para participar.",NO_QUEST_DOOR:"Debes completar la misión {{quest}} para atravesar esta puerta.",NO_KEY_DOOR:"No tienes la llave requerida para pasar por esta puerta.",NO_SKILL_DOOR:"Tu {{skill}} debe tener al menos {{level}} para participar.",NO_KNOWLEDGE_USE:"No tienes el conocimiento para usar esto.",NO_SPACE:"No tienes suficiente espacio en tu inventario.",NO_SPACE_OTHER:"El otro jugador no tiene suficiente espacio en su inventario.",NO_SPACE_PET:"No tienes suficiente espacio en tu inventario de mascotas.",NOT_IN_PVP_ZONE:"¡Ya no estás en una zona PvP!",NOT_ONLINE:"El jugador @aquamarine@{{username}}@crimson@ no está en línea.",NOT_ENOUGH_MANA:"No tienes suficiente mana para usar esta habilidad.",PLEASE_MAKE_ROOM_REWARD:"Haz espacio en tu inventario para aceptar esta recompensa.",POISONED:"¡Has sido envenenado!",POISON_WORN_OFF:"El veneno ha desaparecido.",PLEASE_REPORT_BUG:"Se ha producido un error, repórtalo como un bug.",FREEZE_IMMUNITY:"Ahora eres inmune a los efectos de congelación durante {{duration}} segundos.",FREEZE_IMMUNITY_WORN_OFF:"Tu inmunidad a los efectos de congelación ha desaparecido.",FIRE_IMMUNITY:"Ahora eres inmune a los efectos de fuego durante {{duration}} segundos.",FIRE_IMMUNITY_WORN_OFF:"Tu inmunidad a los efectos del fuego ha desaparecido.",FRIENDS_USERNAME_TOO_LONG:"Ese nombre de usuario es demasiado largo.",FRIENDS_ADD_SELF:"Escucha, lo entiendo, te sientes solo. Pero no puedes agregarte a ti mismo a la lista de amigos.",FRIENDS_ALREADY_ADDED:"Ese jugador ya está en tu lista de amigos.",FRIENDS_USER_DOES_NOT_EXIST:"No existe ningún jugador con ese nombre de usuario.",FRIENDS_NOT_IN_LIST:"Ese jugador no está en tu lista de amigos.",PEOPLE_ONLINE:"Actualmente hay {{population}} personas en línea.",SKILL_LEVEL_UP:"¡Sube el nivel de habilidad!",SKILL_LEVEL_UP_DESC:"¡Felicitaciones, tu {{skill}} ha alcanzado el nivel {{level}}!!",JAILED:"Actualmente estás encarcelado por {{duration}}.",MUTED:"Actualmente estás silenciado.",LOW_MANA:"Tienes poco mana, tus ataques serán más débiles.",TRADE_REQUEST:"Has solicitado comerciar con {{username}}.",TRADE_REQUEST_OTHER:"{{username}} ha solicitado comerciar contigo.",TRADE_EMPTY:"¿Oye, por qué no intercambias nada?",TRADE_COMPLETE:"¡Gracias por usar el sistema de comercio de BagsDungeon!",WELCOME:"¡Bienvenido a {{name}}!",WELCOME_BACK:"¡Bienvenido de nuevo a {{name}}!",WHY_GO_THERE:"Espera, ¿por qué querría entrar allí?"},cr={MUST_EQUIP_AXE:"Debes equipar un hacha para cortar árboles.",MUST_EQUIP_PICKAXE:"Debes equipar un pico para minar rocas.",MUST_EQUIP_FISHING:"Debes equipar una caña de pescar para poder pescar.",MUST_EQUIP_FORAGING:"Necesitas una herramienta especial para forrajear esto.",INVALID_LEVEL_LUMBERJACKING:"Debes tener el nivel {{level}} para cortar este árbol.",INVALID_LEVEL_MINING:"Debes tener el nivel {{level}} para minar esta roca.",INVALID_LEVEL_FISHING:"Debes tener el nivel {{level}} para poder pescar aquí.",INVALID_LEVEL_FORAGING:"Debes tener el nivel {{level}} para recolectar este recurso.",UNABLE_TO_INTERACT_LUMBERJACKING:"No puedes cortar este árbol en este momento.",UNABLE_TO_INTERACT_MINING:"No tienes los conocimientos necesarios para minar esta roca.",UNABLE_TO_INTERACT_FISHING:"No puede pescar aquí en este momento.",UNABLE_TO_INTERACT_FORAGING:"No puedes recolectar este recurso en este momento.",NO_REASON_TREE:"No hay razón para que cortes este árbol.",NO_REASON_FISHING:"No hay razón para que pesques aquí."},gr={WARNING_DUPLICATE:"Llave de artículo duplicada encontrada en la tienda: ",INVALID_STORE:"Intentaste analizar una tienda inexistente.",INVALID_STORE_REFRESH:"Intentaste actualizar una tienda no válida:",INVALID_ITEM_SELECTION:"Seleccionaste un artículo no válido.",PURCHASE_INVALID_STORE:"Intentaste comprar un artículo que no existe en la tienda: ",SELL_INVALID_ITEM:"Intentaste vender un artículo no válido.",ITEM_OUT_OF_STOCK:"Este artículo está actualmente agotado.",NOT_ENOUGH_CURRENCY:"No tienes suficiente oro para comprar este artículo.",NOT_ENOUGH_SPACE:"No tienes suficiente espacio en tu inventario.",CANNOT_SELL_ITEM:"No puedes vender este artículo.",ACTION_STORE_NOT_OPEN:"Intentaste realizar una acción en una tienda que no está abierta.",CHEATER:"Te han marcado por hacer trampa. No puedes comprar nada.",RESTRICTED_STORE:"Esta tienda no acepta ningún artículo.",RESTRICTED_ITEM:"Este artículo no se puede vender aquí.",INVALID_ITEM_COUNT:"Has introducido una cantidad no válida de artículos.",HOLLOW_ADMIN:"Como administrador no puedes interactuar con la economía."},mr={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},fr={WARPED_TO:"Te has teletransportado a {{name}}.",CANNOT_WARP_ACHIEVEMENT:"Este teletransportador requiere que se complete un logro antes de su uso.",CANNOT_WARP_QUEST:"Debes completar {{questName}} para viajar a {{name}}.",CANNOT_WARP_LEVEL:"Debes tener al menos el nivel {{level}} para teletransportarte aquí.",CANNOT_WARP_JAIL:"No puedes teletransportarte, estás encarcelado por otro {{time}}.",CANNOT_WARP_TUTORIAL:"Debes terminar el tutorial antes de teletransportarte.",CANNOT_WARP_COMBAT:"Debes esperar 10 segundos después de terminar el combate para teletransportarte.",CANNOT_WARP_COOLDOWN:"Debes esperar otro {{time}} para teletransportarte."},pr={INVALID_DATA:"Invalid crafting data, please submit a bug report.",INVALID_ITEM:"Invalid item selected.",INVALID_ITEMS:"You do not have the required items to craft that.",SELECT_ITEM:"Please select an item to craft.",FAILED_CRAFT:"You have failed to craft {{failedText}}"},wr={NO_ITEM_SELECTED:"You have not selected an item to enchant.",CANNOT_ENCHANT:"The item you have selected cannot be enchanted.",NO_SHARD:"You must provide a shard to enchant an item.",FAILED_ENCHANT:"You tried enchanting but nothing happened.",SUCCESSFUL_ENCHANT:"You successfully enchanted your item."},_r={ALREADY_EXISTS:"A guild with that name already exists.",ALREADY_IN_GUILD:"You are already in a guild.",CANNOT_KICK_YOURSELF:"You cannot kick yourself from the guild.",GUILD_FULL:"This guild is at maximum capacity.",MUST_FINISH_TUTORIAL_CREATE:"You must finish the tutorial before creating a guild.",NO_PERMISSION:"You do not have permission to do that.",NO_PERMISSION_RANK:"You do not have permission to update the rank of that member.",NOT_ENOUGH_GOLD:"You need 30,000 gold in your inventory to create a guild.",NOT_ALLOWED_GUESTS_JOIN:"Guests are not allowed to join guilds.",NOT_ALLOWED_GUESTS_CREATE:"Guests are not allowed to create guilds."},br={CANNOT_ACCESS_LOOTBAG:"You cannot access this lootbag right now.",REQUIRES_ACHIEVEMENT:"This item requires a secret achievement to equip.",REQUIRES_QUEST:"You must complete {{quest}} to equip this item.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Your {{skill}} must be at least level {{level}} to equip this.",TOTAL_LEVEL_REQUIREMENT:"Your total level must be at least {{level}} to equip this item."},yr={ACCEPTED_TRADE:"You have accepted the trade.",ACCEPTED_TRADE_OTHER:"The other player has accepted the trade.",ALREADY_HAVE_PET:"You already have a pet.",BLACK_POTION:"You drink the black potion and start feeling unwell.",CANNOT_ADD_ITEMS_TRADE:"You cannot add any more items to the trade.",CANNOT_ATTACK_CHEATER:"That player is a cheater, you do not wanna attack someone like that",CANNOT_ATTACK_CHEATER_SELF:"Sorry but cheaters cannot attack other players, that would not be fair to them!",CANNOT_ATTACK_MOB:"You have no reason to attack these creatures.",CANNOT_ATTACK_PET:"Are you crazy? Are you out of your mind? Why would you attack a pet?",CANNOT_ATTACK_PREY:"You cannot attack while you are the prey.",CANNOT_ATTACK_TARGET:"You cannot attack someone who is not your target.",CANNOT_ATTACK_LEVEL_DIFF:"You cannot attack someone more than 30 levels above or below you.",CANNOT_DO_THAT:"You cannot do that right now.",CANNOT_DROP_ITEM_DOOR:"You cannot drop this item while standing in a door.",CANNOT_PASS_DOOR:"You cannot pass through this door.",CANNOT_PICK_UP_ITEM:"This item can only be picked up by {{username}}.",CANNOT_TALK:"You cannot talk right now.",CANNOT_TRADE_ITEM:"You cannot trade this item.",CANNOT_TRADE_CHEATER:"Sorry but cheaters are not allowed to trade.",CANNOT_TRADE_CHEATER_OTHER:"That player is a cheater, he might sell you contraband!",CANNOT_TRADE_ADMIN:"As an administrator, you cannot influence the economy.",CANNOT_TRADE_ADMIN_OTHER:"The player is an administrator and cannot be traded with.",DONT_THINK_GO_IN:"I do not think I should go in there just yet...",ENTERED_LOBBY:"You have entered the lobby for {{name}}.",EXITED_LOBBY:"You have left the lobby for {{name}}.",IN_PVP_ZONE:"You have entered a PvP zone!",INVALID_AMOUNT:"You have entered an invalid amount.",DOOR_KEY_CRUMBLES:"The key crumbles to dust as you pass through the door.",MINIMUM_PLAYERS_MINIGAME:"There must be at least {{minimum}} players to start this minigame.",NEED_COMBAT:"You must be in combat to use this ability.",NEED_WAIT_ABILIY:"You need to wait {{duration}} seconds before using this ability again.",NO_IDEA:"I have no idea what that is.",NO_ARROWS:"You do not have any arrows to shoot.",NO_ACHIEVEMENT_DOOR:"You need to complete the achievement {{achievement}} to pass through this door.",NO_COMBAT_DOOR:"Your combat level must be at least {{level}} to enter.",NO_QUEST_DOOR:"You need to complete the quest {{quest}} to pass through this door.",NO_KEY_DOOR:"You do not have the required key to pass through this door.",NO_SKILL_DOOR:"Your {{skill}} must be at least {{level}} to enter.",NO_KNOWLEDGE_USE:"You do not have the knowledge to use this.",NO_SPACE:"You do not have enough space in your inventory.",NO_SPACE_OTHER:"The other player does not have enough space in their inventory.",NO_SPACE_PET:"You do not have enough space in your pet inventory.",NOT_IN_PVP_ZONE:"You are no longer in a PvP zone!",NOT_ONLINE:"Player @aquamarine@{{username}}@crimson@ is not online.",NOT_ENOUGH_MANA:"You do not have enough mana to use this ability.",PLEASE_MAKE_ROOM_REWARD:"Please make room in your inventory to accept this reward",POISONED:"You have been poisoned!",POISON_WORN_OFF:"The poison has worn off.",PLEASE_REPORT_BUG:"An error has occurred, please report this as a bug.",FREEZE_IMMUNITY:"You are now immune to freeze effects for {{duration}} seconds.",FREEZE_IMMUNITY_WORN_OFF:"Your immunity to freeze effects has worn off.",FIRE_IMMUNITY:"You are now immune to fire effects for {{duration}} seconds.",FIRE_IMMUNITY_WORN_OFF:"Your immunity to fire effects has worn off.",FRIENDS_USERNAME_TOO_LONG:"That username is too long.",FRIENDS_ADD_SELF:"Listen, I get it, you're lonely. But you cannot add yourself to the friends list.",FRIENDS_ALREADY_ADDED:"That player is already on your friends list.",FRIENDS_USER_DOES_NOT_EXIST:"No player with that username exists.",FRIENDS_NOT_IN_LIST:"That player is not on your friends list.",PEOPLE_ONLINE:"There are currently {{population}} people online.",SKILL_LEVEL_UP:"Skill level up!",SKILL_LEVEL_UP_DESC:"Congratulations, your {{name}} has reached level {{level}}!",JAILED:"You are currently jailed for {{duration}}.",MUTED:"You are currently muted.",LOW_MANA:"You are low on mana, your attacks will be weaker.",TRADE_REQUEST:"You have requested to trade with {{username}}.",TRADE_REQUEST_OTHER:"{{username}} has requested to trade with you.",TRADE_EMPTY:"Yo why are y'all trading nothing?",TRADE_COMPLETE:"Thank you for using BagsDungeon trading system!",WELCOME:"Welcome to {{name}}!",WELCOME_BACK:"Welcome back to {{name}}!",WHY_GO_THERE:"Now hang on, why would I wanna go in there?"},kr={MUST_EQUIP_AXE:"You must equip an axe in order to cut trees.",MUST_EQUIP_PICKAXE:"You must be wielding a pickaxe in order to mine rocks.",MUST_EQUIP_FISHING:"You must be wielding a fishing utensil in order to fish.",MUST_EQUIP_FORAGING:"You require a special tool to forage this",INVALID_LEVEL_LUMBERJACKING:"You must be level {{level}} in order to cut this tree.",INVALID_LEVEL_MINING:"You must be level {{level}} in order to mine this rock.",INVALID_LEVEL_FISHING:"You must be level {{level}} in order to fish here.",INVALID_LEVEL_FORAGING:"You must be level {{level}} to harvest this resource.",UNABLE_TO_INTERACT_LUMBERJACKING:"You are unable to cut this tree at the moment.",UNABLE_TO_INTERACT_MINING:"You do not have the necessary knowledge to mine this rock.",UNABLE_TO_INTERACT_FISHING:"You are unable to fish here at the moment.",UNABLE_TO_INTERACT_FORAGING:"You are unable to harvest this resource at the moment.",NO_REASON_TREE:"There is no reason for you to cut this tree."},Er={WARNING_DUPLICATE:"Duplicate item key found in store: ",INVALID_STORE:"Tried to parse a non-existent store.",INVALID_STORE_REFRESH:"Tried to refresh invalid store: ",INVALID_ITEM_SELECTION:"Invalid item selection.",PURCHASE_INVALID_STORE:"tried purchasing an item that does not exist store: ",SELL_INVALID_ITEM:"tried selling an invalid item.",ITEM_OUT_OF_STOCK:"This item is currently out of stock.",NOT_ENOUGH_CURRENCY:"You do not have enough currency to buy this item.",NOT_ENOUGH_SPACE:"You do not have enough space in your inventory.",CANNOT_SELL_ITEM:"You cannot sell this item.",ACTION_STORE_NOT_OPEN:"Tried to perform an action on a store that is not open.",CHEATER:"You have been flagged for cheating. You cannot purchase anything.",RESTRICTED_STORE:"This store does not accept any items.",RESTRICTED_ITEM:"This item cannot be sold here.",INVALID_ITEM_COUNT:"You have entered an invalid amount of items.",HOLLOW_ADMIN:"As an admin you cannot interact with the economy."},Tr={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},Sr={WARPED_TO:"You have warped to {{name}}.",CANNOT_WARP_ACHIEVEMENT:"This warp requires an achievement to be finished before use.",CANNOT_WARP_QUEST:"You must complete {{questName}} to warp to {{name}}.",CANNOT_WARP_LEVEL:"You must be at least level {{level}} to warp here.",CANNOT_WARP_JAIL:"You cannot teleport, you are jailed for another {{time}}.",CANNOT_WARP_TUTORIAL:"You must finish the tutorial before warping.",CANNOT_WARP_COMBAT:"You must wait 10 seconds after finishing combat to warp.",CANNOT_WARP_COOLDOWN:"You must wait another {{time}} to warp."},vr={INVALID_DATA:"Invalid crafting data, please submit a bug report.",INVALID_ITEM:"Invalid item selected.",INVALID_ITEMS:"You do not have the required items to craft that.",SELECT_ITEM:"Please select an item to craft.",FAILED_CRAFT:"You have failed to craft {{failedText}} "},Ir={NO_ITEM_SELECTED:"You have not selected an item to enchant.",CANNOT_ENCHANT:"The item you have selected cannot be enchanted.",NO_SHARD:"You must provide a shard to enchant an item.",FAILED_ENCHANT:"You tried enchanting but nothing happened.",SUCCESSFUL_ENCHANT:"You successfully enchanted your item."},Cr={ALREADY_EXISTS:"A guild with that name already exists.",ALREADY_IN_GUILD:"You are already in a guild.",CANNOT_KICK_YOURSELF:"You cannot kick yourself from the guild.",GUILD_FULL:"This guild is at maximum capacity.",MUST_FINISH_TUTORIAL_CREATE:"You must finish the tutorial before creating a guild.",NO_PERMISSION:"You do not have permission to do that.",NO_PERMISSION_RANK:"You do not have permission to update the rank of that member.",NOT_ENOUGH_GOLD:"You need 30,000 gold in your inventory to create a guild.",NOT_ALLOWED_GUESTS_JOIN:"Guests are not allowed to join guilds.",NOT_ALLOWED_GUESTS_CREATE:"Guests are not allowed to create guilds."},Ar={CANNOT_ACCESS_LOOTBAG:"You cannot access this lootbag right now.",REQUIRES_ACHIEVEMENT:"This item requires a secret achievement to equip.",REQUIRES_QUEST:"You must complete {{quest}} to equip this item.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Your {{skill}} must be at least level {{level}} to equip this.",TOTAL_LEVEL_REQUIREMENT:"Your total level must be at least {{level}} to equip this item."},Nr={ACCEPTED_TRADE:"You have accepted the trade.",ACCEPTED_TRADE_OTHER:"The other player has accepted the trade.",ALREADY_HAVE_PET:"You already have a pet.",BLACK_POTION:"You drink the black potion and start feeling unwell.",CANNOT_ADD_ITEMS_TRADE:"You cannot add any more items to the trade.",CANNOT_ATTACK_CHEATER:"That player is a cheater, you do not wanna attack someone like that",CANNOT_ATTACK_CHEATER_SELF:"Sorry but cheaters cannot attack other players, that would not be fair to them!",CANNOT_ATTACK_MOB:"You have no reason to attack these creatures.",CANNOT_ATTACK_PET:"Are you crazy? Are you out of your mind? Why would you attack a pet?",CANNOT_ATTACK_PREY:"You cannot attack while you are the prey.",CANNOT_ATTACK_TARGET:"You cannot attack someone who is not your target.",CANNOT_ATTACK_LEVEL_DIFF:"You cannot attack someone more than 30 levels above or below you.",CANNOT_DO_THAT:"You cannot do that right now.",CANNOT_DROP_ITEM_DOOR:"You cannot drop this item while standing in a door.",CANNOT_PASS_DOOR:"You cannot pass through this door.",CANNOT_PICK_UP_ITEM:"This item can only be picked up by {{username}}.",CANNOT_TALK:"You cannot talk right now.",CANNOT_TRADE_ITEM:"You cannot trade this item.",CANNOT_TRADE_CHEATER:"Sorry but cheaters are not allowed to trade.",CANNOT_TRADE_CHEATER_OTHER:"That player is a cheater, he might sell you contraband!",CANNOT_TRADE_ADMIN:"As an administrator, you cannot influence the economy.",CANNOT_TRADE_ADMIN_OTHER:"The player is an administrator and cannot be traded with.",DONT_THINK_GO_IN:"I do not think I should go in there just yet...",ENTERED_LOBBY:"You have entered the lobby for {{name}}.",EXITED_LOBBY:"You have left the lobby for {{name}}.",IN_PVP_ZONE:"You have entered a PvP zone!",INVALID_AMOUNT:"You have entered an invalid amount.",DOOR_KEY_CRUMBLES:"The key crumbles to dust as you pass through the door.",MINIMUM_PLAYERS_MINIGAME:"There must be at least {{minimum}} players to start this minigame.",NEED_COMBAT:"You must be in combat to use this ability.",NEED_WAIT_ABILIY:"You need to wait {{duration}} seconds before using this ability again.",NO_IDEA:"I have no idea what that is.",NO_ARROWS:"You do not have any arrows to shoot.",NO_ACHIEVEMENT_DOOR:"You need to complete the achievement {{achievement}} to pass through this door.",NO_COMBAT_DOOR:"Your combat level must be at least {{level}} to enter.",NO_QUEST_DOOR:"You need to complete the quest {{quest}} to pass through this door.",NO_KEY_DOOR:"You do not have the required key to pass through this door.",NO_SKILL_DOOR:"Your {{skill}} must be at least {{level}} to enter.",NO_KNOWLEDGE_USE:"You do not have the knowledge to use this.",NO_SPACE:"You do not have enough space in your inventory.",NO_SPACE_OTHER:"The other player does not have enough space in their inventory.",NO_SPACE_PET:"You do not have enough space in your pet inventory.",NOT_IN_PVP_ZONE:"You are no longer in a PvP zone!",NOT_ONLINE:"Player @aquamarine@{{username}}@crimson@ is not online.",NOT_ENOUGH_MANA:"You do not have enough mana to use this ability.",PLEASE_MAKE_ROOM_REWARD:"Please make room in your inventory to accept this reward",POISONED:"You have been poisoned!",POISON_WORN_OFF:"The poison has worn off.",PLEASE_REPORT_BUG:"An error has occurred, please report this as a bug.",FREEZE_IMMUNITY:"You are now immune to freeze effects for {{duration}} seconds.",FREEZE_IMMUNITY_WORN_OFF:"Your immunity to freeze effects has worn off.",FIRE_IMMUNITY:"You are now immune to fire effects for {{duration}} seconds.",FIRE_IMMUNITY_WORN_OFF:"Your immunity to fire effects has worn off.",FRIENDS_USERNAME_TOO_LONG:"That username is too long.",FRIENDS_ADD_SELF:"Listen, I get it, you're lonely. But you cannot add yourself to the friends list.",FRIENDS_ALREADY_ADDED:"That player is already on your friends list.",FRIENDS_USER_DOES_NOT_EXIST:"No player with that username exists.",FRIENDS_NOT_IN_LIST:"That player is not on your friends list.",PEOPLE_ONLINE:"There are currently {{population}} people online.",SKILL_LEVEL_UP:"Skill level up!",SKILL_LEVEL_UP_DESC:"Congratulations, your {{name}} has reached level {{level}}!",JAILED:"You are currently jailed for {{duration}}.",MUTED:"You are currently muted.",LOW_MANA:"You are low on mana, your attacks will be weaker.",TRADE_REQUEST:"You have requested to trade with {{username}}.",TRADE_REQUEST_OTHER:"{{username}} has requested to trade with you.",TRADE_EMPTY:"Yo why are y'all trading nothing?",TRADE_COMPLETE:"Thank you for using BagsDungeon trading system!",WELCOME:"Welcome to {{name}}!",WELCOME_BACK:"Welcome back to {{name}}!",WHY_GO_THERE:"Now hang on, why would I wanna go in there?"},Lr={MUST_EQUIP_AXE:"You must equip an axe in order to cut trees.",MUST_EQUIP_PICKAXE:"You must be wielding a pickaxe in order to mine rocks.",MUST_EQUIP_FISHING:"You must be wielding a fishing utensil in order to fish.",MUST_EQUIP_FORAGING:"You require a special tool to forage this",INVALID_LEVEL_LUMBERJACKING:"You must be level {{level}} in order to cut this tree.",INVALID_LEVEL_MINING:"You must be level {{level}} in order to mine this rock.",INVALID_LEVEL_FISHING:"You must be level {{level}} in order to fish here.",INVALID_LEVEL_FORAGING:"You must be level {{level}} to harvest this resource.",UNABLE_TO_INTERACT_LUMBERJACKING:"You are unable to cut this tree at the moment.",UNABLE_TO_INTERACT_MINING:"You do not have the necessary knowledge to mine this rock.",UNABLE_TO_INTERACT_FISHING:"You are unable to fish here at the moment.",UNABLE_TO_INTERACT_FORAGING:"You are unable to harvest this resource at the moment.",NO_REASON_TREE:"There is no reason for you to cut this tree."},Or={WARNING_DUPLICATE:"Duplicate item key found in store: ",INVALID_STORE:"Tried to parse a non-existent store.",INVALID_STORE_REFRESH:"Tried to refresh invalid store: ",INVALID_ITEM_SELECTION:"Invalid item selection.",PURCHASE_INVALID_STORE:"tried purchasing an item that does not exist store: ",SELL_INVALID_ITEM:"tried selling an invalid item.",ITEM_OUT_OF_STOCK:"This item is currently out of stock.",NOT_ENOUGH_CURRENCY:"You do not have enough currency to buy this item.",NOT_ENOUGH_SPACE:"You do not have enough space in your inventory.",CANNOT_SELL_ITEM:"You cannot sell this item.",ACTION_STORE_NOT_OPEN:"Tried to perform an action on a store that is not open.",CHEATER:"You have been flagged for cheating. You cannot purchase anything.",RESTRICTED_STORE:"This store does not accept any items.",RESTRICTED_ITEM:"This item cannot be sold here.",INVALID_ITEM_COUNT:"You have entered an invalid amount of items.",HOLLOW_ADMIN:"As an admin you cannot interact with the economy."},Rr={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},xr={WARPED_TO:"You have warped to {{name}}.",CANNOT_WARP_ACHIEVEMENT:"This warp requires an achievement to be finished before use.",CANNOT_WARP_QUEST:"You must complete {{questName}} to warp to {{name}}.",CANNOT_WARP_LEVEL:"You must be at least level {{level}} to warp here.",CANNOT_WARP_JAIL:"You cannot teleport, you are jailed for another {{time}}.",CANNOT_WARP_TUTORIAL:"You must finish the tutorial before warping.",CANNOT_WARP_COMBAT:"You must wait 10 seconds after finishing combat to warp.",CANNOT_WARP_COOLDOWN:"You must wait another {{time}} to warp."},Dr={INVALID_DATA:"Неверные данные о крафте, пожалуйста, отправьте сообщение об ошибке.",INVALID_ITEM:"Выбран неверный элемент.",INVALID_ITEMS:"У вас нет необходимых предметов для его создания.",SELECT_ITEM:"Пожалуйста, выберите предмет для изготовления.",FAILED_CRAFT:"Вам не удалось создать. {{failedText}}"},Yr={NO_ITEM_SELECTED:"Вы не выбрали предмет для зачарования.",CANNOT_ENCHANT:"Выбранный вами предмет не может быть зачарован.",NO_SHARD:"Для зачарования предмета необходимо предоставить осколок.",FAILED_ENCHANT:"Вы попробовали зачаровать, но ничего не получилось.",SUCCESSFUL_ENCHANT:"Вы успешно зачаровали свой предмет."},Mr={ALREADY_EXISTS:"Гильдия с таким названием уже существует.",ALREADY_IN_GUILD:"Вы уже состоите в гильдии.",CANNOT_KICK_YOURSELF:"Вы не можете выгнать себя из гильдии.",GUILD_FULL:"Эта гильдия работает на пределе возможностей,нет мест",MUST_FINISH_TUTORIAL_CREATE:"Перед созданием гильдии необходимо завершить обучение.",NO_PERMISSION:"У вас нет на это разрешения.",NO_PERMISSION_RANK:"У вас нет разрешения на обновление ранга этого пользователя.",NOT_ENOUGH_GOLD:"Для создания гильдии необходимо иметь в инвентаре 30,000 золотых.",NOT_ALLOWED_GUESTS_JOIN:"Гостям не разрешается вступать в гильдии.",NOT_ALLOWED_GUESTS_CREATE:"Гости не могут создавать гильдии."},Pr={CANNOT_ACCESS_LOOTBAG:"Вы не можете получить доступ к этому мешку прямо сейчас.",REQUIRES_ACHIEVEMENT:"Для экипировки этого предмета требуется секретное достижение.",REQUIRES_QUEST:"Чтобы экипировать этот предмет, необходимо выполнить {{quest}}.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Для его использования ваш {{skill}} должен быть не ниже {{level}}.",TOTAL_LEVEL_REQUIREMENT:"Чтобы экипировать этот предмет, ваш общий уровень должен быть не ниже {{level}}."},Fr={ACCEPTED_TRADE:"Вы согласились на сделку.",ACCEPTED_TRADE_OTHER:"Другой игрок принял сделку.",ALREADY_HAVE_PET:"У вас уже есть домашнее животное.",BLACK_POTION:"Вы выпиваете черное зелье и начинаете чувствовать себя плохо.",CANNOT_ADD_ITEMS_TRADE:"Вы не можете больше добавлять товары в сделку.",CANNOT_ATTACK_CHEATER:"Этот игрок - мошенник, не стоит нападать на такого человека",CANNOT_ATTACK_CHEATER_SELF:"Извините, но читеры не могут атаковать других игроков, это было бы нечестно по отношению к ним!",CANNOT_ATTACK_MOB:"У вас нет причин нападать на этих существ.",CANNOT_ATTACK_PET:"Вы сошли с ума? Вызвать санитаров? Почему вы напали на домашнее животное?",CANNOT_ATTACK_PREY:"Вы не можете атаковать, пока являетесь добычей.",CANNOT_ATTACK_TARGET:"Вы не можете атаковать того, кто не является вашей целью.",CANNOT_ATTACK_LEVEL_DIFF:"Вы не можете атаковать того, кто находится более чем на 30 уровней выше или ниже вас.",CANNOT_DO_THAT:"Вы не можете сделать это прямо сейчас.",CANNOT_DROP_ITEM_DOOR:"Вы не можете бросить этот предмет, стоя в дверях.",CANNOT_PASS_DOOR:"Через эту дверь нельзя пройти.",CANNOT_PICK_UP_ITEM:"Этот предмет может забрать только {{username}}.",CANNOT_TALK:"Сейчас вы не можете говорить.",CANNOT_TRADE_ITEM:"Вы не можете обменять этот предмет.",CANNOT_TRADE_CHEATER:"Извините, но мошенники к торговле не допускаются.",CANNOT_TRADE_CHEATER_OTHER:"Этот игрок - мошенник, он может продать вам контрабанду!",CANNOT_TRADE_ADMIN:"Как администратор, вы не можете влиять на экономику.",CANNOT_TRADE_ADMIN_OTHER:"Игрок является администратором и с ним нельзя торговать.",DONT_THINK_GO_IN:"Я не думаю, что мне стоит туда идти...",ENTERED_LOBBY:"Вы вошли в лобби {{name}}.",EXITED_LOBBY:"Вы покинули лобби {{name}}.",IN_PVP_ZONE:"Вы вошли в зону PvP!",INVALID_AMOUNT:"Вы ввели недопустимую сумму.",DOOR_KEY_CRUMBLES:"Ключ рассыпается в пыль, когда вы проходите через дверь.",MINIMUM_PLAYERS_MINIGAME:"Для начала этой мини-игры должно быть не менее {{minimum}} игроков.",NEED_COMBAT:"Для использования этой способности необходимо находиться в бою.",NEED_WAIT_ABILIY:"Перед повторным использованием этой способности необходимо подождать {{duration}} секунд.",NO_IDEA:"Я понятия не имею, что это такое.",NO_ARROWS:"У вас нет стрел для стрельбы.",NO_ACHIEVEMENT_DOOR:"Чтобы пройти через эту дверь, необходимо выполнить достижение {{achievement}}.",NO_COMBAT_DOOR:"Ваш боевой уровень должен быть не ниже {{level}}, чтобы войти.",NO_QUEST_DOOR:"Чтобы пройти через эту дверь, необходимо выполнить квест {{quest}}.",NO_KEY_DOOR:"У вас нет ключа, необходимого для прохода через эту дверь.",NO_SKILL_DOOR:"Ваш {{skill}} должен быть не ниже {{level}}, чтобы войти.",NO_KNOWLEDGE_USE:"Вы не обладаете достаточными знаниями, чтобы использовать это.",NO_SPACE:"В инвентаре не хватает места.",NO_SPACE_OTHER:"У другого игрока недостаточно места в инвентаре.",NO_SPACE_PET:"У вас недостаточно места в инвентаре питомца.",NOT_IN_PVP_ZONE:"Вы больше не находитесь в зоне PvP!",NOT_ONLINE:"Игрок @aquamarine@{{username}}@crimson@ не в сети.",NOT_ENOUGH_MANA:"У вас недостаточно маны для использования этой способности.",PLEASE_MAKE_ROOM_REWARD:"Пожалуйста, освободите место в своем инвентаре, чтобы принять эту награду",POISONED:"Вы были отравлены!",POISON_WORN_OFF:"Яд выветрился.",PLEASE_REPORT_BUG:"Произошла ошибка, пожалуйста, сообщите об этом как об ошибке.",FREEZE_IMMUNITY:"Теперь вы невосприимчивы к эффектам замораживания в течение {{duration}} секунд.",FREEZE_IMMUNITY_WORN_OFF:"Ваш иммунитет к эффектам замораживания ослаб.",FIRE_IMMUNITY:"Теперь вы невосприимчивы к эффектам огня в течение {{duration}} секунд.",FIRE_IMMUNITY_WORN_OFF:"Ваш иммунитет к эффектам огня ослаб.",FRIENDS_USERNAME_TOO_LONG:"Это имя пользователя слишком длинное.",FRIENDS_ADD_SELF:"Послушайте, я понимаю, вам одиноко. Но вы не можете добавить себя в список друзей.",FRIENDS_ALREADY_ADDED:"Этот игрок уже находится в списке ваших друзей.",FRIENDS_USER_DOES_NOT_EXIST:"Игрока с таким именем пользователя не существует.",FRIENDS_NOT_IN_LIST:"Этого игрока нет в вашем списке друзей.",PEOPLE_ONLINE:"В настоящее время в сети находится {{population}} человек.",SKILL_LEVEL_UP:"Повышение уровня мастерства!",SKILL_LEVEL_UP_DESC:"Поздравляем, ваше {{name}} достигло уровня {{level}}!",JAILED:"В настоящее время вы находитесь в тюрьме на {{duration}}.",MUTED:"В данный момент вы в муте.",LOW_MANA:"Если у вас мало маны, ваши атаки будут слабее.",TRADE_REQUEST:"Вы запросили торговлю с {{username}}.",TRADE_REQUEST_OTHER:"{{username}} запросил торговлю с вами.",TRADE_EMPTY:"Йо, почему вы ничего не торгуете?",TRADE_COMPLETE:"Благодарим Вас за использование торговой системы BagsDungeon!",WELCOME:"Добро пожаловать в {{name}}!",WELCOME_BACK:"С возвращением в {{name}}!",WHY_GO_THERE:"Погодите, зачем мне туда идти?"},Ur={MUST_EQUIP_AXE:"Чтобы рубить деревья, необходимо вооружиться топором.",MUST_EQUIP_PICKAXE:"Для добычи камней необходимо использовать кирку.",MUST_EQUIP_FISHING:"Для ловли рыбы необходимо иметь при себе удочку или что-то другое.",MUST_EQUIP_FORAGING:"Для его добычи требуется специальный инструмент",INVALID_LEVEL_LUMBERJACKING:"Вы должны быть {{level}}, чтобы срубить это дерево.",INVALID_LEVEL_MINING:"Для добычи этой породы необходимо иметь уровень {{level}}.",INVALID_LEVEL_FISHING:"Чтобы ловить здесь рыбу, вы должны иметь уровень {{level}}.",INVALID_LEVEL_FORAGING:"Чтобы добыть этот ресурс, необходимо иметь уровень {{level}}.",UNABLE_TO_INTERACT_LUMBERJACKING:"В настоящее время вы не можете спилить это дерево.",UNABLE_TO_INTERACT_MINING:"Вы не обладаете необходимыми знаниями для добычи этой породы.",UNABLE_TO_INTERACT_FISHING:"В настоящее время вы не можете ловить здесь рыбу.",UNABLE_TO_INTERACT_FORAGING:"В настоящее время вы не можете добывать этот ресурс.",NO_REASON_TREE:"Нет никаких причин для того, чтобы спиливать это дерево.",NO_REASON_FISH:"Нет никаких причин для того, чтобы ловить здесь рыбу."},qr={WARNING_DUPLICATE:"В магазине найден дубликат ключа от товара:",INVALID_STORE:"Попытка разобрать несуществующий магазин.",INVALID_STORE_REFRESH:"Попытался обновить недействительный магазин:",INVALID_ITEM_SELECTION:"Неверный выбор элемента.",PURCHASE_INVALID_STORE:"пытались приобрести товар, которого нет в магазине:",SELL_INVALID_ITEM:"попытка продать недействительный товар.",ITEM_OUT_OF_STOCK:"В настоящее время этот товар отсутствует на складе.",NOT_ENOUGH_CURRENCY:"У вас недостаточно валюты для покупки этого товара.",NOT_ENOUGH_SPACE:"В инвентаре не хватает места.",CANNOT_SELL_ITEM:"Вы не можете продать этот товар.",ACTION_STORE_NOT_OPEN:"Попытался выполнить действие для магазина, который не открыт.",CHEATER:"Вы были отмечены за мошенничество. Вы не можете ничего приобрести.",RESTRICTED_STORE:"Этот магазин не принимает никаких товаров.",RESTRICTED_ITEM:"Этот товар не может быть продан здесь.",INVALID_ITEM_COUNT:"Вы ввели недопустимое количество товаров.",HOLLOW_ADMIN:"Как администратор вы не можете взаимодействовать с экономикой."},zr={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},Br={WARPED_TO:"Вы переместились в {{name}}.",CANNOT_WARP_ACHIEVEMENT:"Перед использованием этого искривления необходимо получить достижение.",CANNOT_WARP_QUEST:"Вы должны завершить {{questName}}, чтобы переместиться в {{name}}.",CANNOT_WARP_LEVEL:"Чтобы переместиться сюда, вы должны иметь уровень не ниже {{level}}.",CANNOT_WARP_JAIL:"Вы не можете переместится, вы заключены в тюрьму еще на {{time}}.",CANNOT_WARP_TUTORIAL:"Перед началом перемещения необходимо завершить обучение.",CANNOT_WARP_COMBAT:"После окончания боя необходимо подождать 10 секунд, чтобы переместиться.",CANNOT_WARP_COOLDOWN:"Вы должны подождать еще {{time}}, чтобы переместиться."},Xr={INVALID_DATA:"Invalid crafting data, please submit a bug report.",INVALID_ITEM:"Invalid item selected.",INVALID_ITEMS:"You do not have the required items to craft that.",SELECT_ITEM:"Please select an item to craft.",FAILED_CRAFT:"You have failed to craft {{failedText}} "},Hr={NO_ITEM_SELECTED:"You have not selected an item to enchant.",CANNOT_ENCHANT:"The item you have selected cannot be enchanted.",NO_SHARD:"You must provide a shard to enchant an item.",FAILED_ENCHANT:"You tried enchanting but nothing happened.",SUCCESSFUL_ENCHANT:"You successfully enchanted your item."},Gr={ALREADY_EXISTS:"A guild with that name already exists.",ALREADY_IN_GUILD:"You are already in a guild.",CANNOT_KICK_YOURSELF:"You cannot kick yourself from the guild.",GUILD_FULL:"This guild is at maximum capacity.",MUST_FINISH_TUTORIAL_CREATE:"You must finish the tutorial before creating a guild.",NO_PERMISSION:"You do not have permission to do that.",NO_PERMISSION_RANK:"You do not have permission to update the rank of that member.",NOT_ENOUGH_GOLD:"You need 30,000 gold in your inventory to create a guild.",NOT_ALLOWED_GUESTS_JOIN:"Guests are not allowed to join guilds.",NOT_ALLOWED_GUESTS_CREATE:"Guests are not allowed to create guilds."},Vr={CANNOT_ACCESS_LOOTBAG:"You cannot access this lootbag right now.",REQUIRES_ACHIEVEMENT:"This item requires a secret achievement to equip.",REQUIRES_QUEST:"You must complete {{quest}} to equip this item.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Your {{skill}} must be at least level {{level}} to equip this.",TOTAL_LEVEL_REQUIREMENT:"Your total level must be at least {{level}} to equip this item."},Wr={ACCEPTED_TRADE:"You have accepted the trade.",ACCEPTED_TRADE_OTHER:"The other player has accepted the trade.",ALREADY_HAVE_PET:"You already have a pet.",BLACK_POTION:"You drink the black potion and start feeling unwell.",CANNOT_ADD_ITEMS_TRADE:"You cannot add any more items to the trade.",CANNOT_ATTACK_CHEATER:"That player is a cheater, you do not wanna attack someone like that",CANNOT_ATTACK_CHEATER_SELF:"Sorry but cheaters cannot attack other players, that would not be fair to them!",CANNOT_ATTACK_MOB:"You have no reason to attack these creatures.",CANNOT_ATTACK_PET:"Are you crazy? Are you out of your mind? Why would you attack a pet?",CANNOT_ATTACK_PREY:"You cannot attack while you are the prey.",CANNOT_ATTACK_TARGET:"You cannot attack someone who is not your target.",CANNOT_ATTACK_LEVEL_DIFF:"You cannot attack someone more than 30 levels above or below you.",CANNOT_DO_THAT:"You cannot do that right now.",CANNOT_DROP_ITEM_DOOR:"You cannot drop this item while standing in a door.",CANNOT_PASS_DOOR:"You cannot pass through this door.",CANNOT_GLOBAL_CHAT_SECONDS:"You must wait another {{duration}} seconds before using global chat.",CANNOT_GLOBAL_CHAT_MINUTES:"You must wait another {{duration}} minutes before using global chat.",CANNOT_GLOBAL_CHAT_JAIL:"You cannot use global chat while you are jailed.",CANNOT_GLOBAL_CHAT_TUTORIAL:"You cannot use global chat while you are in the tutorial.",CANNOT_PICK_UP_ITEM:"This item can only be picked up by {{username}}.",CANNOT_TALK:"You cannot talk right now.",CANNOT_TRADE_ITEM:"You cannot trade this item.",CANNOT_TRADE_CHEATER:"Sorry but cheaters are not allowed to trade.",CANNOT_TRADE_CHEATER_OTHER:"That player is a cheater, he might sell you contraband!",CANNOT_TRADE_ADMIN:"As an administrator, you cannot influence the economy.",CANNOT_TRADE_ADMIN_OTHER:"The player is an administrator and cannot be traded with.",DONT_THINK_GO_IN:"I do not think I should go in there just yet...",ENTERED_LOBBY:"You have entered the lobby for {{name}}.",EXITED_LOBBY:"You have left the lobby for {{name}}.",IN_PVP_ZONE:"You have entered a PvP zone!",INVALID_AMOUNT:"You have entered an invalid amount.",DOOR_KEY_CRUMBLES:"The key crumbles to dust as you pass through the door.",MINIMUM_PLAYERS_MINIGAME:"There must be at least {{minimum}} players to start this minigame.",NEED_COMBAT:"You must be in combat to use this ability.",NEED_WAIT_ABILIY:"You need to wait {{duration}} seconds before using this ability again.",NO_IDEA:"I have no idea what that is.",NO_ARROWS:"You do not have any arrows to shoot.",NO_ACHIEVEMENT_DOOR:"You need to complete the achievement {{achievement}} to pass through this door.",NO_COMBAT_DOOR:"Your combat level must be at least {{level}} to enter.",NO_QUEST_DOOR:"You need to complete the quest {{quest}} to pass through this door.",NO_KEY_DOOR:"You do not have the required key to pass through this door.",NO_SKILL_DOOR:"Your {{skill}} must be at least {{level}} to enter.",NO_KNOWLEDGE_USE:"You do not have the knowledge to use this.",NO_SPACE:"You do not have enough space in your inventory.",NO_SPACE_OTHER:"The other player does not have enough space in their inventory.",NO_SPACE_PET:"You do not have enough space in your pet inventory.",NOT_IN_PVP_ZONE:"You are no longer in a PvP zone!",NOT_ONLINE:"Player @aquamarine@{{username}}@crimson@ is not online.",NOT_ENOUGH_MANA:"You do not have enough mana to use this ability.",PLEASE_MAKE_ROOM_REWARD:"Please make room in your inventory to accept this reward",POISONED:"You have been poisoned!",POISON_WORN_OFF:"The poison has worn off.",PLEASE_REPORT_BUG:"An error has occurred, please report this as a bug.",FREEZE_IMMUNITY:"You are now immune to freeze effects for {{duration}} seconds.",FREEZE_IMMUNITY_WORN_OFF:"Your immunity to freeze effects has worn off.",FIRE_IMMUNITY:"You are now immune to fire effects for {{duration}} seconds.",FIRE_IMMUNITY_WORN_OFF:"Your immunity to fire effects has worn off.",FRIENDS_USERNAME_TOO_LONG:"That username is too long.",FRIENDS_ADD_SELF:"Listen, I get it, you're lonely. But you cannot add yourself to the friends list.",FRIENDS_ALREADY_ADDED:"That player is already on your friends list.",FRIENDS_USER_DOES_NOT_EXIST:"No player with that username exists.",FRIENDS_NOT_IN_LIST:"That player is not on your friends list.",PEOPLE_ONLINE:"There are currently {{population}} people online.",SKILL_LEVEL_UP:"Skill level up!",SKILL_LEVEL_UP_DESC:"Congratulations, your {{name}} has reached level {{level}}!",JAILED:"You are currently jailed for {{duration}}.",MUTED:"You are currently muted.",LOW_MANA:"You are low on mana, your attacks will be weaker.",TRADE_REQUEST:"You have requested to trade with {{username}}.",TRADE_REQUEST_OTHER:"{{username}} has requested to trade with you.",TRADE_EMPTY:"Yo why are y'all trading nothing?",TRADE_COMPLETE:"Thank you for using BagsDungeon trading system!",WELCOME:"Welcome to {{name}}!",WELCOME_BACK:"Welcome back to {{name}}!",WHY_GO_THERE:"Now hang on, why would I wanna go in there?"},$r={MUST_EQUIP_AXE:"You must equip an axe in order to cut trees.",MUST_EQUIP_PICKAXE:"You must be wielding a pickaxe in order to mine rocks.",MUST_EQUIP_FISHING:"You must be wielding a fishing utensil in order to fish.",MUST_EQUIP_FORAGING:"You require a special tool to forage this",INVALID_LEVEL_LUMBERJACKING:"You must be level {{level}} in order to cut this tree.",INVALID_LEVEL_MINING:"You must be level {{level}} in order to mine this rock.",INVALID_LEVEL_FISHING:"You must be level {{level}} in order to fish here.",INVALID_LEVEL_FORAGING:"You must be level {{level}} to harvest this resource.",UNABLE_TO_INTERACT_LUMBERJACKING:"You are unable to cut this tree at the moment.",UNABLE_TO_INTERACT_MINING:"You do not have the necessary knowledge to mine this rock.",UNABLE_TO_INTERACT_FISHING:"You are unable to fish here at the moment.",UNABLE_TO_INTERACT_FORAGING:"You are unable to harvest this resource at the moment.",NO_REASON_TREE:"There is no reason for you to cut this tree."},Kr={WARNING_DUPLICATE:"Duplicate item key found in store: ",INVALID_STORE:"Tried to parse a non-existent store.",INVALID_STORE_REFRESH:"Tried to refresh invalid store: ",INVALID_ITEM_SELECTION:"Invalid item selection.",PURCHASE_INVALID_STORE:"tried purchasing an item that does not exist store: ",SELL_INVALID_ITEM:"tried selling an invalid item.",ITEM_OUT_OF_STOCK:"This item is currently out of stock.",NOT_ENOUGH_CURRENCY:"You do not have enough currency to buy this item.",NOT_ENOUGH_SPACE:"You do not have enough space in your inventory.",CANNOT_SELL_ITEM:"You cannot sell this item.",ACTION_STORE_NOT_OPEN:"Tried to perform an action on a store that is not open.",CHEATER:"You have been flagged for cheating. You cannot purchase anything.",RESTRICTED_STORE:"This store does not accept any items.",RESTRICTED_ITEM:"This item cannot be sold here.",INVALID_ITEM_COUNT:"You have entered an invalid amount of items.",HOLLOW_ADMIN:"As an admin you cannot interact with the economy."},jr={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},Zr={WARPED_TO:"You have warped to {{name}}.",CANNOT_WARP_ACHIEVEMENT:"This warp requires an achievement to be finished before use.",CANNOT_WARP_QUEST:"You must complete {{questName}} to warp to {{name}}.",CANNOT_WARP_LEVEL:"You must be at least level {{level}} to warp here.",CANNOT_WARP_JAIL:"You cannot teleport, you are jailed for another {{time}}.",CANNOT_WARP_TUTORIAL:"You must finish the tutorial before warping.",CANNOT_WARP_COMBAT:"You must wait 10 seconds after finishing combat to warp.",CANNOT_WARP_COOLDOWN:"You must wait another {{time}} to warp."},Qr={INVALID_DATA:"Hindi wasto ang paggawa, kailangan mo magsumite ng ulat ng bug.",INVALID_ITEM:"Hindi wasto ang item na iyong napili.",INVALID_ITEMS:"Mali ang item mo para gawin ito.",SELECT_ITEM:"Pumili ka ng item para gawin ito.",FAILED_CRAFT:"Nabigo kang gumawa. {{failedText}}",FAILED_CRAFT_ONE:" You have failed to craft the item."},Jr={NO_ITEM_SELECTED:"Kailangan mo pumili ng item para makapag enchant.",CANNOT_ENCHANT:"Ang napili mong item ay di pwedeng ma enchant.",NO_SHARD:"Kailangan mo ng shard upang ma enchant and item na ito",FAILED_ENCHANT:"Triny mong mag enchant pero walang nangyare.",SUCCESSFUL_ENCHANT:"Matagumpay mong na enchant ang iyong item."},eo={ALREADY_EXISTS:"Meron nang guild na may ganitong pangalan",ALREADY_IN_GUILD:"Ikaw ay nasa guild na.",CANNOT_KICK_YOURSELF:"Hindi mong pwedeng paalisin ang iyong sarili",GUILD_FULL:"Puno na ang Guild mo.",MUST_FINISH_TUTORIAL_CREATE:"Dapat mong tapusin ang tutorial, bago ka makagawa ng guild",NO_PERMISSION:"Kailangan mo ng permisyon para gawin yan.",NO_PERMISSION_RANK:"Wala kang permisyon na i-update ang ranggo ng miyembrong iyon.",NOT_ENOUGH_GOLD:"Kailangan mo ng 30,000 gold sa iyong imbentaryo para maka gawa ng isang guild.",NOT_ALLOWED_GUESTS_JOIN:"Ang mga Guest ay hindi pwedeng sumali sa mga guild.",NOT_ALLOWED_GUESTS_CREATE:"Ang mga guest ay hindi pwedeng gumawa nang guild."},to={CANNOT_ACCESS_LOOTBAG:"Hindi pa pwedeng ma access ang lootbag na ito",REQUIRES_ACHIEVEMENT:"Ang item na ito ay kailangan ng Secret Achievement upang magamit 'to",REQUIRES_QUEST:"Kailangan mong tapusin ang {{quest}} para ma equip ito.",SKILL_LEVEL_REQUIREMENT_EQUIP:"Iyong {{skill}} ay kailangang maging {{level}} para ma equip ito.",TOTAL_LEVEL_REQUIREMENT:"Your total level must be at least {{level}} to equip this item."},io={ACCEPTED_TRADE:"Tinangap mo ang Trade.",ACCEPTED_TRADE_OTHER:"Tinanggap na nang ibang player ang trade.",ALREADY_HAVE_PET:"Meron ka nang Pet.",BLACK_POTION:"Uminom ka nang Black Potion at nagsimulang sumama ang pakiramdam mo.",CANNOT_ADD_ITEMS_TRADE:"Hindi ka pwedeng maka dagdag ng item sa Trade.",CANNOT_ATTACK_CHEATER:"Ang player na yan ay isang cheater, wag mong atakihin yan",CANNOT_ATTACK_CHEATER_SELF:"Paumanhin, hindi maaring maka atake ang mga Cheater",CANNOT_ATTACK_MOB:"Hindi mo pwedeng atakihin ang nilalang na ito.",CANNOT_ATTACK_PET:"BAWLIW KABA?! Nasisiraan kaba ng bait? bakit ka umaatake ng hayop?!",CANNOT_ATTACK_PREY:"Hindi ka maaring umatake habang ikaw ang biktima.",CANNOT_ATTACK_TARGET:"Hindi mo maaring atakihin ang salakayin na hindi mo target.",CANNOT_ATTACK_LEVEL_DIFF:"Hindi mo maaring atakihin ang player na higit 30 levels sa iyo.",CANNOT_DO_THAT:"Hindi mo magawa yan ngayon.",CANNOT_DROP_ITEM_DOOR:"Hindi mo pwedeng mabitawan ang item na ito habang ikaw ay nakatayo sa isang pinto.",CANNOT_PASS_DOOR:"Di ka pwedeng makadaan sa pinto na ito.",CANNOT_GLOBAL_CHAT_SECONDS:"Kailangan mong mag hintay ng {{duration}} segundo bago maka gamit ng Global Chat.",CANNOT_GLOBAL_CHAT_MINUTES:"Kailangan mong mag hintay ng {{duration}} minuto bago maka gamit ng Global Chat.",CANNOT_GLOBAL_CHAT_JAIL:"Hindi ka pwedeng makapag Global Chat habang ikaw ay nasa kulungan.",CANNOT_GLOBAL_CHAT_TUTORIAL:"Hindi ka pwedeng makapag Global chat habang ikaw ay nasa Tutorial.",CANNOT_PICK_UP_ITEM:"ang item na ito at ma ari lamang kunin ni {{username}}.",CANNOT_TALK:"Hindi ka makapagsalita ngayon",CANNOT_TRADE_ITEM:"Hindi ma aring i-trade ang item na ito.",CANNOT_TRADE_CHEATER:"Paumanhi pero bawal mag trade ang mga cheaters.",CANNOT_TRADE_CHEATER_OTHER:"Manloloko ang player na yan, baka bebentahan ka ng droga nyan!",CANNOT_TRADE_ADMIN:"Bilang isang admin, hindi mo maiimpluwensya ang ekonomiya ng BagsDungeon.",CANNOT_TRADE_ADMIN_OTHER:"Ang Player na to ay isang admin at hindi maaring makapag trade sakanya.",DONT_THINK_GO_IN:"Sa tingin ko, dapat di pa ako papasok diyan.",ENTERED_LOBBY:"Pumasok ka sa lobby ni {{name}}.",EXITED_LOBBY:"Umalis ka sa lobby ni {{name}}.",IN_PVP_ZONE:"Pumasok ka sa isang PvP zone!",INVALID_AMOUNT:"Hindi wastong halaga ang nilagay mo.",DOOR_KEY_CRUMBLES:"Ang susi ay gumuho at naging alikabok habang dumadaan ka sa pintuan",MINIMUM_PLAYERS_MINIGAME:"Dapat merong at least {{minimum}} na players upang makapag laro sa mini-game na ito.",NEED_COMBAT:"Dapat ay nasa laban ka upang magamit ang abilidad na ito",NEED_WAIT_ABILIY:"Kailangan mo mag hintay ng {{duration}} segundo bago gamitin ang abilidad na ito.",NO_IDEA:"Di ko alam kung ano ito.",NO_ARROWS:"Kailangan mo ng arrow para makapag tira.",NO_ACHIEVEMENT_DOOR:"Kailangan mong kumpletohin ang {{achievement}} upang makapag daan sa pinto na ito.",NO_COMBAT_DOOR:"Ang iyong combat level ay dapat at least {{level}} para makapasok.",NO_QUEST_DOOR:"Kailangan mong kumpletuhin ang quest na {{quest}} para makapasok sa pinto na ito.",NO_KEY_DOOR:"You do not have the required key to pass through this door.",NO_SKILL_DOOR:"Ang {{skill}} ay dapat atleast {{level}} para maka pasok.",NO_KNOWLEDGE_USE:"Kulang ang kaalaman mo para gamitin ito.",NO_SPACE:"Kulang ng espasyo ang iyong imbentaryo.",NO_SPACE_OTHER:"Kulang sa espasyo ang imbentaryo ng ibang malalaro.",NO_SPACE_PET:"Kulang ang espasyo ng iyong Pet Inventory.",NOT_IN_PVP_ZONE:"Wala ka na sa PvP zone!",NOT_ONLINE:"Player @aquamarine@{{username}}@crimson@ ay hindi online.",NOT_ENOUGH_MANA:"Kulang ang mana mo para gamitin ang abilidad na ito.",PLEASE_MAKE_ROOM_REWARD:"Mag bigay ng puwang sa iyong imbentaryo upang ma tanggap ang reward",POISONED:"Nalason ka!",POISON_WORN_OFF:"Nawala na ang lason.",PLEASE_REPORT_BUG:"May error na naganap, i-report ito bilang isang bug.",FREEZE_IMMUNITY:"Ikaw ay immune sa mga Freeze Effect hanggang {{duration}} segundo.",FREEZE_IMMUNITY_WORN_OFF:"Nawala na ang immunity mo sa Freeze Effect.",FIRE_IMMUNITY:"Ikaw ay immune sa mga Fire Effect hanggang {{duration}} segundo.",FIRE_IMMUNITY_WORN_OFF:"Nawala na ang immunity mo sa Fire Effect.",FRIENDS_USERNAME_TOO_LONG:"Ang username mo ay masyadong mahaba.",FRIENDS_ADD_SELF:"Makinig ka, alam ko ikaw ay nag-iisa at walang jowa pero di mo pwedeng i-add sarili mo.",FRIENDS_ALREADY_ADDED:"Ang player na ito ay nasa Friends List mo na.",FRIENDS_USER_DOES_NOT_EXIST:"Walang player na merong ganon na username.",FRIENDS_NOT_IN_LIST:"Ang player na to ay wala sa iyong Friends list.",PEOPLE_ONLINE:"Merong {{population}} na manlalaro.",SKILL_LEVEL_UP:"Tumaas ang level ng skill mo",SKILL_LEVEL_UP_DESC:"Congratulations, si {{name}} ay naging {{level}}!",JAILED:"Ikaw ay nasa kulungan hanggang {{duration}}.",MUTED:"Ikaw ay naka-mute.",LOW_MANA:"Mababa ang mana mo, ang iyong mga atake ay magiging mas mahina.",TRADE_REQUEST:"Humihiling kang makipag trade kay {{username}}.",TRADE_REQUEST_OTHER:"Si {{username}} ay humihiling na makipag trade sa iyo.",TRADE_EMPTY:"Yo, Bakit wala kayong pinagpalit?",TRADE_COMPLETE:"Salamat sa paggamit ng Trading System nang BagsDungeon!",WELCOME:"Maligayang pagdating {{name}}!",WELCOME_BACK:"Maligayang pag balik {{name}}!",WHY_GO_THERE:"Teka lang, bakit ako pupunta diyan?"},so={MUST_EQUIP_AXE:"You must equip an axe in order to cut trees.",MUST_EQUIP_PICKAXE:"You must be wielding a pickaxe in order to mine rocks.",MUST_EQUIP_FISHING:"You must be wielding a fishing utensil in order to fish.",MUST_EQUIP_FORAGING:"You require a special tool to forage this",INVALID_LEVEL_LUMBERJACKING:"You must be level {{level}} in order to cut this tree.",INVALID_LEVEL_MINING:"You must be level {{level}} in order to mine this rock.",INVALID_LEVEL_FISHING:"You must be level {{level}} in order to fish here.",INVALID_LEVEL_FORAGING:"You must be level {{level}} to harvest this resource.",UNABLE_TO_INTERACT_LUMBERJACKING:"You are unable to cut this tree at the moment.",UNABLE_TO_INTERACT_MINING:"You do not have the necessary knowledge to mine this rock.",UNABLE_TO_INTERACT_FISHING:"You are unable to fish here at the moment.",UNABLE_TO_INTERACT_FORAGING:"You are unable to harvest this resource at the moment.",NO_REASON_TREE:"There is no reason for you to cut this tree.",NO_REASON_FISHING:"There is no reason for you to fish here."},ao={WARNING_DUPLICATE:"Duplicate item key found in store: ",INVALID_STORE:"Tried to parse a non-existent store.",INVALID_STORE_REFRESH:"Tried to refresh invalid store: ",INVALID_ITEM_SELECTION:"Invalid item selection.",PURCHASE_INVALID_STORE:"tried purchasing an item that does not exist store: ",SELL_INVALID_ITEM:"tried selling an invalid item.",ITEM_OUT_OF_STOCK:"This item is currently out of stock.",NOT_ENOUGH_CURRENCY:"You do not have enough currency to buy this item.",NOT_ENOUGH_SPACE:"You do not have enough space in your inventory.",CANNOT_SELL_ITEM:"You cannot sell this item.",ACTION_STORE_NOT_OPEN:"Tried to perform an action on a store that is not open.",CHEATER:"You have been flagged for cheating. You cannot purchase anything.",RESTRICTED_STORE:"This store does not accept any items.",RESTRICTED_ITEM:"This item cannot be sold here.",INVALID_ITEM_COUNT:"You have entered an invalid amount of items.",HOLLOW_ADMIN:"As an admin you cannot interact with the economy."},no={NAME:"BagsDungeon",DESCRIPTION:"BagsDungeon is a 2D MMORPG dungeon adventure inside BagsWorld — the self-evolving pixel art game on Solana. Powered by the Kaetram open-source engine (MPL-2.0)."},ro={WARPED_TO:"Ikaw ay winarp kay {{name}}.",CANNOT_WARP_ACHIEVEMENT:"Ang warp na ito ay kailangan ng Achievement na dapat tapusin bago ito gamitin.",CANNOT_WARP_QUEST:"Kailangan mong tapusin ang {{questName}} para makapag warp kay {{name}}.",CANNOT_WARP_LEVEL:"Kailangan mo maging atleast level {{level}} para makapag warp dito.",CANNOT_WARP_JAIL:"Hindi ka pwedeng mag-teleport dahil ikaw ay nakulong hanggang {{time}}.",CANNOT_WARP_TUTORIAL:"Kailangan mong tapusin ang tutorial bago makapag warp.",CANNOT_WARP_COMBAT:"Kailangan mong mag hintay ng Sampung segundo pagkatapos mong lumaban upang makapag warp.",CANNOT_WARP_COOLDOWN:"Kailangan mo mag hintay ng {{time}} para makapag warp."};let Ya={en:{crafting:Xn,enchant:Hn,guilds:Gn,item:Vn,misc:Wn,resource:$n,store:Kn,game:jn,warps:Zn},de:{crafting:Qn,enchant:Jn,guilds:er,item:tr,misc:ir,resource:sr,store:ar,game:nr,warps:rr},es:{crafting:or,enchant:lr,guilds:hr,item:dr,misc:ur,resource:cr,store:gr,game:mr,warps:fr},fr:{crafting:pr,enchant:wr,guilds:_r,item:br,misc:yr,resource:kr,store:Er,game:Tr,warps:Sr},pt:{crafting:Xr,enchant:Hr,guilds:Gr,item:Vr,misc:Wr,resource:$r,store:Kr,game:jr,warps:Zr},ro:{crafting:vr,enchant:Ir,guilds:Cr,item:Ar,misc:Nr,resource:Lr,store:Or,game:Rr,warps:xr},ru:{crafting:Dr,enchant:Yr,guilds:Mr,item:Pr,misc:Fr,resource:Ur,store:qr,game:zr,warps:Br},tl:{crafting:Qr,enchant:Jr,guilds:eo,item:to,misc:io,resource:so,store:ao,game:no,warps:ro}},Ki="en",oo=Ya[Ki],lo=Object.keys(oo);const ho={type:"logger",log(i){this.output("log",i)},warn(i){this.output("warn",i)},error(i){this.output("error",i)},output(i,e){console&&console[i]&&console[i].apply(console,e)}};class ui{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||ho,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,s,a){return a&&!this.debug?null:(typeof e[0]=="string"&&(e[0]=`${s}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new ui(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ui(this.logger,e)}}var _e=new ui;class bi{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(s=>{this.observers[s]=this.observers[s]||[],this.observers[s].push(t)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e]=this.observers[e].filter(s=>s!==t)}}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];this.observers[e]&&[].concat(this.observers[e]).forEach(r=>{r(...s)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(r=>{r.apply(r,[e,...s])})}}function mt(){let i,e;const t=new Promise((s,a)=>{i=s,e=a});return t.resolve=i,t.reject=e,t}function ks(i){return i==null?"":""+i}function uo(i,e,t){i.forEach(s=>{e[s]&&(t[s]=e[s])})}function rs(i,e,t){function s(r){return r&&r.indexOf("###")>-1?r.replace(/###/g,"."):r}function a(){return!i||typeof i=="string"}const n=typeof e!="string"?[].concat(e):e.split(".");for(;n.length>1;){if(a())return{};const r=s(n.shift());!i[r]&&t&&(i[r]=new t),Object.prototype.hasOwnProperty.call(i,r)?i=i[r]:i={}}return a()?{}:{obj:i,k:s(n.shift())}}function Es(i,e,t){const{obj:s,k:a}=rs(i,e,Object);s[a]=t}function co(i,e,t,s){const{obj:a,k:n}=rs(i,e,Object);a[n]=a[n]||[],s&&(a[n]=a[n].concat(t)),s||a[n].push(t)}function ci(i,e){const{obj:t,k:s}=rs(i,e);if(t)return t[s]}function go(i,e,t){const s=ci(i,t);return s!==void 0?s:ci(e,t)}function Ma(i,e,t){for(const s in e)s!=="__proto__"&&s!=="constructor"&&(s in i?typeof i[s]=="string"||i[s]instanceof String||typeof e[s]=="string"||e[s]instanceof String?t&&(i[s]=e[s]):Ma(i[s],e[s],t):i[s]=e[s]);return i}function Je(i){return i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var mo={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function fo(i){return typeof i=="string"?i.replace(/[&<>"'\/]/g,e=>mo[e]):i}const po=[" ",",","?","!",";"];function wo(i,e,t){e=e||"",t=t||"";const s=po.filter(r=>e.indexOf(r)<0&&t.indexOf(r)<0);if(s.length===0)return!0;const a=new RegExp(`(${s.map(r=>r==="?"?"\\?":r).join("|")})`);let n=!a.test(i);if(!n){const r=i.indexOf(t);r>0&&!a.test(i.substring(0,r))&&(n=!0)}return n}function gi(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!i)return;if(i[e])return i[e];const s=e.split(t);let a=i;for(let n=0;n<s.length;++n){if(!a||typeof a[s[n]]=="string"&&n+1<s.length)return;if(a[s[n]]===void 0){let r=2,o=s.slice(n,n+r).join(t),h=a[o];for(;h===void 0&&s.length>n+r;)r++,o=s.slice(n,n+r).join(t),h=a[o];if(h===void 0)return;if(h===null)return null;if(e.endsWith(o)){if(typeof h=="string")return h;if(o&&typeof h[o]=="string")return h[o]}const l=s.slice(n+r).join(t);return l?gi(h,l,t):void 0}a=a[s[n]]}return a}function mi(i){return i&&i.indexOf("_")>0?i.replace("_","-"):i}class Ts extends bi{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const n=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,r=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let o=[e,t];s&&typeof s!="string"&&(o=o.concat(s)),s&&typeof s=="string"&&(o=o.concat(n?s.split(n):s)),e.indexOf(".")>-1&&(o=e.split("."));const h=ci(this.data,o);return h||!r||typeof s!="string"?h:gi(this.data&&this.data[e]&&this.data[e][t],s,n)}addResource(e,t,s,a){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const r=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let o=[e,t];s&&(o=o.concat(r?s.split(r):s)),e.indexOf(".")>-1&&(o=e.split("."),a=t,t=o[1]),this.addNamespaces(t),Es(this.data,o,a),n.silent||this.emit("added",e,t,s,a)}addResources(e,t,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const n in s)(typeof s[n]=="string"||Object.prototype.toString.apply(s[n])==="[object Array]")&&this.addResource(e,t,n,s[n],{silent:!0});a.silent||this.emit("added",e,t,s)}addResourceBundle(e,t,s,a,n){let r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),a=s,s=t,t=o[1]),this.addNamespaces(t);let h=ci(this.data,o)||{};a?Ma(h,s,n):h={...h,...s},Es(this.data,o,h),r.silent||this.emit("added",e,t,s)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(a=>t[a]&&Object.keys(t[a]).length>0)}toJSON(){return this.data}}var Pa={processors:{},addPostProcessor(i){this.processors[i.name]=i},handle(i,e,t,s,a){return i.forEach(n=>{this.processors[n]&&(e=this.processors[n].process(e,t,s,a))}),e}};const Ss={};class fi extends bi{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),uo(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=_e.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const s=this.resolve(e,t);return s&&s.res!==void 0}extractFromKey(e,t){let s=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;s===void 0&&(s=":");const a=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let n=t.ns||this.options.defaultNS||[];const r=s&&e.indexOf(s)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!wo(e,s,a);if(r&&!o){const h=e.match(this.interpolator.nestingRegexp);if(h&&h.length>0)return{key:e,namespaces:n};const l=e.split(s);(s!==a||s===a&&this.options.ns.indexOf(l[0])>-1)&&(n=l.shift()),e=l.join(a)}return typeof n=="string"&&(n=[n]),{key:e,namespaces:n}}translate(e,t,s){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const a=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,n=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:r,namespaces:o}=this.extractFromKey(e[e.length-1],t),h=o[o.length-1],l=t.lng||this.language,d=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&l.toLowerCase()==="cimode"){if(d){const w=t.nsSeparator||this.options.nsSeparator;return a?{res:`${h}${w}${r}`,usedKey:r,exactUsedKey:r,usedLng:l,usedNS:h}:`${h}${w}${r}`}return a?{res:r,usedKey:r,exactUsedKey:r,usedLng:l,usedNS:h}:r}const c=this.resolve(e,t);let u=c&&c.res;const g=c&&c.usedKey||r,f=c&&c.exactUsedKey||r,y=Object.prototype.toString.apply(u),k=["[object Number]","[object Function]","[object RegExp]"],T=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject;if(v&&u&&(typeof u!="string"&&typeof u!="boolean"&&typeof u!="number")&&k.indexOf(y)<0&&!(typeof T=="string"&&y==="[object Array]")){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const w=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,u,{...t,ns:o}):`key '${r} (${this.language})' returned an object instead of string.`;return a?(c.res=w,c):w}if(n){const w=y==="[object Array]",E=w?[]:{},M=w?f:g;for(const b in u)if(Object.prototype.hasOwnProperty.call(u,b)){const D=`${M}${n}${b}`;E[b]=this.translate(D,{...t,joinArrays:!1,ns:o}),E[b]===D&&(E[b]=u[b])}u=E}}else if(v&&typeof T=="string"&&y==="[object Array]")u=u.join(T),u&&(u=this.extendTranslation(u,e,t,s));else{let w=!1,E=!1;const M=t.count!==void 0&&typeof t.count!="string",b=fi.hasDefaultValue(t),D=M?this.pluralResolver.getSuffix(l,t.count,t):"",O=t.ordinal&&M?this.pluralResolver.getSuffix(l,t.count,{ordinal:!1}):"",I=t[`defaultValue${D}`]||t[`defaultValue${O}`]||t.defaultValue;!this.isValidLookup(u)&&b&&(w=!0,u=I),this.isValidLookup(u)||(E=!0,u=r);const ke=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:u,Oe=b&&I!==u&&this.options.updateMissing;if(E||w||Oe){if(this.logger.log(Oe?"updateKey":"missingKey",l,h,r,Oe?I:u),n){const ie=this.resolve(r,{...t,keySeparator:!1});ie&&ie.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let me=[];const Ee=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Ee&&Ee[0])for(let ie=0;ie<Ee.length;ie++)me.push(Ee[ie]);else this.options.saveMissingTo==="all"?me=this.languageUtils.toResolveHierarchy(t.lng||this.language):me.push(t.lng||this.language);const ms=(ie,Qe,fs)=>{const ps=b&&fs!==u?fs:ke;this.options.missingKeyHandler?this.options.missingKeyHandler(ie,h,Qe,ps,Oe,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(ie,h,Qe,ps,Oe,t),this.emit("missingKey",ie,h,Qe,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&M?me.forEach(ie=>{this.pluralResolver.getSuffixes(ie,t).forEach(Qe=>{ms([ie],r+Qe,t[`defaultValue${Qe}`]||I)})}):ms(me,r,I))}u=this.extendTranslation(u,e,t,c,s),E&&u===r&&this.options.appendNamespaceToMissingKey&&(u=`${h}:${r}`),(E||w)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?u=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${h}:${r}`:r,w?u:void 0):u=this.options.parseMissingKeyHandler(u))}return a?(c.res=u,c):u}extendTranslation(e,t,s,a,n){var r=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const l=typeof e=="string"&&(s&&s.interpolation&&s.interpolation.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(l){const u=e.match(this.interpolator.nestingRegexp);d=u&&u.length}let c=s.replace&&typeof s.replace!="string"?s.replace:s;if(this.options.interpolation.defaultVariables&&(c={...this.options.interpolation.defaultVariables,...c}),e=this.interpolator.interpolate(e,c,s.lng||this.language,s),l){const u=e.match(this.interpolator.nestingRegexp),g=u&&u.length;d<g&&(s.nest=!1)}!s.lng&&this.options.compatibilityAPI!=="v1"&&a&&a.res&&(s.lng=a.usedLng),s.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var u=arguments.length,g=new Array(u),f=0;f<u;f++)g[f]=arguments[f];return n&&n[0]===g[0]&&!s.context?(r.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${t[0]}`),null):r.translate(...g,t)},s)),s.interpolation&&this.interpolator.reset()}const o=s.postProcess||this.options.postProcess,h=typeof o=="string"?[o]:o;return e!=null&&h&&h.length&&s.applyPostProcessor!==!1&&(e=Pa.handle(h,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:a,...s}:s,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s,a,n,r,o;return typeof e=="string"&&(e=[e]),e.forEach(h=>{if(this.isValidLookup(s))return;const l=this.extractFromKey(h,t),d=l.key;a=d;let c=l.namespaces;this.options.fallbackNS&&(c=c.concat(this.options.fallbackNS));const u=t.count!==void 0&&typeof t.count!="string",g=u&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),f=t.context!==void 0&&(typeof t.context=="string"||typeof t.context=="number")&&t.context!=="",y=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);c.forEach(k=>{this.isValidLookup(s)||(o=k,!Ss[`${y[0]}-${k}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(Ss[`${y[0]}-${k}`]=!0,this.logger.warn(`key "${a}" for languages "${y.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(T=>{if(this.isValidLookup(s))return;r=T;const v=[d];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(v,d,T,k,t);else{let w;u&&(w=this.pluralResolver.getSuffix(T,t.count,t));const E=`${this.options.pluralSeparator}zero`,M=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(u&&(v.push(d+w),t.ordinal&&w.indexOf(M)===0&&v.push(d+w.replace(M,this.options.pluralSeparator)),g&&v.push(d+E)),f){const b=`${d}${this.options.contextSeparator}${t.context}`;v.push(b),u&&(v.push(b+w),t.ordinal&&w.indexOf(M)===0&&v.push(b+w.replace(M,this.options.pluralSeparator)),g&&v.push(b+E))}}let S;for(;S=v.pop();)this.isValidLookup(s)||(n=S,s=this.getResource(T,k,S,t))}))})}),{res:s,usedKey:a,exactUsedKey:n,usedLng:r,usedNS:o}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,s,a):this.resourceStore.getResource(e,t,s,a)}static hasDefaultValue(e){const t="defaultValue";for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t===s.substring(0,t.length)&&e[s]!==void 0)return!0;return!1}}function vi(i){return i.charAt(0).toUpperCase()+i.slice(1)}class vs{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=_e.create("languageUtils")}getScriptPartFromCode(e){if(e=mi(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=mi(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(typeof e=="string"&&e.indexOf("-")>-1){const t=["hans","hant","latn","cyrl","cans","mong","arab"];let s=e.split("-");return this.options.lowerCaseLng?s=s.map(a=>a.toLowerCase()):s.length===2?(s[0]=s[0].toLowerCase(),s[1]=s[1].toUpperCase(),t.indexOf(s[1].toLowerCase())>-1&&(s[1]=vi(s[1].toLowerCase()))):s.length===3&&(s[0]=s[0].toLowerCase(),s[1].length===2&&(s[1]=s[1].toUpperCase()),s[0]!=="sgn"&&s[2].length===2&&(s[2]=s[2].toUpperCase()),t.indexOf(s[1].toLowerCase())>-1&&(s[1]=vi(s[1].toLowerCase())),t.indexOf(s[2].toLowerCase())>-1&&(s[2]=vi(s[2].toLowerCase()))),s.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(s=>{if(t)return;const a=this.formatLanguageCode(s);(!this.options.supportedLngs||this.isSupportedCode(a))&&(t=a)}),!t&&this.options.supportedLngs&&e.forEach(s=>{if(t)return;const a=this.getLanguagePartFromCode(s);if(this.isSupportedCode(a))return t=a;t=this.options.supportedLngs.find(n=>{if(n===a)return n;if(!(n.indexOf("-")<0&&a.indexOf("-")<0)&&n.indexOf(a)===0)return n})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),typeof e=="string"&&(e=[e]),Object.prototype.toString.apply(e)==="[object Array]")return e;if(!t)return e.default||[];let s=e[t];return s||(s=e[this.getScriptPartFromCode(t)]),s||(s=e[this.formatLanguageCode(t)]),s||(s=e[this.getLanguagePartFromCode(t)]),s||(s=e.default),s||[]}toResolveHierarchy(e,t){const s=this.getFallbackCodes(t||this.options.fallbackLng||[],e),a=[],n=r=>{r&&(this.isSupportedCode(r)?a.push(r):this.logger.warn(`rejecting language code not found in supportedLngs: ${r}`))};return typeof e=="string"&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&n(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&n(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&n(this.getLanguagePartFromCode(e))):typeof e=="string"&&n(this.formatLanguageCode(e)),s.forEach(r=>{a.indexOf(r)<0&&n(this.formatLanguageCode(r))}),a}}let _o=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],bo={1:function(i){return+(i>1)},2:function(i){return+(i!=1)},3:function(i){return 0},4:function(i){return i%10==1&&i%100!=11?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2},5:function(i){return i==0?0:i==1?1:i==2?2:i%100>=3&&i%100<=10?3:i%100>=11?4:5},6:function(i){return i==1?0:i>=2&&i<=4?1:2},7:function(i){return i==1?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2},8:function(i){return i==1?0:i==2?1:i!=8&&i!=11?2:3},9:function(i){return+(i>=2)},10:function(i){return i==1?0:i==2?1:i<7?2:i<11?3:4},11:function(i){return i==1||i==11?0:i==2||i==12?1:i>2&&i<20?2:3},12:function(i){return+(i%10!=1||i%100==11)},13:function(i){return+(i!==0)},14:function(i){return i==1?0:i==2?1:i==3?2:3},15:function(i){return i%10==1&&i%100!=11?0:i%10>=2&&(i%100<10||i%100>=20)?1:2},16:function(i){return i%10==1&&i%100!=11?0:i!==0?1:2},17:function(i){return i==1||i%10==1&&i%100!=11?0:1},18:function(i){return i==0?0:i==1?1:2},19:function(i){return i==1?0:i==0||i%100>1&&i%100<11?1:i%100>10&&i%100<20?2:3},20:function(i){return i==1?0:i==0||i%100>0&&i%100<20?1:2},21:function(i){return i%100==1?1:i%100==2?2:i%100==3||i%100==4?3:0},22:function(i){return i==1?0:i==2?1:(i<0||i>10)&&i%10==0?2:3}};const yo=["v1","v2","v3"],ko=["v4"],Is={zero:0,one:1,two:2,few:3,many:4,other:5};function Eo(){const i={};return _o.forEach(e=>{e.lngs.forEach(t=>{i[t]={numbers:e.nr,plurals:bo[e.fc]}})}),i}class To{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=_e.create("pluralResolver"),(!this.options.compatibilityJSON||ko.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Eo()}addRule(e,t){this.rules[e]=t}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(mi(e),{type:t.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=this.getRule(e,t);return this.shouldUseIntlApi()?s&&s.resolvedOptions().pluralCategories.length>1:s&&s.numbers.length>1}getPluralFormsOfKey(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,s).map(a=>`${t}${a}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=this.getRule(e,t);return s?this.shouldUseIntlApi()?s.resolvedOptions().pluralCategories.sort((a,n)=>Is[a]-Is[n]).map(a=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${a}`):s.numbers.map(a=>this.getSuffix(e,a,t)):[]}getSuffix(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.getRule(e,s);return a?this.shouldUseIntlApi()?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${a.select(t)}`:this.getSuffixRetroCompatible(a,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const s=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let a=e.numbers[s];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(a===2?a="plural":a===1&&(a=""));const n=()=>this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString();return this.options.compatibilityJSON==="v1"?a===1?"":typeof a=="number"?`_plural_${a.toString()}`:n():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?n():this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString()}shouldUseIntlApi(){return!yo.includes(this.options.compatibilityJSON)}}function Cs(i,e,t){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,n=go(i,e,t);return!n&&a&&typeof t=="string"&&(n=gi(i,t,s),n===void 0&&(n=gi(e,t,s))),n}class So{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=_e.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(t=>t),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const t=e.interpolation;this.escape=t.escape!==void 0?t.escape:fo,this.escapeValue=t.escapeValue!==void 0?t.escapeValue:!0,this.useRawValueToEscape=t.useRawValueToEscape!==void 0?t.useRawValueToEscape:!1,this.prefix=t.prefix?Je(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?Je(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?Je(t.nestingPrefix):t.nestingPrefixEscaped||Je("$t("),this.nestingSuffix=t.nestingSuffix?Je(t.nestingSuffix):t.nestingSuffixEscaped||Je(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=t.alwaysFormat!==void 0?t.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(e,"g");const t=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(t,"g");const s=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(s,"g")}interpolate(e,t,s,a){let n,r,o;const h=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(f){return f.replace(/\$/g,"$$$$")}const d=f=>{if(f.indexOf(this.formatSeparator)<0){const v=Cs(t,h,f,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(v,void 0,s,{...a,...t,interpolationkey:f}):v}const y=f.split(this.formatSeparator),k=y.shift().trim(),T=y.join(this.formatSeparator).trim();return this.format(Cs(t,h,k,this.options.keySeparator,this.options.ignoreJSONStructure),T,s,{...a,...t,interpolationkey:k})};this.resetRegExp();const c=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,u=a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:f=>l(f)},{regex:this.regexp,safeValue:f=>this.escapeValue?l(this.escape(f)):l(f)}].forEach(f=>{for(o=0;n=f.regex.exec(e);){const y=n[1].trim();if(r=d(y),r===void 0)if(typeof c=="function"){const T=c(e,n,a);r=typeof T=="string"?T:""}else if(a&&Object.prototype.hasOwnProperty.call(a,y))r="";else if(u){r=n[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),r="";else typeof r!="string"&&!this.useRawValueToEscape&&(r=ks(r));const k=f.safeValue(r);if(e=e.replace(n[0],k),u?(f.regex.lastIndex+=r.length,f.regex.lastIndex-=n[0].length):f.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,n,r;function o(h,l){const d=this.nestingOptionsSeparator;if(h.indexOf(d)<0)return h;const c=h.split(new RegExp(`${d}[ ]*{`));let u=`{${c[1]}`;h=c[0],u=this.interpolate(u,r);const g=u.match(/'/g),f=u.match(/"/g);(g&&g.length%2===0&&!f||f.length%2!==0)&&(u=u.replace(/'/g,'"'));try{r=JSON.parse(u),l&&(r={...l,...r})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${h}`,y),`${h}${d}${u}`}return delete r.defaultValue,h}for(;a=this.nestingRegexp.exec(e);){let h=[];r={...s},r=r.replace&&typeof r.replace!="string"?r.replace:r,r.applyPostProcessor=!1,delete r.defaultValue;let l=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const d=a[1].split(this.formatSeparator).map(c=>c.trim());a[1]=d.shift(),h=d,l=!0}if(n=t(o.call(this,a[1].trim(),r),r),n&&a[0]===e&&typeof n!="string")return n;typeof n!="string"&&(n=ks(n)),n||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),n=""),l&&(n=h.reduce((d,c)=>this.format(d,c,s.lng,{...s,interpolationkey:a[1].trim()}),n.trim())),e=e.replace(a[0],n),this.regexp.lastIndex=0}return e}}function vo(i){let e=i.toLowerCase().trim();const t={};if(i.indexOf("(")>-1){const s=i.split("(");e=s[0].toLowerCase().trim();const a=s[1].substring(0,s[1].length-1);e==="currency"&&a.indexOf(":")<0?t.currency||(t.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?t.range||(t.range=a.trim()):a.split(";").forEach(r=>{if(!r)return;const[o,...h]=r.split(":"),l=h.join(":").trim().replace(/^'+|'+$/g,"");t[o.trim()]||(t[o.trim()]=l),l==="false"&&(t[o.trim()]=!1),l==="true"&&(t[o.trim()]=!0),isNaN(l)||(t[o.trim()]=parseInt(l,10))})}return{formatName:e,formatOptions:t}}function et(i){const e={};return function(s,a,n){const r=a+JSON.stringify(n);let o=e[r];return o||(o=i(mi(a),n),e[r]=o),o(s)}}class Io{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=_e.create("formatter"),this.options=e,this.formats={number:et((t,s)=>{const a=new Intl.NumberFormat(t,{...s});return n=>a.format(n)}),currency:et((t,s)=>{const a=new Intl.NumberFormat(t,{...s,style:"currency"});return n=>a.format(n)}),datetime:et((t,s)=>{const a=new Intl.DateTimeFormat(t,{...s});return n=>a.format(n)}),relativetime:et((t,s)=>{const a=new Intl.RelativeTimeFormat(t,{...s});return n=>a.format(n,s.range||"day")}),list:et((t,s)=>{const a=new Intl.ListFormat(t,{...s});return n=>a.format(n)})},this.init(e)}init(e){const s=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=s.formatSeparator?s.formatSeparator:s.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=et(t)}format(e,t,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return t.split(this.formatSeparator).reduce((o,h)=>{const{formatName:l,formatOptions:d}=vo(h);if(this.formats[l]){let c=o;try{const u=a&&a.formatParams&&a.formatParams[a.interpolationkey]||{},g=u.locale||u.lng||a.locale||a.lng||s;c=this.formats[l](o,g,{...d,...a,...u})}catch(u){this.logger.warn(u)}return c}else this.logger.warn(`there was no format function for ${l}`);return o},e)}}function Co(i,e){i.pending[e]!==void 0&&(delete i.pending[e],i.pendingCount--)}class Ao extends bi{constructor(e,t,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=s,this.languageUtils=s.languageUtils,this.options=a,this.logger=_e.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(s,a.backend,a)}queueLoad(e,t,s,a){const n={},r={},o={},h={};return e.forEach(l=>{let d=!0;t.forEach(c=>{const u=`${l}|${c}`;!s.reload&&this.store.hasResourceBundle(l,c)?this.state[u]=2:this.state[u]<0||(this.state[u]===1?r[u]===void 0&&(r[u]=!0):(this.state[u]=1,d=!1,r[u]===void 0&&(r[u]=!0),n[u]===void 0&&(n[u]=!0),h[c]===void 0&&(h[c]=!0)))}),d||(o[l]=!0)}),(Object.keys(n).length||Object.keys(r).length)&&this.queue.push({pending:r,pendingCount:Object.keys(r).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(n),pending:Object.keys(r),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(h)}}loaded(e,t,s){const a=e.split("|"),n=a[0],r=a[1];t&&this.emit("failedLoading",n,r,t),s&&this.store.addResourceBundle(n,r,s),this.state[e]=t?-1:2;const o={};this.queue.forEach(h=>{co(h.loaded,[n],r),Co(h,e),t&&h.errors.push(t),h.pendingCount===0&&!h.done&&(Object.keys(h.loaded).forEach(l=>{o[l]||(o[l]={});const d=h.loaded[l];d.length&&d.forEach(c=>{o[l][c]===void 0&&(o[l][c]=!0)})}),h.done=!0,h.errors.length?h.callback(h.errors):h.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(h=>!h.done)}read(e,t,s){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,r=arguments.length>5?arguments[5]:void 0;if(!e.length)return r(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:s,tried:a,wait:n,callback:r});return}this.readingCalls++;const o=(l,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const c=this.waitingReads.shift();this.read(c.lng,c.ns,c.fcName,c.tried,c.wait,c.callback)}if(l&&d&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,s,a+1,n*2,r)},n);return}r(l,d)},h=this.backend[s].bind(this.backend);if(h.length===2){try{const l=h(e,t);l&&typeof l.then=="function"?l.then(d=>o(null,d)).catch(o):o(null,l)}catch(l){o(l)}return}return h(e,t,o)}prepareLoading(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();typeof e=="string"&&(e=this.languageUtils.toResolveHierarchy(e)),typeof t=="string"&&(t=[t]);const n=this.queueLoad(e,t,s,a);if(!n.toLoad.length)return n.pending.length||a(),null;n.toLoad.forEach(r=>{this.loadOne(r)})}load(e,t,s){this.prepareLoading(e,t,{},s)}reload(e,t,s){this.prepareLoading(e,t,{reload:!0},s)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const s=e.split("|"),a=s[0],n=s[1];this.read(a,n,"read",void 0,void 0,(r,o)=>{r&&this.logger.warn(`${t}loading namespace ${n} for language ${a} failed`,r),!r&&o&&this.logger.log(`${t}loaded namespace ${n} for language ${a}`,o),this.loaded(e,r,o)})}saveMissing(e,t,s,a,n){let r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${s}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(s==null||s==="")){if(this.backend&&this.backend.create){const h={...r,isUpdate:n},l=this.backend.create.bind(this.backend);if(l.length<6)try{let d;l.length===5?d=l(e,t,s,a,h):d=l(e,t,s,a),d&&typeof d.then=="function"?d.then(c=>o(null,c)).catch(o):o(null,d)}catch(d){o(d)}else l(e,t,s,a,o,h)}!e||!e[0]||this.store.addResource(e[0],t,s,a)}}}function As(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){let t={};if(typeof e[1]=="object"&&(t=e[1]),typeof e[1]=="string"&&(t.defaultValue=e[1]),typeof e[2]=="string"&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const s=e[3]||e[2];Object.keys(s).forEach(a=>{t[a]=s[a]})}return t},interpolation:{escapeValue:!0,format:(i,e,t,s)=>i,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Ns(i){return typeof i.ns=="string"&&(i.ns=[i.ns]),typeof i.fallbackLng=="string"&&(i.fallbackLng=[i.fallbackLng]),typeof i.fallbackNS=="string"&&(i.fallbackNS=[i.fallbackNS]),i.supportedLngs&&i.supportedLngs.indexOf("cimode")<0&&(i.supportedLngs=i.supportedLngs.concat(["cimode"])),i}function Vt(){}function No(i){Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(t=>{typeof i[t]=="function"&&(i[t]=i[t].bind(i))})}class Ot extends bi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Ns(e),this.services={},this.logger=_e,this.modules={external:[]},No(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;typeof t=="function"&&(s=t,t={}),!t.defaultNS&&t.defaultNS!==!1&&t.ns&&(typeof t.ns=="string"?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const a=As();this.options={...a,...this.options,...Ns(t)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...a.interpolation,...this.options.interpolation}),t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);function n(d){return d?typeof d=="function"?new d:d:null}if(!this.options.isClone){this.modules.logger?_e.init(n(this.modules.logger),this.options):_e.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:typeof Intl<"u"&&(d=Io);const c=new vs(this.options);this.store=new Ts(this.options.resources,this.options);const u=this.services;u.logger=_e,u.resourceStore=this.store,u.languageUtils=c,u.pluralResolver=new To(c,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(u.formatter=n(d),u.formatter.init(u,this.options),this.options.interpolation.format=u.formatter.format.bind(u.formatter)),u.interpolator=new So(this.options),u.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},u.backendConnector=new Ao(n(this.modules.backend),u.resourceStore,u,this.options),u.backendConnector.on("*",function(g){for(var f=arguments.length,y=new Array(f>1?f-1:0),k=1;k<f;k++)y[k-1]=arguments[k];e.emit(g,...y)}),this.modules.languageDetector&&(u.languageDetector=n(this.modules.languageDetector),u.languageDetector.init&&u.languageDetector.init(u,this.options.detection,this.options)),this.modules.i18nFormat&&(u.i18nFormat=n(this.modules.i18nFormat),u.i18nFormat.init&&u.i18nFormat.init(this)),this.translator=new fi(this.services,this.options),this.translator.on("*",function(g){for(var f=arguments.length,y=new Array(f>1?f-1:0),k=1;k<f;k++)y[k-1]=arguments[k];e.emit(g,...y)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,s||(s=Vt),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=function(){return e.store[d](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=function(){return e.store[d](...arguments),e}});const h=mt(),l=()=>{const d=(c,u)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),h.resolve(u),s(c,u)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),h}loadResources(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vt;const a=typeof e=="string"?e:this.language;if(typeof e=="function"&&(s=e),!this.options.resources||this.options.partialBundledLanguages){if(a&&a.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return s();const n=[],r=o=>{if(!o||o==="cimode")return;this.services.languageUtils.toResolveHierarchy(o).forEach(l=>{l!=="cimode"&&n.indexOf(l)<0&&n.push(l)})};a?r(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(h=>r(h)),this.options.preload&&this.options.preload.forEach(o=>r(o)),this.services.backendConnector.load(n,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),s(o)})}else s(null)}reloadResources(e,t,s){const a=mt();return e||(e=this.languages),t||(t=this.options.ns),s||(s=Vt),this.services.backendConnector.reload(e,t,n=>{a.resolve(),s(n)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Pa.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const s=this.languages[t];if(!(["cimode","dev"].indexOf(s)>-1)&&this.store.hasLanguageSomeTranslations(s)){this.resolvedLanguage=s;break}}}changeLanguage(e,t){var s=this;this.isLanguageChangingTo=e;const a=mt();this.emit("languageChanging",e);const n=h=>{this.language=h,this.languages=this.services.languageUtils.toResolveHierarchy(h),this.resolvedLanguage=void 0,this.setResolvedLanguage(h)},r=(h,l)=>{l?(n(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,a.resolve(function(){return s.t(...arguments)}),t&&t(h,function(){return s.t(...arguments)})},o=h=>{!e&&!h&&this.services.languageDetector&&(h=[]);const l=typeof h=="string"?h:this.services.languageUtils.getBestMatchFromCodes(h);l&&(this.language||n(l),this.translator.language||this.translator.changeLanguage(l),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(l)),this.loadResources(l,d=>{r(d,l)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),a}getFixedT(e,t,s){var a=this;const n=function(r,o){let h;if(typeof o!="object"){for(var l=arguments.length,d=new Array(l>2?l-2:0),c=2;c<l;c++)d[c-2]=arguments[c];h=a.options.overloadTranslationOptionHandler([r,o].concat(d))}else h={...o};h.lng=h.lng||n.lng,h.lngs=h.lngs||n.lngs,h.ns=h.ns||n.ns,h.keyPrefix=h.keyPrefix||s||n.keyPrefix;const u=a.options.keySeparator||".";let g;return h.keyPrefix&&Array.isArray(r)?g=r.map(f=>`${h.keyPrefix}${u}${f}`):g=h.keyPrefix?`${h.keyPrefix}${u}${r}`:r,a.t(g,h)};return typeof e=="string"?n.lng=e:n.lngs=e,n.ns=t,n.keyPrefix=s,n}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=t.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,n=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const r=(o,h)=>{const l=this.services.backendConnector.state[`${o}|${h}`];return l===-1||l===2};if(t.precheck){const o=t.precheck(this,r);if(o!==void 0)return o}return!!(this.hasResourceBundle(s,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||r(s,e)&&(!a||r(n,e)))}loadNamespaces(e,t){const s=mt();return this.options.ns?(typeof e=="string"&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{s.resolve(),t&&t(a)}),s):(t&&t(),Promise.resolve())}loadLanguages(e,t){const s=mt();typeof e=="string"&&(e=[e]);const a=this.options.preload||[],n=e.filter(r=>a.indexOf(r)<0);return n.length?(this.options.preload=a.concat(n),this.loadResources(r=>{s.resolve(),t&&t(r)}),s):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],s=this.services&&this.services.languageUtils||new vs(As());return t.indexOf(s.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new Ot(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vt;const s=e.forkResourceStore;s&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},n=new Ot(a);return(e.debug!==void 0||e.prefix!==void 0)&&(n.logger=n.logger.clone(e)),["store","services","language"].forEach(o=>{n[o]=this[o]}),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},s&&(n.store=new Ts(this.store.data,a),n.services.resourceStore=n.store),n.translator=new fi(n.services,a),n.translator.on("*",function(o){for(var h=arguments.length,l=new Array(h>1?h-1:0),d=1;d<h;d++)l[d-1]=arguments[d];n.emit(o,...l)}),n.init(a,t),n.translator.options=a,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const H=Ot.createInstance();H.createInstance=Ot.createInstance;H.createInstance;H.dir;H.init;H.loadResources;H.reloadResources;H.use;H.changeLanguage;H.getFixedT;H.t;H.exists;H.setDefaultNamespace;H.hasLoadedNamespace;H.loadNamespaces;H.loadLanguages;await H.init({ns:lo,resources:Ya,lng:Ki,fallbackLng:Ki});let Lo=i=>H.changeLanguage(i),Ls=H.t.bind(H);H.getFixedT.bind(H);const m={tileSize:-1,sideLength:-1,halfTile:-1,tileAndAQuarter:-1,createId(i,e=0,t=0){return`${i}${e}${t}`},randomInt(i,e){return i+~~(Math.random()*(e-i+1))},distance(i,e,t,s){return Math.sqrt(Math.pow(i-t,2)+Math.pow(e-s,2))},createSlot(i,e,t,s){let a=document.createElement("li"),n=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div");return n.dataset.type=`${i}`,n.dataset.index=`${e}`,n.classList.add("item-slot"),r.classList.add("item-image"),o.classList.add("item-count"),i===G.Bank&&o.classList.add("bank-item-count"),n.append(r),t&&n.addEventListener("click",()=>t(i,e)),s&&xa(n,()=>s(i,e)),a.append(n,o),a},getImageURL(i=""){if(!i)return"";let e=i.split("/");return e.length>1&&(i=e.at(-1)),`url("/img/sprites/items/${i}.png")`},getEquipmentPlaceholderURL(i){return`url("img/interface/equipment/${_[i].toLowerCase()}.png")`},formatName(i="",e=0){return i=i.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()),e>1&&i.length>e&&(i=`${i.slice(0,Math.max(0,e))}...`),i},formatNotification(i){if(!i.includes(":"))return i;if(!i.includes(";"))return Ls(i);let e=i.split(";"),t={};for(let s=1;s<e.length;s++){let[a,n]=e[s].split("=");t[a]=n}return Ls(e[0],t)},parseMessage(i){try{let e=i.split("@");if(e.length%2===0)return e.join(" ");for(let s in e)parseInt(s)%2!==0&&(e[s]=`<span style="color:${e[s]};">`);let t=e.length/2-1;for(let s=0;s<t;s++)e.push("</span>");return e.join("")}catch{return""}},getCount(i){let e=i.toString();return i>999999?`${Math.floor(i/1e6)}M`:i>9999?`${Math.floor(i/1e3)}K`:i>1?e:""},getContainerAction(i){switch(i){case P.Interact:case P.Equip:case P.Eat:case P.Potion:return Ne.Select;case P.DropOne:return Ne.Remove}},isEmail(i){return/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\dA-Za-z-]+\.)+[A-Za-z]{2,}))$/.test(i)},getRegion(i,e){let t=Math.floor(i/he.MAP_DIVISION_SIZE),s=Math.floor(e/he.MAP_DIVISION_SIZE);return t+s*this.sideLength},getEmptyStats(){return{crush:0,slash:0,stab:0,archery:0,magic:0}},getEmptyBonuses(){return{accuracy:0,strength:0,archery:0,magic:0}},getHurtSprite(i){let e=document.createElement("canvas"),t=e.getContext("2d",{willReadFrequently:!0}),s=new $i(i.data);e.width=i.image.width,e.height=i.image.height,t.drawImage(i.image,0,0,i.image.width,i.image.height);let a=t.getImageData(0,0,i.image.width,i.image.height);for(let n=0;n<a.data.length;n+=4)a.data[n+4]!==0&&(a.data[n]=255,a.data[n+1]=a.data[n+2]=75);return t.putImageData(a,0,0),s.image=e,s.loaded=!0,s},getSilhouetteSprite(i){let e=document.createElement("canvas"),t=e.getContext("2d",{willReadFrequently:!0}),s=new $i(i.data);e.width=i.image.width,e.height=i.image.height,t.drawImage(i.image,0,0,i.image.width,i.image.height);let a=t.getImageData(0,0,i.image.width,i.image.height),n=t.getImageData(0,0,i.image.width,i.image.height);for(let r=0;r<n.data.length;r+=4){if(n.data[r+3]>24||n.data[r+3]===1)continue;let o=r/4%i.image.width,h=~~(r/4/i.image.width);if(o===0||o===i.image.width-1||h===0||h===i.image.height-1)continue;[n.data[r-1],n.data[r+7],n.data[r-n.width*4+3],n.data[r+n.width*4+3]].some(d=>d>24)&&(a.data[r]=a.data[r+1]=255,a.data[r+2]=a.data[r+3]=150)}return t.putImageData(a,0,0),s.image=e,s.loaded=!0,s},getDefaultOffset(i){switch(i){case"items":return{x:0,y:0};case"npcs":return{x:-8,y:-14};default:return{x:-this.tileSize,y:-this.tileSize}}},getDefaultEquipmentDimension(i){switch(i){case"effects":case"skin":case"cape":case"legplates":case"chestplate":case"helmet":return 32;case"shield":case"weapon":return 48;default:return this.tileSize}},getDefaultAnimations(i){switch(i){case"items":case"cursors":return{idle:{length:1,row:0}};case"npcs":return{idle_down:{length:2,row:0}};case"trees":case"rocks":case"fishspots":case"bushes":return{idle:{length:1,row:0},shake:{length:1,row:1},exhausted:{length:1,row:2}};case"mobs":return{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}};default:return{idle_down:{length:4,row:0},idle_right:{length:4,row:1},idle_up:{length:4,row:2},walk_down:{length:4,row:3},walk_right:{length:4,row:4},walk_up:{length:4,row:5},atk_down:{length:4,row:6},atk_right:{length:4,row:7},atk_up:{length:4,row:8},bow_atk_down:{length:4,row:9},bow_atk_right:{length:4,row:10},bow_atk_up:{length:4,row:11}}}},fadeIn(i,e=.1){i.style.opacity||="0",i.style.display="flex";let t=()=>{let s=parseFloat(i.style.opacity)+e;s<=1&&(i.style.opacity=s.toString(),requestAnimationFrame(t))};requestAnimationFrame(t)},fadeOut(i,e=.2){i.style.opacity||="1";let t=()=>{let s=parseFloat(i.style.opacity)-e;s>=0?(i.style.opacity=s.toString(),requestAnimationFrame(t)):i.style.display="none"};requestAnimationFrame(t)}};class Oo{config={name:"BagsDungeon",host:"localhost",ssl:!1,serverId:1,sentryDsn:"",acceptLicense:!0,version:"0.5.5-beta",minor:"",port:9001,hub:!1};storage=new Bn;body=document.querySelector("body");parchment=document.querySelector("#parchment");canvas=document.querySelector("#canvas");loginForm=document.querySelector("#load-character form");registerForm=document.querySelector("#create-character form");worldsList=document.querySelector("#worlds");passwordConfirmation=document.querySelector("#register-password-confirmation-input");emailField=document.querySelector("#register-email-input");loginButton=document.querySelector("#login");registerButton=document.querySelector("#new-account");cancelRegister=document.querySelector("#cancel-register");cancelWorlds=document.querySelector("#cancel-worlds");cancelForget=document.querySelector("#cancel-forget");continueWorlds=document.querySelector("#continue-worlds");continueForget=document.querySelector("#continue-forget");respawn=document.querySelector("#respawn");emailResetInput=document.querySelector("#email-reset-input");rememberMe=document.querySelector("#remember-me input");guest=document.querySelector("#guest input");about=document.querySelector("#toggle-about");credits=document.querySelector("#toggle-credits");resetPassword=document.querySelector("#toggle-reset-password");validation=document.querySelectorAll(".validation-summary");loading=document.querySelector(".loader");langSelect=document.querySelector("#lang-select");worldSelectButton=document.querySelector("#world-select-button");gameVersion=document.querySelector("#game-version");currentScroll="load-character";loggingIn=!1;menuHidden=!1;statusMessage="";selectedServer;keyDownCallback;keyUpCallback;loginCallback;leftClickCallback;rightClickCallback;mouseMoveCallback;resizeCallback;respawnCallback;focusCallback;constructor(){this.sendStatus("Initializing the game client"),this.load()}autoLogin(){this.guest.checked=!0;let e=document.querySelector("#intro");e&&(e.style.display="none");let t=setInterval(()=>{this.loginCallback&&(clearInterval(t),this.login())},50)}load(){if(!this.config.acceptLicense){this.sendError("You must read and accept both MPL2.0 and OPL licensing agreements. Once you have done so, toggle ACCEPT_LICENSE in your environment variables.");return}this.loginForm.addEventListener("submit",this.login.bind(this)),this.registerForm.addEventListener("submit",this.login.bind(this)),this.registerButton.addEventListener("click",()=>this.openScroll("create-character")),this.cancelRegister.addEventListener("click",()=>this.openScroll("load-character")),this.cancelForget.addEventListener("click",()=>this.openScroll("load-character")),this.cancelWorlds.addEventListener("click",()=>this.openScroll("load-character")),this.continueWorlds.addEventListener("click",()=>this.openScroll("load-character")),this.continueForget.addEventListener("click",()=>this.forgotPassword()),this.about.addEventListener("click",()=>this.openScroll("about")),this.credits.addEventListener("click",()=>this.openScroll("credits")),this.resetPassword.addEventListener("click",()=>this.openScroll("reset-password")),this.respawn.addEventListener("click",()=>this.respawnCallback?.()),this.parchment.addEventListener("click",()=>{this.hasFooterOpen()&&this.openScroll("load-character"),this.body.classList.contains("news")&&this.body.classList.remove("news")}),this.worldSelectButton.addEventListener("click",()=>this.openScroll("world-select")),this.gameVersion.textContent=`${this.config.version}${this.config.minor}`,document.addEventListener("keydown",e=>e.key!=="Enter"),document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",e=>this.keyUpCallback?.(e)),document.addEventListener("mousemove",e=>this.mouseMoveCallback?.(e)),this.canvas.addEventListener("click",e=>this.leftClickCallback?.(e)),window.addEventListener("resize",()=>this.resizeCallback?.()),window.addEventListener("focus",()=>this.focusCallback?.()),xa(document.querySelector("#canvas"),e=>this.rightClickCallback?.(e));for(let e of document.querySelectorAll("input[type='number']"))e.addEventListener("input",()=>this.validateNumberInput(e))}loadLogin(){let e=this.storage.getError();e&&this.sendError(e),this.storage.hasRemember()&&(this.getUsernameField().value=this.storage.getUsername(),this.getPasswordField().value=this.storage.getPassword(),this.rememberMe.checked=!0)}handleKeyDown(e){if(this.isMenuHidden())return this.keyDownCallback?.(e);this.currentScroll!=="reset-password"&&e.key==="Enter"&&this.login()}ready(){this.config.acceptLicense&&(this.sendStatus(),this.loginButton.disabled=!1,this.loadLogin(),this.loadWorlds(),"indexedDB"in window||this.setValidation("validation-warning","Your browser does not support IndexedDB. Regions will not be cached."))}login(){this.loggingIn||this.statusMessage||!this.verifyForm()||(this.clearErrors(),this.toggleLogin(!0),this.loginCallback?.(this.selectedServer),xn())}saveLogin(){this.isGuest()||(this.storage.setRemember(this.isRememberMe()),this.storage.setCredentials(),this.isRememberMe()&&this.storage.setCredentials(this.getUsername(),this.getPassword()))}showMenu(){this.body.className="intro",this.menuHidden=!1,this.langSelect.hidden=!1,this.worldSelectButton.hidden=!1,this.gameVersion.hidden=!1}fadeMenu(){this.menuHidden||(this.body.className="game",this.menuHidden=!0,this.langSelect.hidden=!0,this.worldSelectButton.hidden=!0,this.gameVersion.hidden=!0,this.updateLoader(),this.saveLogin())}openScroll(e){this.loggingIn||(this.clearErrors(),this.changeScroll(e,!le()))}changeScroll(e,t=!1){t?(this.parchment.classList.toggle("animate"),this.parchment.classList.remove(this.currentScroll),this.parchment.classList.toggle("animate"),this.parchment.classList.add(e),document.querySelector(`#${e} input`)?.focus()):(this.parchment.classList.remove(this.currentScroll),this.parchment.classList.add(e)),this.currentScroll=e}verifyForm(){if(this.isGuest())return!0;if(!this.getUsername())return this.sendError("Please enter a username.",this.getUsernameField());if(!this.getPassword())return this.sendError("Please enter a password.",this.getPasswordField());if(this.isRegistering()){if(this.getPassword().length<3)return this.sendError("Password must be at least 3 characters long.",this.getPasswordField());if(this.getPassword().length>64)return this.sendError("Password must be less than 64 characters long.",this.getPasswordField());if(this.getPassword()!==this.getPasswordConfirmation())return this.sendError("Passwords do not match.",this.passwordConfirmation);if(!m.isEmail(this.getEmail()))return this.sendError("The email you've entered is not valid.",this.emailField)}return!0}sendStatus(e=""){if(this.clearErrors(),this.statusMessage=e,!e)return;this.setValidation("status",e);let t=document.querySelector(".status");t&&(t.innerHTML=e+this.getLoaderDots())}updateLoader(e=""){this.loading.innerHTML=e?e+this.getLoaderDots():""}sendError(e,t){if(this.isMenuHidden())return this.storage.setError(e);if(this.clearErrors(),this.setValidation("validation-error",e),!t)return!1;t.classList.add("field-error"),t.focus();let s=()=>{t.removeEventListener("keypress",s,!1),t.classList.remove("field-error"),document.querySelector(".validation-error")?.remove()};return t.addEventListener("keypress",s),!1}clearErrors(){document.querySelector(".status")?.remove(),this.clearValidation(),this.getUsernameField().classList.remove("field-error"),this.getPasswordField().classList.remove("field-error"),this.passwordConfirmation.classList.remove("field-error"),this.emailField.classList.remove("field-error")}toggleLogin(e){this.updateLoader("Connecting"),this.toggleTyping(e),this.loggingIn=e,this.loginButton.disabled=e,this.registerButton.disabled=e,document.querySelector(`#${this.currentScroll} .validation-summary`)?.append(this.loading),this.loading.hidden=!e}toggleTyping(e){this.getUsernameField().readOnly=e,this.getPasswordField().readOnly=e,this.passwordConfirmation.readOnly=e,this.emailField.readOnly=e}hasFooterOpen(){return this.parchment.classList.contains("about")||this.parchment.classList.contains("credits")}isGuest(){return this.guest.checked}isRememberMe(){return this.rememberMe.checked}isRegistering(){return this.currentScroll==="create-character"}isMenuHidden(){return this.menuHidden}getUsernameField(){return document.querySelector(this.isRegistering()?"#register-name-input":"#login-name-input")}getUsername(){return this.getUsernameField().value}getPasswordField(){return document.querySelector(this.isRegistering()?"#register-password-input":"#login-password-input")}getPassword(){return this.getPasswordField().value}getPasswordConfirmation(){return this.passwordConfirmation.value}getEmail(){return this.isRegistering()?this.emailField.value:""}getLoaderDots(){return'<span class="loader-dot">.</span><span class="loader-dot">.</span><span class="loader-dot">.</span>'}clearValidation(){for(let e of this.validation)e.innerHTML=""}setValidation(e,t=""){this.clearValidation();for(let s of this.validation)s.append(this.createValidation(e,t))}createValidation(e,t=""){let s=document.createElement("span");return s.classList.add(e),s.classList.add("blink"),s.textContent=t,s}selectServer(e){this.selectedServer=e;let t=this.worldSelectButton.querySelector("strong");t.textContent=`${e.name} ${e.id}`;let s=this.worldSelectButton.querySelector("span");s.textContent=`(${e.players}/${e.maxPlayers} players)`}async forgotPassword(){if(!this.config.hub)return this.setValidation("validation-error","No hub is configured.");let e=this.emailResetInput.value;if(!e||!m.isEmail(e))return this.setValidation("validation-error","Please enter a valid email address.");if(!await fetch(`${this.config.hub}/api/v1/requestReset`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e})}).catch(()=>null))return this.setValidation("validation-error","Please contact an administrator for support.");this.setValidation("status","Password reset request sent, please check your email.")}async loadWorlds(){if(!this.config.hub)return;let e=await fetch(`${this.config.hub}/all`).catch(()=>null);if(!e)return this.setValidation("validation-error","Unable to load world list.");let t=await e.json(),[s]=t;if(!s)return this.setValidation("validation-error","No servers are currently available.");if(this.selectServer(s),!(t.length<2)){this.worldSelectButton.hidden=!1;for(let a in t){let n=t[a],r=document.createElement("li"),o=document.createElement("strong"),h=document.createElement("span");parseInt(a)===0&&r.classList.add("active"),o.textContent=`${n.name} ${n.id}`,h.textContent=`${n.players}/${n.maxPlayers} players`,r.append(o),r.append(h),r.addEventListener("click",()=>{this.selectServer(n),this.worldsList.querySelector("li.active")?.classList.remove("active"),r.classList.add("active")}),this.worldsList.append(r)}}}validateNumberInput(e){e.value=e.value.replaceAll(/\D/g,"")}onKeyDown(e){this.keyDownCallback=e}onKeyUp(e){this.keyUpCallback=e}onLogin(e){this.loginCallback=e}onLeftClick(e){this.leftClickCallback=e}onRightClick(e){this.rightClickCallback=e}onMouseMove(e){this.mouseMoveCallback=e}onResize(e){this.resizeCallback=e}onRespawn(e){this.respawnCallback=e}onFocus(e){this.focusCallback=e}}class Ro{constructor(e){this.game=e}musicCrossfadeDuration=3;musicMinGain=.01;musicMaxGain=.5;buffers={};context;musicGainNode;isMusicConnected=!1;createContext(){this.context=new AudioContext}async playSound(e,t){if(!this.isAudioEnabled())return;let s=await this.bufferSource(`/audio/sounds/${e}.mp3`),a=this.getSoundVolume(),n=s.connect(new GainNode(this.context,{gain:a}));if(t&&!this.getSettings().lowPowerMode){let{tileSize:o}=this.game.map;n=n.connect(new PannerNode(this.context,{positionX:t.x,positionY:t.y,distanceModel:"linear",refDistance:o,maxDistance:o*10}))}n.connect(this.context.destination);let{gain:r}=this.musicGainNode;r.cancelScheduledValues(this.context.currentTime),this.rampGain(r,r.value-a*this.musicMaxGain/2),s.addEventListener("ended",()=>{this.rampGain(r,this.getMusicVolume(),.5)}),s.start()}async playMusic(e){if(!e)return this.stopMusic();let t=await this.bufferSource(`/audio/music/${e}.mp3`);t.loop=!0,this.stopMusic(),t.connect(this.musicGainNode),this.isAudioEnabled()&&this.musicGainNode.connect(this.context.destination),this.rampGain(this.musicGainNode.gain,this.getMusicVolume(),this.musicCrossfadeDuration),t.start()}async bufferSource(e){return this.updateVolume(),this.buffers[e]??=this.loadAudio(e),new AudioBufferSourceNode(this.context,{buffer:await this.buffers[e]})}async loadAudio(e){let t=await fetch(e),s=await t.arrayBuffer();return await this.context.decodeAudioData(s)}updateVolume(){this.musicGainNode||this.initMusicNode();let e=this.getMusicVolume();if(e<=0||!this.isAudioEnabled())this.isMusicConnected&&(this.musicGainNode.disconnect(this.context.destination),this.isMusicConnected=!1);else{let{gain:t}=this.musicGainNode;t.cancelScheduledValues(this.context.currentTime),this.isMusicConnected?this.rampGain(t,e):(this.musicGainNode.connect(this.context.destination),this.isMusicConnected=!0,this.rampGain(t,this.musicMinGain),this.rampGain(t,e,this.musicCrossfadeDuration))}}updatePlayerListener(){if(!this.context||!this.isAudioEnabled()||this.getSettings().lowPowerMode)return;let{player:e}=this.game,{positionX:t,positionY:s,forwardX:a,forwardY:n}=this.context.listener;if(!t||!s||!a||!n){this.context.listener.setPosition(e.x,e.y,0);return}switch(t.value=e.x,s.value=e.y,e.orientation){case A.Up:{a.value=0,n.value=1;break}case A.Down:{a.value=0,n.value=-1;break}case A.Left:{a.value=-1,n.value=0;break}case A.Right:{a.value=1,n.value=0;break}}}stopMusic(){let e=this.musicGainNode;if(this.initMusicNode(),!e)return;let{gain:t}=e;t.cancelScheduledValues(this.context.currentTime),this.rampGain(t,this.musicMinGain,this.musicCrossfadeDuration),setTimeout(()=>e.disconnect(),this.musicCrossfadeDuration*1e3)}initMusicNode(){this.musicGainNode=new GainNode(this.context,{gain:this.musicMinGain})}rampGain(e,t,s=0){t>0&&e.linearRampToValueAtTime(t,this.context.currentTime+s)}getSoundVolume(){return this.getSettings().soundVolume/100}getMusicVolume(){return this.getSettings().musicVolume/100*this.musicMaxGain*2}isAudioEnabled(){return this.getSettings().audioEnabled}getSettings(){return this.game.storage.data.settings}playHitSound(e){this.playSound(`hit${m.randomInt(1,2)}`,e)}playKillSound(e){this.playSound(`kill${m.randomInt(1,2)}`,e)}playMiningSound(e){this.playSound(`mining${m.randomInt(1,3)}`,e)}playChoppingSound(e){this.playSound(`wood${m.randomInt(1,4)}`,e)}}class xo{constructor(e,t){this.time=e,this.duration=t}isOver(e){return e-this.time>this.duration}}class Do{constructor(e,t,s=5e3,a){this.instance=e,this.position=a,this.timer=new xo(Date.now(),s),this.element=this.createBlob(e,t),this.static=!!this.position}x=-1;y=-1;element;duration=5e3;timer;static=!1;setPosition(e,t){this.x=e,this.y=t}update(e,t){this.timer.time=t;let s=this.element.querySelector("p");s&&(s.innerHTML=e)}isOver(e){return this.timer.isOver(e)}destroy(){this.element.remove()}createBlob(e,t){let s=document.createElement("div"),a=document.createElement("p");return s.id=e,s.classList.add("bubble"),a.innerHTML=t,s.append(a),s}}const Yo=8,rt=4,Os=64,Rs=32;class Mo{constructor(e,t,s){this.width=e,this.height=t,this.tileSize=s,this.update()}border=document.querySelector("#border");x=0;y=0;gridX=0;gridY=0;gridWidth=0;gridHeight=0;borderX=0;borderY=0;borderWidth=0;borderHeight=0;borderOffsetWidth=0;borderOffsetHeight=0;zoomFactor=rt;centered=!0;lockX=!1;lockY=!1;maxZoom=Yo;minZoom=2.6;zoomCallback;update(){this.borderOffsetWidth=this.border.offsetWidth,this.borderOffsetHeight=this.border.offsetHeight,this.borderWidth=this.border.offsetWidth/this.tileSize/this.zoomFactor,this.borderHeight=this.border.offsetHeight/this.tileSize/this.zoomFactor,this.gridWidth=~~this.borderWidth+1,this.gridHeight=~~this.borderHeight+1,this.clamp(),this.borderX=(this.width-this.gridWidth)*this.tileSize,this.borderY=(this.height-this.gridHeight)*this.tileSize}clamp(){this.gridWidth>Os&&(this.gridWidth=Os),this.gridHeight>Rs&&(this.gridHeight=Rs)}setGridPosition(e,t){this.gridX=e,this.gridY=t,this.x=e*this.tileSize,this.y=t*this.tileSize}setZoom(e=rt){this.zoomFactor=e,isNaN(this.zoomFactor)&&(this.zoomFactor=rt),this.zoomFactor>this.maxZoom&&(this.zoomFactor=this.maxZoom),this.zoomFactor<this.minZoom&&(this.zoomFactor=this.minZoom),this.zoomCallback?.()}clip(){this.setGridPosition(Math.round(this.x/this.tileSize),Math.round(this.y/this.tileSize))}center(){this.centered=!0}decenter(){this.centered=!1,this.clip()}centreOn(e){let t=this.borderWidth/2,s=this.borderHeight/2,a=e.x-t*this.tileSize,n=e.y-s*this.tileSize;a>=0&&a<=this.borderX&&!this.lockX?(this.x=a,this.gridX=Math.round(e.x/this.tileSize-~~t)):this.offsetX(a),n>=0&&n<=this.borderY&&!this.lockY?(this.y=n,this.gridY=Math.round(e.y/this.tileSize-~~s)):this.offsetY(n)}offsetX(e){e<=this.tileSize?(this.x=0,this.gridX=0):e>=this.borderX&&(this.x=this.borderX,this.gridX=Math.round(this.borderX/this.tileSize))}offsetY(e){e<=this.tileSize?(this.y=0,this.gridY=0):e>=this.borderY&&(this.y=this.borderY,this.gridY=Math.round(this.borderY/this.tileSize))}zone(e){switch(e){case A.Up:{this.setGridPosition(this.gridX,this.gridY-this.gridHeight+3);break}case A.Down:{this.setGridPosition(this.gridX,this.gridY+this.gridHeight-3);break}case A.Right:{this.setGridPosition(this.gridX+this.gridWidth-3,this.gridY);break}case A.Left:{this.setGridPosition(this.gridX-this.gridWidth+3,this.gridY);break}}this.zoneClip()}zoneClip(){this.gridX<0&&this.setGridPosition(0,this.gridY),this.gridX>this.width&&this.setGridPosition(this.width,this.gridY),this.gridY<0&&this.setGridPosition(this.gridX,0),this.gridY>this.height&&this.setGridPosition(this.gridX,this.height)}zoom(e=0){let t=parseFloat((this.zoomFactor+e).toFixed(1));this.setZoom(t)}updateMinimumZoom(e=!1){this.minZoom=e?2:2.6,this.zoom()}isCentered(){return this.centered}isVisible(e,t,s,a=s){return e>this.gridX-s&&e<this.gridX+this.gridWidth+s&&t>this.gridY-a&&t<this.gridY+this.gridHeight+a}forEachVisiblePosition(e,t=2,s=t){for(let a=this.gridY-t;a<this.gridY+this.gridHeight+s;a++)for(let n=this.gridX-t;n<this.gridX+this.gridWidth+s;n++)n<0||a<0||n>=this.width||a>=this.height||e(n,a)}onZoom(e){this.zoomCallback=e}}class Po{constructor(e,t){this.renderer=e,this.entities=t,this.camera=this.renderer.camera}camera;container=document.querySelector("#bubbles");bubbles={};scale=1;create(e,t,s=5e3,a){let n=this.bubbles[e];if(n)return n.update(t,Date.now());this.bubbles[e]=new Do(e,t,s,a),this.container.append(this.bubbles[e].element)}setTo(e,t,s){let a=this.bubbles[e];a.setPosition(t,s);let{offsetWidth:n,offsetHeight:r,style:o}=a.element,h=(t-this.camera.x)*this.camera.zoomFactor,l=(s-this.camera.y)*this.camera.zoomFactor-this.renderer.actualTileSize,d=n/2-this.renderer.actualTileSize/2-6,c=r*this.scale,u=l/this.renderer.canvasHeight;o.left=`${h-d}px`,o.top=`${l-c}px`,u<.1&&(o.top="0")}update(e){for(let t of Object.values(this.bubbles)){let s=this.entities.get(t.instance);s&&this.setTo(s.instance,s.x,s.y),t.static&&this.setTo(t.instance,t.position.x,t.position.y),t.isOver(e)&&this.destroy(t)}}resize(){this.scale=rt/this.camera.zoomFactor}clear(e){this.bubbles[e]&&this.destroy(this.bubbles[e])}destroy(e){e.destroy(),delete this.bubbles[e.instance]}clean(){for(let e of Object.values(this.bubbles))e.destroy();this.bubbles={}}}class je{constructor(e="",t){this.instance=e,this.type=t}x=0;y=0;gridX=0;gridY=0;nextGridX=-1;nextGridY=-1;distance=-1;movementSpeed=-1;attackRange=-1;frozen=!1;dead=!1;name="";region=-1;healthBarVisible=!1;sprite;spriteFlipX=!1;spriteFlipY=!1;animation;offsetY=0;shadowOffsetY=0;hidden=!1;visible=!0;exclamation=!1;blueExclamation=!1;fading=!1;hurt=!1;silhouette=!1;angle=0;counter=0;fadingDuration=1e3;orientation=A.Down;fadingTime;blinking;ready=!1;hitPoints=0;maxHitPoints=0;mana=0;maxMana=0;level=1;experience=0;teleporting=!1;pvp=!1;nameColour="";customScale;fadingAlpha=0;lastUpdate=Date.now();counterInterval;fadeIn(e){this.fading=!0,this.fadingTime=e}blink(e=150){this.blinking=window.setInterval(()=>this.toggleVisibility(),e)}stopBlinking(){this.blinking&&clearInterval(this.blinking),this.setVisible(!0)}idle(){}animateDeath(e,t=120,s=1){this.setAnimation("death",t,s,e)}updateSilhouette(e=!1){if(this.dead||this.teleporting){this.silhouette=!1;return}e&&this.sprite.hasSilhouette()&&!this.sprite.silhouetteSprite&&this.sprite.loadSilhouetteSprite(),this.silhouette=e}updateDisplayInfo(e){e.colour&&(this.nameColour=e.colour),e.scale&&(this.customScale=e.scale),e.exclamation==="achievement"?this.exclamation=!0:e.exclamation==="blue"&&(this.blueExclamation=!0)}getSprite(){return this.hurt&&this.sprite.hurtSprite?this.sprite.hurtSprite:this.silhouette&&this.sprite.silhouetteSprite?this.sprite.silhouetteSprite:this.sprite}setSprite(e){this.teleporting||!e.loaded&&(e.load(),this.sprite?.key===e.key)||(this.sprite=e,e.onLoad(()=>{this.customScale&&(this.sprite.offsetX*=this.customScale,this.sprite.offsetY*=this.customScale)}))}setAnimation(e,t=this.sprite.idleSpeed,s=1,a,n=!1){if(this.animation?.name===e)return;let{length:r,row:o,width:h,height:l}=this.sprite.animations[e];this.animation=new U(e,r,o,h,l,n),e.startsWith("atk")&&this.animation.reset(),this.animation.setSpeed(t),this.animation.setCount(s,a||(()=>this.idle()))}setPosition(e,t){this.x=e,this.y=t}setGridPosition(e,t){this.gridX=e,this.gridY=t,this.region=m.getRegion(e,t),this.setPosition(e*m.tileSize,t*m.tileSize)}setCountdown(e){this.counter=e,this.counterInterval=setInterval(()=>{if(this.counter<=0){clearInterval(this.counterInterval),this.counterInterval=void 0;return}this.counter--},1e3)}setVisible(e){this.visible=e}getDistance(e){let{gridX:t,gridY:s}=this;return Math.abs(t-e.gridX)+Math.abs(s-e.gridY)}getBoundingBox(){return{x:this.x+this.sprite.offsetX/2,y:this.y+this.sprite.offsetY/2,width:this.sprite.width+this.sprite.offsetX,height:this.sprite.height+this.sprite.offsetY}}toggleVisibility(){this.setVisible(!this.visible)}isVisible(){return this.visible}drawNames(){return!0}hasShadow(){return!1}hasCrown(){return!1}hasCounter(){return this.counter>0}isPlayer(){return this.type===C.Player}isMob(){return this.type===C.Mob}isNPC(){return this.type===C.NPC}isItem(){return this.type===C.Item}isChest(){return this.type===C.Chest}isProjectile(){return this.type===C.Projectile}isPet(){return this.type===C.Pet}isObject(){return this.type===C.Object}isTree(){return this.type===C.Tree}isRock(){return this.type===C.Rock}isFishSpot(){return this.type===C.FishSpot}isForaging(){return this.type===C.Foraging}isNonTreeResource(){return this.isRock()||this.isForaging()}isResource(){return this.isTree()||this.isRock()||this.isFishSpot()||this.isForaging()}isModerator(){return!1}isAdmin(){return!1}}class Fo extends je{constructor(e){super(e,C.NPC)}idle(){this.setAnimation("idle_down",this.sprite.idleSpeed)}hasShadow(){return!0}}class xs extends je{constructor(e,t=1,s={}){super(e,C.Item),this.count=t,this.enchantments=s}dropped=!1;originalY=-1;setAnimation(e,t,s,a){super.setAnimation(e,t,s,a),!(this.animation.length>1)&&(this.originalY=this.sprite.offsetY,this.animation?.onBop(n=>{this.offsetY=this.originalY-n}))}idle(){this.setAnimation("idle",150)}hasShadow(){return!0}}class Uo extends je{constructor(e){super(e,C.Chest)}idle(){this.setAnimation("idle_down",150)}}let Fa=class{constructor(e){this.character=e,this.game=e.game,this.entities=this.game.entities,this.character.onRequestPath(this.handleRequestPath.bind(this)),this.character.onStartPathing(this.handleStartPathing.bind(this)),this.character.onBeforeStep(this.handleBeforeStep.bind(this)),this.character.onStep(this.handleStep.bind(this)),this.character.onSecondStep(this.handleSecondStep.bind(this)),this.character.onStopPathing(this.handleStopPathing.bind(this)),this.character.onMove(this.handleMove.bind(this)),this.character.onFallback(this.handleFallback.bind(this))}game;entities;handleRequestPath(e,t){return this.character.gridX===e&&this.character.gridY===t?[]:this.game.map.isColliding(e,t)?[]:this.game.findPath(this.character,e,t)}handleStartPathing(e){this.character.moving=!0}handleBeforeStep(){this.entities.unregisterPosition(this.character)}handleStep(){this.entities.registerPosition(this.character),this.handleAttackers(),this.handleFollowers(),(this.character.isMob()||this.character.isPet())&&(this.character.hasTarget()||this.character.hasAttackers())&&this.game.socket.send(p.Movement,{opcode:ue.Entity,targetInstance:this.character.instance,requestX:this.character.gridX,requestY:this.character.gridY}),this.character.moving&&this.character.canAttackTarget()&&this.character.stop()}handleSecondStep(){}handleStopPathing(e,t){this.entities.registerPosition(this.character),this.character.moving=!1}handleMove(){}handleFallback(e,t){this.game.teleport(this.character,e,t)}handleAttackers(){this.character.forEachAttacker(e=>{if(e.target?.instance!==this.character.instance)return this.character.removeAttacker(e);e.canAttackTarget()||e.follow(this.character)})}handleFollowers(){this.character.forEachFollower(e=>{if(!e.target||e.target.instance!==this.character.instance)return this.character.removeFollower(e);e.follow(this.character)})}};class Ds{startValue=0;endValue=0;duration=0;inProgress=!1;startTime;updateCallback;stopCallback;start(e,t,s,a,n,r){this.startTime=e,this.startValue=t,this.endValue=s,this.duration=a,this.updateCallback=n,this.stopCallback=r,this.inProgress=!0}step(e){if(!this.inProgress)return;let t=e-this.startTime;t>this.duration&&(t=this.duration);let s=this.endValue-this.startValue,a=Math.round(this.startValue+s/this.duration*t);t===this.duration||a===this.endValue?(this.inProgress=!1,this.stopCallback?.()):this.updateCallback?.(a)}}class Le extends je{constructor(e,t,s){super(e,t),this.game=s,this.loadAnimations(),this.handler=new Fa(this)}moving=!1;following=!1;stunned=!1;forced=!1;trading=!1;interrupted=!1;path=null;target=null;lastTarget="";lastFollow=0;statusEffects=[];attackers={};followers={};movement=new Ds;handler;attackAnimationSpeed=50;walkAnimationSpeed=120;effect=N.None;destination;newDestination;step;healthBarTimeout;effects={[N.Critical]:{key:"effects/critical",animation:new U("effect",10,0,48,48)},[N.Terror]:{key:"effects/terror",animation:new U("effect",8,0,64,64)},[N.TerrorStatus]:{key:"effects/terror2",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.Stun]:{key:"effects/stun",animation:new U("effect",6,0,48,48),perpetual:!0},[N.Healing]:{key:"effects/heal",animation:new U("effect",8,0,64,64)},[N.Fireball]:{key:"effects/fireball",animation:new U("effect",8,0,64,64)},[N.Iceball]:{key:"effects/iceball",animation:new U("effect",8,0,64,64)},[N.Burning]:{key:"effects/burn",animation:new U("effect",5,0,32,32),perpetual:!0,speed:150},[N.Freezing]:{key:"effects/freeze",animation:new U("effect",6,0,32,32),perpetual:!0,speed:200},[N.Poisonball]:{key:"effects/poisonball",animation:new U("effect",10,0,40,40),speed:175},[N.Boulder]:{key:"effects/boulder",animation:new U("effect",7,0,32,32)},[N.AccuracyBuff]:{key:"effects/accuracy",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.StrengthBuff]:{key:"effects/strength",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.DefenseBuff]:{key:"effects/defense",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.MagicBuff]:{key:"effects/magic",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.ArcheryBuff]:{key:"effects/archery",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.AccuracySuperBuff]:{key:"effects/accuracysuper",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.StrengthSuperBuff]:{key:"effects/strengthsuper",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.DefenseSuperBuff]:{key:"effects/defensesuper",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.MagicSuperBuff]:{key:"effects/magicsuper",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200},[N.ArcherySuperBuff]:{key:"effects/archerysuper",animation:new U("effect",5,0,32,32),perpetual:!0,speed:200}};requestPathCallback;startPathingCallback;beforeStepCallback;stepCallback;secondStepCallback;stopPathingCallback;moveCallback;fallbackCallback;hitPointsCallback;loadAnimations(){for(let e in this.effects){let t=this.effects[e],s=parseInt(e);t.animation.setSpeed(t.speed||50),t.animation.setCount(1,()=>{t.perpetual||this.removeEffect(s),s===N.Terror&&this.addEffect(N.TerrorStatus),t.animation.reset(),t.animation.count=1})}}setAnimation(e,t=120,s=0,a){let n=["atk","bow_atk","walk","idle"];this.animation?.name!=="death"&&(this.spriteFlipX=!1,this.spriteFlipY=!1,n.includes(e)&&(e+=`_${this.orientation===A.Left?"right":this.orientationToString()}`,this.spriteFlipX=this.orientation===A.Left),super.setAnimation(e,t,s,a))}toggleHurt(){if(this.dead||this.teleporting){this.hurt=!1;return}this.sprite.hasHurtSprite()&&!this.sprite.hurtSprite&&this.sprite.loadHurtSprite(),this.hurt=!0,window.setTimeout(()=>this.hurt=!1,100)}despawn(){this.hitPoints=0,this.dead=!0,this.removeTarget(),this.stop(),this.orientation=A.Down}trade(e){this.dead||this.teleporting||(this.trading=!0,this.follow(e))}follow(e,t=!1){Date.now()-this.lastFollow<300||this.dead||this.isStunned()||this.teleporting||(this.lastFollow=Date.now(),this.following=!0,this.setTarget(e),this.move(e.gridX,e.gridY,t))}pursue(e){this.dead||this.isStunned()||this.teleporting||(this.setTarget(e),this.move(e.gridX,e.gridY),e.addFollower(this))}followPosition(e,t){this.following=!0,this.move(e,t)}addEffect(e){this.hasEffect(e)||this.statusEffects.push(e)}addAttacker(e){this.attackers[e.instance]=e}addFollower(e){this.followers[e.instance]=e}removeEffect(e){e===N.Terror&&this.removeEffect(N.TerrorStatus),this.statusEffects=this.statusEffects.filter(t=>t!==e)}removeAllEffects(){this.statusEffects=[]}removeAttacker(e){delete this.attackers[e.instance]}removeFollower(e){delete this.followers[e.instance]}hasEffect(e){return this.statusEffects.includes(e)}hasActiveEffect(){return this.statusEffects.length>0}hasAttackers(){return Object.keys(this.attackers).length>0}hasFollowers(){return Object.keys(this.followers).length>0}hasDeathAnimation(){return this.animation?.name==="death"||this.sprite.key==="death"}isStunned(){return this.statusEffects.includes(N.Stun)}performAction(e,t){switch(this.setOrientation(e),t){case ae.Idle:return this.setAnimation("idle",this.sprite.idleSpeed);case ae.Orientate:return this.setAnimation("idle",this.sprite.idleSpeed);case ae.Attack:return this.setAnimation("atk",this.attackAnimationSpeed,1);case ae.Walk:return this.setAnimation("walk",this.walkAnimationSpeed)}}idle(e,t=!1){if((this.hasPath()||this.moving)&&!t)return;let s=e||this.orientation;this.performAction(s,ae.Idle)}orientationToString(){switch(this.orientation){case A.Left:return"left";case A.Right:return"right";case A.Up:return"up";case A.Down:return"down"}}lookAt(e){let{gridX:t,gridY:s}=this;e.gridX>t?this.setOrientation(A.Right):e.gridX<t?this.setOrientation(A.Left):e.gridY>s?this.setOrientation(A.Down):e.gridY<s&&this.setOrientation(A.Up),this.idle()}lookAtPosition(e,t){let{gridX:s,gridY:a}=this;e>s?this.setOrientation(A.Right):e<s?this.setOrientation(A.Left):t>a?this.setOrientation(A.Down):t<a&&this.setOrientation(A.Up),this.idle()}go(e,t,s=!1,a=!1){this.frozen||(this.following&&(this.following=!1,this.removeTarget()),this.move(e,t,s,a))}move(e,t,s=!1,a=!1){if(this.hasPath()&&!s)this.proceed(e,t);else{let n=this.requestPathfinding(e,t);if((!n||n.length<2)&&a)return this.fallbackCallback?.(e,t);this.followPath(n)}this.destination={x:e,y:t}}proceed(e,t){this.newDestination={x:e,y:t}}nextStep(){let e=!1,t,s,a;if(this.step%2===0&&this.secondStepCallback&&this.secondStepCallback(),!!this.hasPath()){if(this.beforeStepCallback?.(),this.updateGridPosition(),this.interrupted&&(e=!0),this.hasNextStep()&&([this.nextGridX,this.nextGridY]=this.path[this.step+1]),!e)if(this.stepCallback?.(),this.changedPath()){if({x:t,y:s}=this.newDestination,a=this.requestPathfinding(t,s),!a)return;this.newDestination=null,a.length<2?e=!0:(this.startPathingCallback?.(a),this.followPath(a))}else this.hasNextStep()?(this.step++,this.updateMovement()):e=!0;e&&this.resetMovement()}}resetMovement(e=!0){this.path=null,this.idle(),this.destination=null,this.newDestination=null,this.movement=new Ds,this.nextGridX=this.gridX,this.nextGridY=this.gridY,this.forced=!1,this.interrupted=!1,e&&this.stopPathingCallback?.(this.gridX,this.gridY,this.forced)}updateMovement(){let{path:e,step:t}=this;e&&(e[t][0]<e[t-1][0]&&this.performAction(A.Left,ae.Walk),e[t][0]>e[t-1][0]&&this.performAction(A.Right,ae.Walk),e[t][1]<e[t-1][1]&&this.performAction(A.Up,ae.Walk),e[t][1]>e[t-1][1]&&this.performAction(A.Down,ae.Walk))}followPath(e){!e||e.length<2||(this.path=e,this.step=0,this.following&&e.pop(),!this.moving&&!this.changedPath()&&this.startPathingCallback?.(e),this.nextStep())}stop(e=!1){if(this.hasPath()){if(e)return this.resetMovement(!1);this.interrupted=!0}}canAttackTarget(){return!(!this.hasTarget()||!this.target.isMob()&&!this.target.isPlayer()||this.getDistance(this.target)>this.attackRange)}getEffect(e){return this.effects[e]}triggerHealthBar(){this.healthBarVisible=!0,this.healthBarTimeout&&clearTimeout(this.healthBarTimeout),this.healthBarTimeout=window.setTimeout(()=>{this.healthBarVisible=!1},7e3)}clearHealthBar(){this.healthBarVisible=!1,clearTimeout(this.healthBarTimeout),this.healthBarTimeout=null}requestPathfinding(e,t){return this.requestPathCallback?.(e,t)||null}updateGridPosition(){!this.path||this.path.length===0||this.setGridPosition(this.path[this.step][0],this.path[this.step][1])}hasShadow(){return!0}hasPath(){return this.path!==null}hasNextStep(){return this.path.length-1>this.step}changedPath(){return!!this.newDestination}removeTarget(){this.target=null}moved(){this.game.isMainPlayer(this.instance)&&this.moveCallback?.()}setTarget(e){this.target=e}hasTarget(e){return e?this.target===e:!!this.target}setObjectTarget(e){let t=new Le(`${e.gridX}-${e.gridY}`,C.Object,this.game);t.setGridPosition(e.gridX,e.gridY),this.setTarget(t),this.followPosition(e.gridX,e.gridY)}setHitPoints(e,t){let s=!1;e<0&&(e=0),e<this.hitPoints&&(s=!0),this.hitPoints=e,t&&(this.maxHitPoints=t),this.hitPointsCallback?.(this.hitPoints,t||this.maxHitPoints,s)}setOrientation(e){this.orientation=e}forEachAttacker(e){for(let t of Object.values(this.attackers))e(t)}forEachFollower(e){for(let t of Object.values(this.followers))e(t)}onRequestPath(e){this.requestPathCallback=e}onStartPathing(e){this.startPathingCallback=e}onStopPathing(e){this.stopPathingCallback=e}onBeforeStep(e){this.beforeStepCallback=e}onStep(e){this.stepCallback=e}onSecondStep(e){this.secondStepCallback=e}onMove(e){this.moveCallback=e}onHitPoints(e){this.hitPointsCallback=e}onFallback(e){this.fallbackCallback=e}}class qo extends Le{hiddenName=!1;constructor(e,t){super(e,C.Mob,t)}hasShadow(){return!this.hiddenName}drawNames(){return!this.hiddenName}}class zo extends Le{constructor(e,t,s){super(e,C.Pet,s),this.owner=t}idle(e,t=!1){this.moving||super.idle(e,t)}}class Ii{constructor(e,t,s,a=1,n=1,r,o,h={},l=[]){this.id=e,this.name=t,this.description=s,this.stage=a,this.stageCount=n,this.subStage=r,this.rewards=o,this.skillRequirements=h,this.questRequirements=l}secret=!1;region="";update(e,t,s,a){this.stage=e,t&&(this.subStage=t),s&&(this.name=s),a&&(this.description=a)}isFinished(){return this.stage>=this.stageCount}isStarted(){return this.stage>0}}class Bo{constructor(e,t=0,s=1){this.type=e,this.experience=t,this.level=s,this.name=ne[e]}name;percentage=0;nextExperience=0;update(e,t,s,a){this.experience=e,this.nextExperience=t,this.level=s||this.level,this.percentage=a||0}}class Xo{constructor(e,t,s,a=-1){this.type=e,this.key=t,this.level=s,this.quickSlot=a}active=!1;update(e,t=this.quickSlot){this.level=e,this.quickSlot=t}toggle(){this.active=!this.active}}class Ys{constructor(e,t,s,a){this.id=e,this.username=t,this.online=s,this.serverId=a}}class Ho{key="";name="";count=-1;enchantments={};bow=!1;drawable=!1;light={};attackStats=m.getEmptyStats();defenseStats=m.getEmptyStats();bonuses=m.getEmptyBonuses();attackStyle=J.None;attackStyles=[];update(e="",t="",s=-1,a={},n,r,o,h=J.None,l=[],d={}){this.key=e,this.name=t,this.count=s,this.enchantments=a,this.attackStats=n||m.getEmptyStats(),this.defenseStats=r||m.getEmptyStats(),this.bonuses=o||m.getEmptyBonuses(),this.attackStyle=h,this.attackStyles=l,this.light=d}exists(){return this.key!==""}}class Ua extends Le{serverId=-1;pvpKills=-1;pvpDeaths=-1;moveLeft=!1;moveRight=!1;moveUp=!1;moveDown=!1;poison=!1;disableAction=!1;joystickMovement=!1;hasPet=!1;rank=Q.None;crown=z.None;guild;equipmentOrder=_s;hitPoints=0;maxHitPoints=0;mana=0;maxMana=0;attackAnimationSpeed=120;walkAnimationSpeed=160;equipments={};skills={};abilities={};quests={};achievements={};friends={};syncCallback;poisonCallback;abilityCallback;manaCallback;constructor(e,t){super(e,C.Player,t),this.createEquipments()}createEquipments(){for(let e in _){let t=parseInt(e);isNaN(t)||(this.equipments[t]=new Ho)}this.equipments[_.Weapon].drawable=!0,this.equipments[_.Shield].drawable=!0,this.equipments[_.Cape].drawable=!0}load(e,t=!1){if(this.instance=e.instance,this.name=e.name,this.level=e.level,this.movementSpeed=e.movementSpeed,this.orientation=e.orientation,this.attackRange=e.attackRange,e.displayInfo&&(this.nameColour=e.displayInfo.colour),this.setRank(e.rank),this.setOrientation(e.orientation),t||this.setGridPosition(e.x,e.y),this.setHitPoints(e.hitPoints,e.maxHitPoints),this.setMana(e.mana,e.maxMana),e.equipments)for(let s of e.equipments)this.equip(s)}loadSkills(e){for(let t of e)this.setSkill(t)}loadQuests(e){for(let[t,s]of e.entries())this.quests[s.key]=new Ii(t,s.name,s.description,s.stage,s.stageCount,s.subStage,s.rewards,s.skillRequirements,s.questRequirements)}loadAchievements(e){for(let t in e){let s=e[t],a=new Ii(parseInt(t),s.name,s.description,s.stage,s.stageCount);s.secret&&(a.secret=!0),s.region&&(a.region=s.region),this.achievements[s.key]=a}}loadAbilities(e){for(let t of e)this.setAbility(t.key,t.level,t.type,t.quickSlot)}loadFriends(e){let t=0;for(let s in e){let a=e[s];this.friends[s]=new Ys(t,s,a.online,a.serverId),t++}}equip(e){let{type:t,name:s,key:a,count:n,enchantments:r,attackRange:o,attackStats:h,defenseStats:l,bonuses:d,attackStyle:c,attackStyles:u,bow:g,light:f}=e;if(!a)return this.unequip(t);let y=t===_.WeaponSkin?"weapon":this.getType(t);this.equipments[t].update(y?`player/${y}/${a}`:`items/${a}`,s,n,r,h,l,d),t===_.Weapon&&(this.attackRange=o||1,this.setAttackStyle(c,u),this.equipments[t].bow=!!g),f&&(this.equipments[t].light=f),this.updateEquipmentAppearance()}addFriend(e,t,s){this.friends[e]=new Ys(Object.keys(this.friends).length,e,t,s)}addGuildMember(e,t){this.hasMember(e)&&this.guild.members.push({username:e,serverId:t})}unequip(e,t=-1){t>0?this.equipments[e].count=t:this.equipments[e].update(),this.updateEquipmentAppearance()}removeGuildMember(e){if(!this.hasMember(e))return;let t=this.guild.members.findIndex(s=>s.username===e);this.guild.members.splice(t,1)}sync(){this.syncCallback?.()}updateEquipmentAppearance(){this.getArmourSkin().drawable=!this.game.pvp,this.getWeaponSkin().drawable=!this.game.pvp;let e=!!this.getWeaponSkin().key&&this.getWeaponSkin().drawable,t=!!this.getArmourSkin().key&&this.getArmourSkin().drawable;this.getWeapon().drawable=!e,this.toggleDrawableEquipments(!t)}idle(e,t=!1){(this.hasKeyboardMovement()||this.hasAttackers()||this.hasTarget())&&this.moving||this.hasPath()||super.idle(e,t)}getSpriteName(){let e=this.getArmourSkin();return e.key&&e.drawable?e.key:"player/base"}getHelmet(){return this.equipments[_.Helmet]}getPendant(){return this.equipments[_.Pendant]}getArrows(){return this.equipments[_.Arrows]}getChestplate(){return this.equipments[_.Chestplate]}getWeapon(){return this.equipments[_.Weapon]}getShield(){return this.equipments[_.Shield]}getRing(){return this.equipments[_.Ring]}getWeaponSkin(){return this.equipments[_.WeaponSkin]}getArmourSkin(){return this.equipments[_.ArmourSkin]}getLegplate(){return this.equipments[_.Legplates]}getCape(){return this.equipments[_.Cape]}getBoots(){return this.equipments[_.Boots]}isAdmin(){return this.rank===Q.Admin||this.rank===Q.HollowAdmin}isModerator(){return this.rank===Q.Moderator}getTotalExperience(){let e=0;for(let t of Object.values(this.skills))e+=t.experience;return e}getCrownKey(){switch(this.crown){case z.Silver:return"silvermedal";case z.Gold:return"goldmedal";case z.Artist:return"crown-artist";case z.Tier1:return"crown-tier1";case z.Tier2:return"crown-tier2";case z.Tier3:return"crown-tier3";case z.Tier4:return"crown-tier4";case z.Tier5:return"crown-tier5";case z.Tier6:return"crown-tier6";case z.Tier7:return"crown-tier7";default:return""}}getRankCrown(){switch(this.rank){case Q.Artist:return z.Artist;case Q.TierOne:return z.Tier1;case Q.TierTwo:return z.Tier2;case Q.TierThree:return z.Tier3;case Q.TierFour:return z.Tier4;case Q.TierFive:return z.Tier5;case Q.TierSix:return z.Tier6;case Q.TierSeven:return z.Tier7;default:return z.None}}getType(e){switch(e){case _.Helmet:return"helmet";case _.Chestplate:return"chestplate";case _.Legplates:return"legplates";case _.Weapon:return"weapon";case _.WeaponSkin:return"weaponskin";case _.ArmourSkin:return"skin";case _.Shield:return"shield";case _.Cape:return"cape";default:return""}}getLight(){return this.getShield().light}getGuildMember(e){if(this.guild)return this.guild.members?.find(t=>t.username===e)}setMana(e,t){this.mana=e,t&&(this.maxMana=t),this.manaCallback?.(this.mana,t||this.maxMana)}setSkill({type:e,experience:t,level:s,percentage:a,nextExperience:n}){this.skills[e]||(this.skills[e]=new Bo(e)),this.skills[e].update(t,n,s,a)}setQuest(e,t,s){this.quests[e]?.update(t,s)}setAchievement(e,t,s,a){if(!(e in this.achievements)){let n=new Ii(Object.keys(this.achievements).length-1,s,a);n.secret=!0,this.achievements[e]=n;return}this.achievements[e]?.update(t,void 0,s,a)}setAbility(e,t,s,a=-1){e in this.abilities?this.abilities[e]?.update(t,a):this.abilities[e]=new Xo(s,e,t,a),(s===Na.Active||a!==-1)&&this.abilityCallback?.(e,t,a)}setPoison(e){this.poison=e,this.poisonCallback?.(e)}setFriendStatus(e,t,s){this.friends[e].online=t,this.friends[e].serverId=s}setAttackStyle(e,t){this.getWeapon().attackStyle=e,t&&(this.getWeapon().attackStyles=t)}setRank(e){this.rank=e,this.crown=this.getRankCrown()}setGuild(e){if(!e){this.guild=void 0;return}this.guild={name:e.name,members:e.members}}setAnimation(e,t=120,s=0,a){e==="atk"&&this.getWeapon().bow&&(e="bow_atk"),super.setAnimation(e,t,s,a)}setGuildMember(e,t=St.Fledgling){if(!this.guild)return;let s=this.guild.members?.find(a=>a.username===e);s&&(s.rank=t)}setOrientation(e){switch(super.setOrientation(e),this.equipmentOrder=_s,e){case A.Up:{this.equipmentOrder=[_.Legplates,_.Chestplate,_.Helmet,_.ArmourSkin,_.Shield,_.Weapon,_.WeaponSkin,_.Cape];break}}}toggleAbility(e){this.abilities[e]?.toggle()}toggleDrawableEquipments(e=!1){this.getHelmet().drawable=e,this.getChestplate().drawable=e,this.getLegplate().drawable=e}isRanged(){return this.attackRange>1}isMagic(){return this.getWeapon().bonuses.magic>0&&this.isRanged()}hasWeapon(){return this.equipments[_.Weapon].exists()}hasRank(){return this.rank!==Q.None}hasCrown(){return this.crown!==z.None}hasKeyboardMovement(){return this.moveLeft||this.moveRight||this.moveUp||this.moveDown}hasFriend(e){return e.toLowerCase()in this.friends}hasLight(){let e=this.getLight();return!!(e?.outer||e?.inner)}hasMember(e){if(!this.guild)return!1;let t=!1;for(let s in this.guild.members)if(this.guild.members[s].username===e){t=!0;break}return t}forEachEquipment(e,t=!1){for(let s of this.equipmentOrder){let a=this.equipments[s];a.drawable&&(t&&!a.exists()||e(a,~~s))}}onPoison(e){this.poisonCallback=e}onSync(e){this.syncCallback=e}onAbility(e){this.abilityCallback=e}onMana(e){this.manaCallback=e}}class Go extends je{constructor(e,t){super(e,C.Projectile),this.hitType=t}type=C.Projectile;fadingDuration=100;speed=150;hasSpawned=!1;target;idle(){this.setAnimation("travel")}setTarget(e){this.target=e,this.updateAngle()}setGridPosition(e,t){this.hasSpawned||(super.setGridPosition(e,t),this.hasSpawned=!0)}getAnimationSpeed(){return this.sprite.idleSpeed}getTimeDiff(){return(Date.now()-this.lastUpdate)/1e3}getImpactEffect(){switch(this.hitType){case X.Explosive:return N.Fireball}switch(this.sprite.key){case"projectiles/boulder":return N.Boulder;case"projectiles/poisonball":return N.Poisonball;case"projectiles/fireball":case"projectiles/gift6":return N.Fireball;case"projectiles/iceball":return N.Iceball;case"projectiles/terror":return N.Terror}return N.None}updateAngle(){this.target&&(this.angle=Math.atan2(this.target.y-this.y,this.target.x-this.x)-Math.PI/2)}onImpact(e){this.impactCallback=e}}class Vo extends je{constructor(e){super(e,C.Effect)}idle(){this.setAnimation("idle",150,1,()=>{},!0)}}class yi extends je{exhausted=!1;constructor(e,t){super(e,t)}shake(){this.setAnimation("shake",150,1,()=>{this.idle()})}idle(){this.setAnimation(this.exhausted?"exhausted":"idle",150,1,()=>{})}updateSilhouette(e){if(this.exhausted){this.silhouette=!1;return}super.updateSilhouette(e)}setExhausted(e=!1){this.exhausted=e,this.idle()}}class Wo extends yi{baseFrame;exhaustedFrame;constructor(e){super(e,C.Tree)}setSprite(e){super.setSprite(e),this.baseFrame=this.sprite.animations.exhausted.frame,this.exhaustedFrame=this.sprite.animations.exhausted.getSecondFrame()}}class $o extends yi{constructor(e){super(e,C.Rock)}}class Ko extends yi{constructor(e){super(e,C.FishSpot)}}class jo extends yi{constructor(e){super(e,C.Foraging)}}class Zo{constructor(e){this.game=e,this.sprites=e.sprites,this.grids=e.map.grids,e.input.loadCursors()}grids;sprites;entities={};entityUpdateQueue={};decrepit=[];create(e){if(this.isPlayer(e.instance)||e.instance in this.entities)return;let t,s="";switch(e.type){case C.Chest:{t=this.createChest(e.instance),s="objects";break}case C.NPC:{t=this.createNPC(e.instance),s="npcs";break}case C.LootBag:case C.Item:{t=this.createItem(e),s="items";break}case C.Mob:{t=this.createMob(e),s="mobs";break}case C.Projectile:{t=this.createProjectile(e),s="projectiles";break}case C.Player:{t=this.createPlayer(e),s="player";break}case C.Pet:{t=this.createPet(e),s="pets";break}case C.Effect:{t=this.createEffect(e),s="effectentity";break}case C.Tree:{t=this.createTree(e),s="trees";break}case C.Rock:{t=this.createRock(e),s="rocks";break}case C.FishSpot:{t=this.createFishSpot(e),s="fishspots";break}case C.Foraging:{t=this.createForaging(e),s="bushes";break}}if(!t)return L.error(`Failed to create entity ${e.instance}`);let a=t.sprite||this.game.sprites.get(`${s}/${e.key}`);if(!a)return console.trace(`Failed to create sprite for entity ${e.key}.`);t.name=e.name,t.setGridPosition(e.x,e.y),t.setSprite(a),t.idle(),this.addEntity(t),e.instance in this.entityUpdateQueue&&(t.updateDisplayInfo(this.entityUpdateQueue[e.instance]),delete this.entityUpdateQueue[e.instance])}createChest(e){return new Uo(e)}createNPC(e){return new Fo(e)}createItem(e){return new xs(e.instance,e.count,e.enchantments)}createMob(e){let t=new qo(e.instance,this.game);return t.setHitPoints(e.hitPoints,e.maxHitPoints),t.attackRange=e.attackRange,t.level=e.level,t.hiddenName=e.hiddenName,t.movementSpeed=e.movementSpeed,t.orientation=e.orientation,e.displayInfo&&(e.displayInfo.colour&&(t.nameColour=e.displayInfo.colour),e.displayInfo.scale&&(t.customScale=e.displayInfo.scale)),t}createProjectile(e){let t=this.get(e.ownerInstance),s=this.get(e.targetInstance);if(!s)return;let a=new Go(e.instance,e.hit.type);return a.name=e.name,a.setTarget(s),a.onImpact(()=>{let n=a.getImpactEffect();n!==N.None&&s.addEffect(n),this.game.info.create(e.hit.type,e.hit.damage,s.x,s.y,this.isPlayer(s.instance),-1,!0,e.hit.skills),s.triggerHealthBar(),s.toggleHurt(),this.unregisterPosition(a),delete this.entities[a.instance]}),t&&(a.setGridPosition(t.gridX,t.gridY),t.lookAt(s),t.performAction(t.orientation,ae.Attack),t.triggerHealthBar()),a}createPlayer(e){let t=new Ua(e.instance,this.game);return t.load(e),t.setSprite(this.game.sprites.get(t.getSpriteName())),t.ready=!0,t.hasLight()&&this.game.renderer.addPlayerLight(t),t}createPet(e){let t=new zo(e.instance,e.owner,this.game),s=this.get(e.owner);return t.movementSpeed=e.movementSpeed,s&&(s.hasPet=!0,s.addFollower(t),t.setTarget(s),s.instance===this.game.player.instance&&this.game.player.sync()),t}createEffect(e){return new Vo(e.instance)}createTree(e){let t=new Wo(e.instance);return t.exhausted=e.state===at.Depleted,t}createRock(e){let t=new $o(e.instance);return t.exhausted=e.state===at.Depleted,t}createFishSpot(e){let t=new Ko(e.instance);return t.exhausted=e.state===at.Depleted,t}createForaging(e){let t=new jo(e.instance);return t.exhausted=e.state===at.Depleted,t}isPlayer(e){return this.game.player.instance===e}get(e){return this.entities[e]}getEntityList(){return Object.keys(this.entities)}addEntity(e){this.entities[e.instance]=e,this.registerPosition(e),e instanceof xs&&e.dropped||e.fadeIn(this.game.time)}removeEntity(e){if(e.isPlayer()&&(e.ready=!1),e.isPet()){let t=this.get(e.owner);t&&(t.hasPet=!1,t.removeFollower(e),t.instance===this.game.player.instance&&this.game.player.sync())}this.unregisterPosition(e),delete this.entities[e.instance]}removeItem(e){this.unregisterPosition(e),delete this.entities[e.instance]}removeChest(e){e.setSprite(this.game.sprites.getDeath()),e.animateDeath(()=>{this.unregisterPosition(e),delete this.entities[e.instance]})}removeNPC(e){e.setSprite(this.game.sprites.getDeath()),e.animateDeath(()=>{this.unregisterPosition(e),delete this.entities[e.instance]})}registerPosition(e){(e.isResource()||e.isNPC())&&(this.game.map.grid[e.gridY][e.gridX]=2),this.grids.addToRenderingGrid(e)}unregisterPosition(e){this.grids.removeFromRenderingGrid(e)}clean(){if(this.decrepit.length!==0)for(let e of this.decrepit)e&&this.removeEntity(e)}cleanDisplayInfo(){for(let e in this.entities){let t=this.entities[e];t.nameColour="",t.customScale=0,t.exclamation=!1,t.blueExclamation=!1}}clearPlayers(e){for(let t of Object.values(this.entities))t.isPlayer()&&t.instance!==e.instance&&this.removeEntity(t)}getAll(){return this.entities}forEachEntity(e){for(let t of Object.values(this.entities))e(t)}}class Qo{constructor(e,t,s,a,n,r=!1,o=-1,h=[]){this.id=e,this.type=t,this.value=s,this.x=a,this.y=n,this.skills=h,this.text=`${s}`,this.updateY=this.isHeal()?2:1,this.duration=this.isHeal()?400:1e3,this.colour=ys[t]||this.colour,o>-1&&(this.colour=zn[o],this.skillKey=`skills/${ne[o].toLowerCase()}`);for(let l=0;l<h.length;l++)h[l]=`skills/${h[l]}`;this.fill=this.colour?.fill||this.fill,this.stroke=this.colour?.stroke||this.stroke,r&&this.hasInflicted()&&(this.fill=this.colour.inflicted.fill,this.stroke=this.colour.inflicted.stroke),this.isDamage()&&s<1&&(this.text="MISS",this.skills=[]),(this.isPoison()||this.isFreezing())&&(this.prefix="--"),this.isPoints()&&(this.prefix="++"),this.isExperience()&&(this.prefix="+",this.suffix="EXP")}opacity=1;skillKey="";text="";prefix="";suffix="";lastTime=0;speed=100;updateY=1;duration=1e3;colour=ys[X.Normal];fill="rgb(255, 50, 50)";stroke="rgb(255, 180, 180)";destroyCallback;update(e){e-this.lastTime>this.speed&&(this.y-=this.updateY,this.lastTime=e,this.opacity-=70/this.duration,this.opacity<0&&this.destroyCallback?.(this.id))}getText(){return`${this.prefix}${this.text} ${this.suffix}`}isHeal(){return this.type===X.Heal}isPoison(){return this.type===X.Poison}isFreezing(){return this.type===X.Freezing}isExperience(){return this.type===X.Experience||this.type===X.Profession}isPoints(){return this.type===X.Heal||this.type===X.Mana}isDamage(){return this.type===X.Normal||this.type===X.Stun||this.type===X.Critical||this.type===X.Explosive}hasInflicted(){return this.colour.inflicted!==void 0}onDestroy(e){this.destroyCallback=e}}class Jo{infos={};create(e,t,s,a,n=!1,r=-1,o=!1,h=[]){o&&(s+=m.randomInt(-8,8),a+=m.randomInt(-6,6));let l=m.createId(Date.now(),s,a);this.addInfo(new Qo(l,e,t,s,a,n,r,h))}addInfo(e){this.infos[e.id]=e,e.onDestroy(t=>delete this.infos[t])}isEmpty(){return Object.keys(this.infos).length===0}update(e){this.forEachInfo(t=>t.update(e))}forEachInfo(e){for(let t of Object.values(this.infos))e(t)}}class el{constructor(e){this.game=e,this.button.addEventListener("click",()=>this.toggle()),this.input.addEventListener("blur",()=>this.hide()),le()&&this.input.addEventListener("click",()=>this.input.focus())}chatBox=document.querySelector("#chat");chatFrame=document.querySelector("#chat-frame");log=document.querySelector("#chat-log");input=document.querySelector("#chat-input");button=document.querySelector("#chat-button");fadingDuration=5e3;fadingTimeout;keyDown(e){if(e==="Enter"&&this.input.value!=="")return this.send();(e==="Escape"||e==="Enter")&&this.toggle()}privateMessage(e){this.inputVisible()||(this.toggle(),this.input.value=`/pm *${e}* `,this.input.focus())}add(e,t,s="",a=!1){let n=this.createElement(e,t);n.style.color=s||"white",a&&(n.style.fontWeight="bold"),this.display(),this.hideChatBox(),this.log.append(n),this.log.scrollTop=this.log.scrollHeight}createElement(e,t){let s=document.createElement("p");return s.innerHTML=`${e} » ${t}`,s}send(){this.game.socket.send(p.Chat,[this.input.value]),this.hide()}toggle(){this.clearTimeout(),this.inputVisible()?this.hide():this.display(!0)}display(e=!1){this.button.classList.add("active"),this.displayChatBox(),e?(this.displayChatFrame(),this.inputVisible()?this.input.style.display="flex":m.fadeIn(this.input),le()||this.input.focus(),this.input.value=""):this.hideChatFrame(),this.log.scrollTop=this.log.scrollHeight}displayChatBox(){m.fadeIn(this.chatBox)}displayChatFrame(){m.fadeIn(this.chatFrame),this.chatBox.style.pointerEvents="auto"}hide(){this.button.classList.remove("active"),this.hideChatBox(),this.input.blur(),this.input.value="",this.log.scrollTop=this.log.scrollHeight,m.fadeOut(this.input),this.hideChatFrame()}hideChatBox(){this.clearTimeout(),this.fadingTimeout=window.setTimeout(()=>{this.inputVisible()||m.fadeOut(this.chatBox)},this.fadingDuration)}hideChatFrame(){m.fadeOut(this.chatFrame),this.chatBox.style.pointerEvents="none"}inputVisible(){return this.input.style.display==="flex"}clear(){this.inputVisible()&&this.toggle(),this.clearTimeout()}clearTimeout(){clearTimeout(this.fadingTimeout),window.clearTimeout(this.fadingTimeout),this.fadingTimeout=void 0}}class tl{constructor(e){this.input=e,this.onUpdate(this.handleUpdate.bind(this))}hovering;attackInfo=document.querySelector("#attack-info");name=this.attackInfo.querySelector(".name");details=this.attackInfo.querySelector(".details");health=this.attackInfo.querySelector(".health");updateCallback;update(e){let{name:t,health:s,details:a}=this;if(!e||!this.validEntity(e))return this.hovering=void 0,this.hide();this.isVisible()||this.display(),this.hovering=e,t.innerHTML=e.name,this.hasHealth()?this.setHealth(e.hitPoints):(s.style.display="none",a.innerHTML="")}handleUpdate(e,t){this.hasHealth()&&this.hovering.instance===e&&(t<1?this.hide():this.setHealth(t))}setHealth(e){if(!this.hasHealth())return;this.health.style.display="flex";let{maxHitPoints:t}=this.hovering;this.health.style.width=`${Math.ceil(e/t*100)}%`,this.details.innerHTML=`${e} / ${t}`}validEntity(e){return e.instance!==this.input.player.instance&&!e.isProjectile()}hasHealth(){return this.hovering?this.hovering.isMob()||this.hovering.isPlayer():!1}display(){m.fadeIn(this.attackInfo)}hide(){m.fadeOut(this.attackInfo)}isVisible(){return this.attackInfo.style.display==="flex"}onUpdate(e){this.updateCallback=e}}class il{constructor(e){this.game=e,this.app=e.app,this.map=e.map,this.camera=e.camera,this.player=e.player,this.friends=e.menu.getFriends(),this.inventory=e.menu.getInventory(),this.interact=e.menu.getInteract(),this.trade=e.menu.getTrade(),this.leaderboards=e.menu.getLeaderboards(),this.guilds=e.menu.getGuilds(),this.store=e.menu.getStore(),this.chatHandler=new el(e),this.hud=new tl(this),this.app.onLeftClick(this.handleLeftClick.bind(this)),this.app.onRightClick(this.handleRightClick.bind(this)),this.app.onKeyDown(this.handleKeyDown.bind(this)),this.app.onKeyUp(this.handleKeyUp.bind(this)),this.app.onMouseMove(t=>{this.game.started&&(this.isOnCanvas=t.target instanceof HTMLCanvasElement,this.setCoords(t),this.moveCursor())}),this.interact.onButton(this.handleInteract.bind(this)),this.interact.onClose(()=>this.interactEntity=void 0),this.friends.onMessage(t=>this.chatHandler.privateMessage(t)),this.targetAnimation.setSpeed(150)}app;map;camera;player;friends;interact;inventory;trade;leaderboards;guilds;store;selectedCellVisible=!1;keyMovement=!1;targetVisible=!0;isOnCanvas=!1;selectedX=-1;selectedY=-1;cursor;targetColour="rgba(255, 255, 255, 0.5)";cursors={};lastMousePosition={x:0,y:0};hovering;mouse={x:0,y:0};chatHandler;hud;targetAnimation=new U("move",2,0,16,16);entity;interactEntity;loadCursors(){this.cursors.hand=this.game.sprites.get("cursors/hand"),this.cursors.sword=this.game.sprites.get("cursors/sword"),this.cursors.loot=this.game.sprites.get("cursors/loot"),this.cursors.target=this.game.sprites.get("cursors/target"),this.cursors.arrow=this.game.sprites.get("cursors/arrow"),this.cursors.talk=this.game.sprites.get("cursors/talk"),this.cursors.spell=this.game.sprites.get("cursors/spell"),this.cursors.bow=this.game.sprites.get("cursors/bow"),this.cursors.axe=this.game.sprites.get("cursors/axe"),this.cursors.pickaxe=this.game.sprites.get("cursors/pickaxe"),this.cursors.cooking=this.game.sprites.get("cursors/cooking"),this.cursors.fishing=this.game.sprites.get("cursors/fishing"),this.cursors.smithing=this.game.sprites.get("cursors/smithing"),this.cursors.smelting=this.game.sprites.get("cursors/smelting"),this.cursors.chiseling=this.game.sprites.get("cursors/chiseling"),this.cursors.crafting=this.game.sprites.get("cursors/crafting"),this.cursors.foraging=this.game.sprites.get("cursors/foraging"),L.debug("Loaded Cursors!")}handleLeftClick(e){if(this.setCoords(e),this.keyMovement=!1,this.player.disableAction=!1,this.player.joystickMovement=!1,this.isCtrlKey())return this.game.socket.send(p.Command,[Ia.CtrlClick,this.getCoords()]);this.move(this.getCoords())}handleRightClick(e){this.setCoords(e);let t=this.getCoords(),s=this.game.searchForEntityAt(t);if(!s||s.instance===this.player.instance)return this.interact.hide();this.interact.show(this.mouse,s,this.game.pvp),this.interactEntity=s}handleKeyDown(e){if(this.store.isVisible())return this.store.keyDown(e.key);if(this.guilds.isVisible())return this.guilds.keyDown(e.key);if(this.leaderboards.isVisible())return this.leaderboards.keyDown(e.key);if(this.trade.isInputDialogueVisible())return this.trade.keyDown(e.key);if(this.inventory.isDropDialogVisible())return this.inventory.keyDown(e.key);if(this.friends.isPopupActive())return this.friends.keyDown(e.key);if(this.chatHandler.inputVisible())return this.chatHandler.keyDown(e.key);let t;switch(e.key){case"w":case"W":case"ц":case"ArrowUp":{this.player.moveUp=!0;return}case"a":case"A":case"ф":case"ArrowLeft":{this.player.moveLeft=!0;return}case"s":case"S":case"ы":case"ArrowDown":{this.player.moveDown=!0;return}case"d":case"D":case"в":case"ArrowRight":{this.player.moveRight=!0;return}case"Enter":{this.chatHandler.toggle();return}case"i":{this.game.menu.getInventory().toggle();return}case"m":{this.game.menu.getWarp().toggle();return}case"p":{this.game.menu.getProfile().toggle();return}case"h":{this.game.menu.getInventory().selectEdible();break}case"t":{if(t=this.game.entities.get(this.player.lastTarget),!t)return;this.setInteractionTarget(),this.setPosition(t.gridX,t.gridY),this.player.follow(t);return}case"Escape":{this.game.menu.hide(),this.player.moving&&this.player.stop();return}case"+":case"=":return this.game.zoom(.2);case"-":case"_":return this.game.zoom(-.2);case"0":case")":return this.camera.setZoom(),this.game.zoom(0)}}handleKeyUp(e){switch(e.key){case"w":case"ArrowUp":{this.player.moveUp=!1;break}case"a":case"ArrowLeft":{this.player.moveLeft=!1;break}case"s":case"ArrowDown":{this.player.moveDown=!1;break}case"d":case"ArrowRight":{this.player.moveRight=!1;break}}this.player.disableAction=!1}handleInteract(e){if(this.interactEntity){switch(e){case P.Attack:return this.move({x:this.interactEntity.x,y:this.interactEntity.y,gridX:this.interactEntity.gridX,gridY:this.interactEntity.gridY});case P.Trade:{this.game.player.trade(this.interactEntity);break}case P.Follow:{this.interactEntity instanceof Le&&this.game.player.pursue(this.interactEntity);break}case P.Examine:{this.game.socket.send(p.Examine,[this.interactEntity.instance]);break}case P.AddFriend:{this.game.socket.send(p.Friends,{opcode:ge.Add,username:this.interactEntity.name});break}}this.interact.hide()}}keyMove(e){this.player.hasPath()||(this.keyMovement=!0,this.player.joystickMovement=!1,this.move(e))}move(e,t=!this.keyMovement){if(!(this.player.stunned||this.player.teleporting)&&(this.setPassiveTarget(),!(this.player.disableAction||this.game.zoning.direction)&&!this.game.map.isOutOfBounds(e.gridX,e.gridY))){if(le()&&this.chatHandler.inputVisible()&&this.chatHandler.toggle(),this.game.menu.hide(),this.game.map.isObject(e.gridX,e.gridY))return this.setInteractionTarget(),this.player.setObjectTarget(e);if(this.player.removeTarget(),this.entity=this.getEntity(e,t),this.entity&&this.entity?.instance!==this.player.instance&&(this.entity.isMob()||this.entity.isPlayer()&&!this.entity.pvp?this.setAttackTarget():this.setInteractionTarget(),this.isTargetable(this.entity))){this.player.follow(this.entity),this.isAttackable(this.entity)&&(this.entity.addAttacker(this.player),this.player.lastTarget=this.entity.instance,this.player.canAttackTarget()&&this.game.socket.send(p.Target,[xe.Attack,this.entity.instance,this.entity.gridX,this.entity.gridY]));return}this.player.isStunned()||this.player.go(e.gridX,e.gridY)}}moveCursor(){if(le())return;if(!this.isOnCanvas)return this.setCursor(this.cursors.hand);let e=this.getCoords(),t=this.game.searchForEntityAt(e);if(t?.instance!==this.player.instance){if(this.entity=this.getEntity(e),this.hud.update(this.entity),!this.entity){if(this.map.isObject(e.gridX,e.gridY)){let s=this.map.getTileCursor(e.gridX,e.gridY);this.setCursor(this.cursors[s||"talk"]),this.hovering=pe.Object;return}this.setCursor(this.cursors.hand),this.hovering=null;return}switch(this.entity.updateSilhouette(!0),this.entity.type){case C.Item:case C.Chest:{this.setCursor(this.cursors.loot),this.hovering=pe.Item;break}case C.Mob:{this.setCursor(this.getAttackCursor()),this.hovering=pe.Mob;break}case C.NPC:{this.setCursor(this.cursors.talk),this.hovering=pe.NPC;break}case C.Tree:{if(t.exhausted)return;this.setCursor(this.cursors.axe),this.hovering=pe.Tree;break}case C.Rock:{if(t.exhausted)return;this.setCursor(this.cursors.pickaxe),this.hovering=pe.Rock;break}case C.FishSpot:{if(t.exhausted)return;this.setCursor(this.cursors.fishing),this.hovering=pe.FishSpot;break}case C.Foraging:{if(t.exhausted)return;this.setCursor(this.cursors.foraging),this.hovering=pe.Foraging;break}case C.Player:{this.game.pvp&&(this.setCursor(this.getAttackCursor()),this.hovering=pe.Player);break}}}}getEntity(e,t=!0){let s=t?this.game.searchForEntityAt(e):this.game.getEntityAt(e.gridX,e.gridY);return this.entity&&(!s||s.instance!==this.entity.instance)&&this.entity.updateSilhouette(),s}saveMouse(){this.lastMousePosition.x=this.mouse.x,this.lastMousePosition.y=this.mouse.y}setPosition(e,t){this.selectedX=e,this.selectedY=t}setCursor(e){this.cursor=e}setPassiveTarget(){this.targetAnimation.setRow(0)}setInteractionTarget(){this.targetAnimation.setRow(1)}setAttackTarget(){this.targetAnimation.setRow(2)}setCoords(e){let{width:t,height:s}=this.game.renderer.background;this.mouse.x=e.x,this.mouse.y=e.y,this.mouse.x>=t?this.mouse.x=t-1:this.mouse.x<=0&&(this.mouse.x=0),this.mouse.y>=s?this.mouse.y=s-1:this.mouse.y<=0&&(this.mouse.y=0)}getAttackCursor(){return this.player.isMagic()?this.cursors.spell:this.player.isRanged()?this.cursors.bow:this.cursors.sword}getCoords(){let e=this.mouse.x%this.camera.zoomFactor,t=this.mouse.y%this.camera.zoomFactor,s=(this.mouse.x-e)/this.camera.zoomFactor+this.camera.x,a=(this.mouse.y-t)/this.camera.zoomFactor+this.camera.y,n=~~(s/this.map.tileSize),r=~~(a/this.map.tileSize);return{x:s,y:a,gridX:n,gridY:r}}getTargetData(){let e=this.game.sprites.get("target");if(!e)return;let{frame:t}=this.targetAnimation,{tileSize:s}=this.game.map,{zoomFactor:a}=this.game.camera;return e.loaded||e.load(),{sprite:e,x:t.x,y:t.y,width:e.width,height:e.height,dx:this.selectedX*s*a,dy:this.selectedY*s*a,dw:e.width*a,dh:e.height*a}}isCtrlKey(){return window.event.ctrlKey}isTargetable(e){return this.isAttackable(e)||e.isNPC()||e.isChest()||e.isResource()}isAttackable(e){return e.isMob()||e.isPlayer()&&this.game.pvp}isMouseRendered(){return this.mouse.x===this.lastMousePosition.x&&this.mouse.y===this.lastMousePosition.y}}class q{constructor(e,t,s){this.containerName=e,this.closeButton=t,this.toggleButton=s,this.container=document.querySelector(this.containerName),this.close=document.querySelector(this.closeButton),this.button=document.querySelector(this.toggleButton),this.close?.addEventListener("click",()=>this.hide()),this.button?.addEventListener("click",()=>this.toggle())}hideOnShow=!0;identifier=-1;container;close;button;showCallback;batch(e){L.debug("Unimplemented menu batch() function.")}synchronize(e){}add(e,t,s,a){L.debug("Unimplemented menu add() function.")}remove(e,t){L.debug("Unimplemented menu remove() function.")}show(e,t,s,a,n,r){this.showCallback?.(),this.button?.classList.add("active"),m.fadeIn(this.container)}hide(){this.button?.classList.remove("active"),m.fadeOut(this.container)}toggle(){this.isVisible()?this.hide():this.show()}resize(){}isVisible(){return this.container.style.display==="flex"||this.container.style.display.includes("flex")}onShow(e){this.showCallback=e}}class sl extends q{page=document.querySelector("#action-page");list=document.querySelector("#action-page > ul");name=document.querySelector("#action-page > .action-item-name");description=document.querySelector("#action-page > .action-item-description");dropDialog=document.querySelector("#action-drop");dropCount=document.querySelector("#action-drop .dialog-count");dropAccept=document.querySelector("#action-drop .dialog-accept");dropCancel=document.querySelector("#action-drop .dialog-cancel");buttonCallback;dropCallback;constructor(){super("#action-container"),this.dropCancel.addEventListener("click",this.hideDropDialog.bind(this)),this.dropAccept.addEventListener("click",this.handleDrop.bind(this))}handleDrop(){let e=this.dropCount.valueAsNumber;this.dropCount.value="",this.hideDropDialog(),this.hide(),this.dropCallback?.(e)}show(e,t,s,a,n,r,o=""){this.clear();for(let h of e)this.add(h);if(this.name.innerHTML=t,o)this.description.innerHTML=o;else{this.description.innerHTML="";let h=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div");if(h.id="action-description-attack",l.id="action-description-defense",d.id="action-description-bonuses",c.id="action-description-enchantments",h.innerHTML=`<u>Attack Stats:</u>
                Crush: ${s.crush} <br>
                Slash: ${s.slash} <br>
                Stab: ${s.stab} <br>
                Archery: ${s.archery} <br>
                Magic: ${s.magic} <br>`,l.innerHTML=`<u>Defense Stats:</u>
                Crush: ${a.crush} <br>
                Slash: ${a.slash} <br>
                Stab: ${a.stab} <br>
                Archery: ${a.archery} <br>
                Magic: ${a.magic} <br>`,d.innerHTML=`<u>Bonuses:</u>
                Accuracy: ${n.accuracy} <br>
                Strength: ${n.strength} <br>
                Archery: ${n.archery} <br>
                Magic: ${n.magic} <br>`,Object.keys(r).length>0){c.innerHTML="<u>Enchantments:</u>";for(let u in r){let g=Oa[u];c.innerHTML+=`${g}: ${r[u].level} <br>`}}this.description.append(h,l,d,c)}super.show()}hide(){super.hide(),this.hideDropDialog()}add(e){let t=document.querySelector(`.action-${e}`);t||(t=document.createElement("li"),t.classList.add("action-button",`action-${e}`),this.list.append(t)),t.addEventListener("click",s=>{s.preventDefault(),this.buttonCallback?.(e)})}showDropDialog(){m.fadeIn(this.dropDialog),this.page.classList.add("dimmed"),this.dropCount.value="1",this.dropCount.focus()}hideDropDialog(){m.fadeOut(this.dropDialog),this.page.classList.remove("dimmed")}clear(){this.list.innerHTML=""}onButton(e){this.buttonCallback=e}onDrop(e){this.dropCallback=e}}class al extends q{constructor(e){super("#inventory",void 0,"#inventory-button"),this.actions=e,this.load(),this.actions.onButton(t=>this.handleAction(t)),this.actions.onDrop(t=>this.handleDrop(t))}identifier=K.Inventory;list=document.querySelector("#inventory-container > ul");selectedSlot=-1;selectCallback;batchCallback;load(){if(!this.list)return L.error("Could not create the skeleton for the inventory.");for(let e=0;e<he.INVENTORY_SIZE;e++)this.list.append(this.createSlot(e))}keyDown(e){switch(e){case"Escape":return this.actions.hideDropDialog();case"Enter":return this.actions.handleDrop()}}handleAction(e){if(e===P.DropMany)return this.actions.showDropDialog();this.selectCallback?.(m.getContainerAction(e),this.selectedSlot,1),this.actions.hide()}handleDrop(e){return this.selectCallback?.(Ne.Remove,this.selectedSlot,e)}batch(e){for(let t of e)t.key&&this.setSlot(t);this.batchCallback?.()}add(e){this.setSlot(e)}remove(e){this.setSlot(e)}select(e,t=!1){let s=this.getElement(e);if(this.isEmpty(s))return this.actions.hide();if(this.selectedSlot=e,t){s.edible?this.handleAction(P.Eat):(s.equippable||s.interactable)&&this.handleAction(P.Equip),this.actions.hide();return}let a=[];s.edible&&a.push(P.Eat),s.interactable&&a.push(P.Interact),s.equippable&&a.push(P.Equip),a.push(P.DropOne),s.count>1&&a.push(P.DropMany),this.actions.show(a,s.name,s.attackStats,s.defenseStats,s.bonuses,s.enchantments,s.description)}selectEdible(){let e=this.getFirstEdible();e!==-1&&(this.selectedSlot=e,this.handleAction(P.Eat))}swap(e,t){this.selectCallback?.(Ne.Swap,e,t),this.selectedSlot=-1}setSlot(e){let t=this.getElement(e.index);if(!t)return L.error(`Could not find slot element at: ${e.index}`);let s=t.querySelector(".item-image"),a=t.querySelector(".item-count");if(!s)return L.error(`Could not find image element at: ${e.index}`);a&&(a.textContent=m.getCount(e.count)),s.style.backgroundImage=e.key?m.getImageURL(e.key):"",t.dataset.key=e.key,t.dataset.count=`${e.count}`,t.edible=e.edible,t.interactable=e.interactable,t.equippable=e.equippable,t.name=e.name,t.count=e.count,t.description=this.formatDescription(e.name,e.count,e.description),t.attackStats=e.attackStats,t.defenseStats=e.defenseStats,t.bonuses=e.bonuses,t.enchantments=e.enchantments}createSlot(e){let t=document.createElement("li"),s=document.createElement("div"),a=document.createElement("div"),n=document.createElement("div");return s.dataset.index=`${e}`,s.classList.add("item-slot"),a.classList.add("item-image"),n.classList.add("item-count"),s.append(a),t.append(s,n),t.addEventListener("click",()=>this.select(e)),t.addEventListener("dblclick",()=>this.select(e,!0)),Da(s,this.handleHold.bind(this),()=>this.isEmpty(this.getElement(e))),t}handleHold(e,t){let s=e?.dataset?.index,a=t?.dataset?.index;!s||!a||s===a||this.swap(parseInt(s),parseInt(a))}hide(){super.hide(),this.selectedSlot=-1,this.actions.hide()}formatDescription(e,t,s){return t<1e3?s:`${s} You have a stack of ${t.toLocaleString("en-US")} ${e.toLowerCase()}. `}isEmpty(e){let t=e.querySelector(".item-image");return!t||t.style.backgroundImage===""}isDropDialogVisible(){return this.actions.dropDialog.style.display==="flex"}getElement(e){return this.list.children[e]}getCount(e){return this.getElement(e)?.count||0}getFirstEdible(){for(let e=0;e<this.list.children.length;e++)if(this.getElement(e).edible)return e;return-1}forEachSlot(e){for(let t=0;t<this.list.children.length;t++)e(t,this.getElement(t))}onSelect(e){this.selectCallback=e}onBatch(e){this.batchCallback=e}}class nl extends q{constructor(e){super("#bank","#close-bank"),this.inventory=e,this.load()}identifier=K.Bank;bankList=document.querySelector("#bank-slots");inventoryList=document.querySelector("#bank-inventory-slots");selectCallback;load(){if(!this.bankList)return L.error("[Bank] Could not find the bank slot list.");if(!this.inventoryList)return L.error("[Bank] Could not find the inventory slot list.");for(let e=0;e<he.BANK_SIZE;e++){let t=this.createDraggableSlot(e,G.Bank,G.Inventory);this.bankList.append(t)}for(let e=0;e<he.INVENTORY_SIZE;e++){let t=this.createDraggableSlot(e,G.Inventory,G.Bank);this.inventoryList.append(t)}this.inventory.onBatch(this.synchronize.bind(this))}createDraggableSlot(e,t,s){let a=m.createSlot(t,e,()=>this.select(t,e,s)),n=a.querySelector(".item-slot");return Da(n,this.handleHold.bind(this),()=>this.inventory.isEmpty(this.getElement(e,t))),a}handleHold(e,t){let s=e?.dataset?.type,a=e?.dataset?.index,n=t?.dataset?.type,r=t?.dataset?.index;isNaN(parseInt(s))||isNaN(parseInt(a))||isNaN(parseInt(n))||isNaN(parseInt(r))||this.select(parseInt(s),parseInt(a),parseInt(n),parseInt(r))}select(e,t,s,a){this.selectCallback?.(e,t,s,a)}setSlot(e){let t=this.getBankElement(e.index).querySelector(".item-image"),s=this.getBankElement(e.index).querySelector(".item-count");t.style.backgroundImage=m.getImageURL(e.key),s.textContent=m.getCount(e.count)}synchronize(){this.isVisible()&&(this.inventoryList.scrollTop=0,this.inventory.forEachSlot((e,t)=>{let s=this.getInventoryElement(e),a=s.querySelector(".item-image"),n=s.querySelector(".item-count"),r=t.querySelector(".item-image");r&&(a.style.backgroundImage=r.style.backgroundImage,n.textContent=t.textContent)}))}batch(e){for(let t of e)t.key&&this.setSlot(t)}add(e){this.setSlot(e)}remove(e){this.setSlot(e)}show(e){super.show(),this.bankList.scrollTop=0,this.synchronize();for(let t of e)this.setSlot(t)}hide(){super.hide()}getElement(e,t){return t===G.Bank?this.getBankElement(e):this.getInventoryElement(e)}getBankElement(e){return this.bankList.children[e]}getInventoryElement(e){return this.inventoryList.children[e]}onSelect(e){this.selectCallback=e}}class rl extends q{constructor(e){super("#store","#close-store"),this.inventory=e,this.resize(),this.sellSlot.addEventListener("click",this.synchronize.bind(this)),this.confirmSell.addEventListener("click",this.sell.bind(this)),this.buyCancel.addEventListener("click",this.hideBuyDialog.bind(this)),this.buyAccept.addEventListener("click",this.handleBuy.bind(this));for(let t=0;t<he.INVENTORY_SIZE;t++)this.inventoryList.append(m.createSlot(G.Inventory,t,this.select.bind(this)))}identifier=K.Store;key="";currency="gold";selectedIndex=-1;selectedCount=-1;selectedBuyIndex=-1;storeContainer=document.querySelector("#store-content");confirmSell=document.querySelector("#store-sell-confirm");sellSlot=document.querySelector("#store-sell-slot");sellSlotText=document.querySelector("#store-sell-text");sellSlotReturn=document.querySelector("#store-sell-return-slot");sellSlotReturnText=document.querySelector("#store-sell-return-text");storeList=document.querySelector("#store-slots-content > ul");inventoryList=document.querySelector("#store-inventory-slots > ul");buyDialog=document.querySelector("#store-buy");buyCount=document.querySelector("#store-buy .dialog-count");buyAccept=document.querySelector("#store-buy .dialog-accept");buyCancel=document.querySelector("#store-buy .dialog-cancel");selectCallback;keyDown(e){this.isBuyDialogVisible()&&(e==="Enter"?this.handleBuy():e==="Escape"&&this.hideBuyDialog())}update(e){this.clear(),this.key=e.key,this.currency=e.currency;for(let t=0;t<e.items.length;t++)this.storeList.append(this.createStoreItem(e.items[t],t))}select(e,t){this.selectCallback?.(We.Select,this.key,t)}sell(){this.selectCallback?.(We.Sell,this.key,this.selectedIndex,this.selectedCount)}buy(e,t=1){this.selectCallback?.(We.Buy,this.key,e,t)}handleBuy(){this.buy(this.selectedBuyIndex,this.buyCount.valueAsNumber),this.hideBuyDialog()}showBuyDialog(){m.fadeIn(this.buyDialog),this.storeContainer.classList.add("dimmed"),this.buyCount.value="1",le()||this.buyCount.focus()}hideBuyDialog(){m.fadeOut(this.buyDialog),this.storeContainer.classList.remove("dimmed")}synchronize(){this.isVisible()&&(this.clearSellSlot(),this.inventoryList.scrollTop=0,this.inventory.forEachSlot((e,t)=>{let s=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count"),n=t.querySelector(".item-image");n&&(s.style.backgroundImage=n.style.backgroundImage,a.textContent=t.textContent)}))}show(e){super.show(),this.update(e),this.synchronize()}hide(){super.hide(),this.clear(),this.clearSellSlot(),this.hideBuyDialog()}clear(){this.key="",this.currency="gold",this.storeList.innerHTML="",this.storeList.scrollTop=0}clearSellSlot(){this.selectedIndex=-1,this.selectedCount=-1,this.sellSlot.style.backgroundImage="",this.sellSlotText.textContent="",this.sellSlotReturn.style.backgroundImage="",this.sellSlotReturnText.textContent=""}move(e){if(e.key!==this.key)return L.error("Invalid store key provided for the select.");this.synchronize();let t=this.getElement(e.item.index).querySelector(".item-image"),s=this.getElement(e.item.index).querySelector(".item-count");if(!t||!s)return L.error("[Store] Could not find image and count elements.");this.sellSlot.style.backgroundImage=t.style.backgroundImage,this.sellSlotText.textContent=s.textContent,this.sellSlotReturn.style.backgroundImage=m.getImageURL(this.currency),this.sellSlotReturnText.textContent=e.item.price.toString()||"",t.style.backgroundImage="",s.textContent="",this.selectedIndex=e.item.index,this.selectedCount=e.item.count}createStoreItem(e,t){let s=document.createElement("li"),a=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),h=document.createElement("div");return s.classList.add("slice-list-item"),a.classList.add("slice-item-slot"),n.classList.add("store-item-image"),r.classList.add("store-item-name","stroke"),o.classList.add("store-item-count","stroke"),h.classList.add("store-item-price","stroke"),e.count!==-1&&(o.textContent=`x${e.count.toString()}`),r.textContent=e.name,h.textContent=`${e.price.toString()}${this.currency[0]}`,n.style.backgroundImage=m.getImageURL(e.key),s.addEventListener("click",()=>{this.selectedBuyIndex=t,this.showBuyDialog()}),a.append(n),s.append(a,r,o,h),s}isBuyDialogVisible(){return this.buyDialog.style.display!=="none"}getElement(e){return this.inventoryList.children[e]}onSelect(e){this.selectCallback=e}}class ol{constructor(e){this.player=e,this.player.onHitPoints(this.handleHitPoints.bind(this)),this.player.onMana(this.handleMana.bind(this)),this.player.onPoison(this.handlePoison.bind(this))}health=document.querySelector("#health");mana=document.querySelector("#mana");healthMask=document.querySelector("#health-mask");manaMask=document.querySelector("#mana-mask");healthText=this.health.querySelector(".health-text");manaText=this.mana.querySelector(".mana-text");handleHitPoints(e,t,s){this.setPoints(this.health,this.healthMask,this.healthText,e,t,s)}handleMana(e,t){this.setPoints(this.mana,this.manaMask,this.manaText,e,t)}handlePoison(e){e?this.healthMask.classList.add("health-mask-poison"):this.healthMask.classList.remove("health-mask-poison")}resize(){this.handleHitPoints(this.player.hitPoints,this.player.maxHitPoints),this.handleMana(this.player.mana,this.player.maxMana)}setPoints(e,t,s,a,n,r){let o=a/n;t.style.width=`${Math.floor(e.offsetWidth*o).toString()}px`,s.textContent=`${a}/${n}`,r&&this.flash()}flash(){this.healthMask.classList.add("health-mask-white"),window.setTimeout(()=>this.healthMask.classList.remove("health-mask-white"),150)}}let Z;function Wt(i,e){Z??=document.createElement("div");let t=i.getBoundingClientRect();Z.classList.add("bubble"),Z.textContent=e,document.querySelector("#bubbles").append(Z),Z.style.padding="5px 10px",Z.style.left=`${t.left+t.width/2-Z.offsetWidth/2}px`,Z.style.top=`${t.top-Z.offsetHeight}px`,i.addEventListener("blur",()=>Z.remove()),i.addEventListener("mouseout",()=>Z.remove()),i.addEventListener("mouseleave",()=>Z.remove()),i.addEventListener("touchend",s=>{s.target!==i&&Z.remove()}),i.addEventListener("touchcancel",s=>{s.target!==i&&Z.remove()}),document.addEventListener("touchend",s=>{s.target!==i&&Z.remove()}),document.addEventListener("touchcancel",s=>{s.target!==i&&Z.remove()})}function ll(i,e){i.addEventListener("focus",()=>Wt(i,e)),i.addEventListener("mouseover",()=>Wt(i,e)),i.addEventListener("mouseenter",()=>Wt(i,e)),i.addEventListener("touchstart",()=>Wt(i,e))}class hl extends q{constructor(e){super("#state-page"),this.player=e,this.petPickupButton.addEventListener("click",()=>this.pickupCallback?.()),this.helmet.addEventListener("click",()=>this.unequipCallback?.(_.Helmet)),this.pendant.addEventListener("click",()=>this.unequipCallback?.(_.Pendant)),this.arrows.addEventListener("click",()=>this.unequipCallback?.(_.Arrows)),this.chestplate.addEventListener("click",()=>this.unequipCallback?.(_.Chestplate)),this.weapon.addEventListener("click",()=>this.unequipCallback?.(_.Weapon)),this.shield.addEventListener("click",()=>this.unequipCallback?.(_.Shield)),this.ring.addEventListener("click",()=>this.unequipCallback?.(_.Ring)),this.weaponSkin.addEventListener("click",()=>this.unequipCallback?.(_.WeaponSkin)),this.armourSkin.addEventListener("click",()=>this.unequipCallback?.(_.ArmourSkin)),this.legplates.addEventListener("click",()=>this.unequipCallback?.(_.Legplates)),this.cape.addEventListener("click",()=>this.unequipCallback?.(_.Cape)),this.boots.addEventListener("click",()=>this.unequipCallback?.(_.Boots))}level=document.querySelector("#profile-level");experience=document.querySelector("#profile-experience");petPickupButton=document.querySelector("#pickup-pet-button");attackStyleList=document.querySelector("#attack-style-list");equipmentSlots=document.querySelector("#profile-equipment-slots");helmet=this.equipmentSlots.querySelector(".equipment-slot-helmet > .equipment-slot-image");pendant=this.equipmentSlots.querySelector(".equipment-slot-pendant > .equipment-slot-image");arrows=this.equipmentSlots.querySelector(".equipment-slot-arrows > .equipment-slot-image");chestplate=this.equipmentSlots.querySelector(".equipment-slot-chestplate > .equipment-slot-image");weapon=this.equipmentSlots.querySelector(".equipment-slot-weapon > .equipment-slot-image");shield=this.equipmentSlots.querySelector(".equipment-slot-shield > .equipment-slot-image");ring=this.equipmentSlots.querySelector(".equipment-slot-ring > .equipment-slot-image");weaponSkin=this.equipmentSlots.querySelector(".equipment-slot-weapon-skin > .equipment-slot-image");armourSkin=this.equipmentSlots.querySelector(".equipment-slot-armour-skin > .equipment-slot-image");legplates=this.equipmentSlots.querySelector(".equipment-slot-legplates > .equipment-slot-image");cape=this.equipmentSlots.querySelector(".equipment-slot-cape > .equipment-slot-image");boots=this.equipmentSlots.querySelector(".equipment-slot-boots > .equipment-slot-image");unequipCallback;styleCallback;pickupCallback;synchronize(){this.petPickupButton.hidden=!this.player.hasPet,this.level.textContent=`Level ${this.player.level}`,this.experience.textContent=`${this.player.getTotalExperience()}`,this.helmet.style.backgroundImage=m.getImageURL(this.player.getHelmet().key)||m.getEquipmentPlaceholderURL(_.Helmet),this.pendant.style.backgroundImage=m.getImageURL(this.player.getPendant().key)||m.getEquipmentPlaceholderURL(_.Pendant),this.arrows.style.backgroundImage=m.getImageURL(this.player.getArrows().key)||m.getEquipmentPlaceholderURL(_.Arrows),this.chestplate.style.backgroundImage=m.getImageURL(this.player.getChestplate().key)||m.getEquipmentPlaceholderURL(_.Chestplate),this.weapon.style.backgroundImage=m.getImageURL(this.player.getWeapon().key)||m.getEquipmentPlaceholderURL(_.Weapon),this.shield.style.backgroundImage=m.getImageURL(this.player.getShield().key)||m.getEquipmentPlaceholderURL(_.Shield),this.ring.style.backgroundImage=m.getImageURL(this.player.getRing().key)||m.getEquipmentPlaceholderURL(_.Ring),this.weaponSkin.style.backgroundImage=m.getImageURL(this.player.getWeaponSkin().key)||m.getEquipmentPlaceholderURL(_.WeaponSkin),this.armourSkin.style.backgroundImage=m.getImageURL(this.player.getArmourSkin().key)||m.getEquipmentPlaceholderURL(_.ArmourSkin),this.legplates.style.backgroundImage=m.getImageURL(this.player.getLegplate().key)||m.getEquipmentPlaceholderURL(_.Legplates),this.cape.style.backgroundImage=m.getImageURL(this.player.getCape().key)||m.getEquipmentPlaceholderURL(_.Cape),this.boots.style.backgroundImage=m.getImageURL(this.player.getBoots().key)||m.getEquipmentPlaceholderURL(_.Boots),this.loadAttackStyles()}loadAttackStyles(){this.attackStyleList.innerHTML="";for(let e of this.player.getWeapon().attackStyles)this.attackStyleList.append(this.createStyle(e))}createStyle(e){let t=document.createElement("li"),s=document.createElement("div");return t.classList.add("attack-style-box"),ll(t,this.getTooltip(e)),s.classList.add("attack-style",`attack-style-${J[e].toLowerCase()}`),e===this.player.getWeapon().attackStyle&&t.classList.add("active"),t.append(s),t.addEventListener("click",()=>this.styleCallback?.(e)),t}getTooltip(e){switch(e){case J.Stab:return"Stab (Accuracy EXP)";case J.Slash:return"Slash (Strength EXP)";case J.Defensive:return"Defensive (Defense EXP)";case J.Crush:return"Crush (Accuracy + Strength EXP)";case J.Shared:return"Shared (Accuracy + Strength + Defense EXP)";case J.Hack:return"Hack (Strength + Defense EXP)";case J.Chop:return"Chop (Accuracy + Defense EXP)";case J.Accurate:return"Accurate (Increased Accuracy)";case J.Fast:return"Fast (Increased Speed)";case J.Focused:return"Focused (Increased Damage)";case J.LongRange:return"Long Range"}return"Create a bug report if you see this :)"}onUnequip(e){this.unequipCallback=e}onStyle(e){this.styleCallback=e}onPickup(e){this.pickupCallback=e}}class dl extends q{constructor(e){super("#skills-page"),this.player=e}list=document.querySelector("#skills-list > ul");info=document.querySelector("#skill-info");selectedSkill;loaded=!1;synchronize(e=!1){if(Object.keys(this.player.skills).length!==0){e&&(this.list.innerHTML="");for(let t of La){let s=this.player.skills[t];if(!s)continue;let a=this.get(s.name);a?this.update(a,s):(a=this.createElement(s),this.list.append(a),this.update(a,s))}this.isInfoVisible()&&this.showInfo()}}show(){super.show(),!this.loaded&&(this.loaded=!0,this.synchronize())}hide(){super.hide(),this.hideInfo()}hideInfo(){m.fadeOut(this.info)}createElement(e){let t=document.createElement("li"),s=document.createElement("div"),a=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),h=document.createElement("div");return t.classList.add("slice-list-item"),s.classList.add("slice-item-slot"),a.classList.add("skill-image",`skill-image-${e.name.toLowerCase()}`),n.classList.add("skill-content"),r.classList.add("skill-level","stroke"),o.classList.add("skill-experience"),h.classList.add("skill-experience-progress"),s.append(a),o.append(h),n.append(r,o),t.append(s,n),t.name=e.name,t.level=e.level,t.percentage=e.percentage,t.addEventListener("click",()=>this.showInfo(e)),t}showInfo(e=this.selectedSkill){m.fadeIn(this.info);let t=this.info.querySelector(".skill-info-image"),s=this.info.querySelector(".skill-info-title"),a=this.info.querySelector(".skill-info-details");t.className=`skill-info-image skill-image-${e.name.toLowerCase()}`,s.innerHTML=e.name,a.innerHTML=`
            <span><strong>Level:</strong> ${e.level}</span>
            <span><strong>Exp:</strong> ${e.experience}</span>
            <span><strong>Next Exp:</strong> ${e.nextExperience}</span>
            <span><strong>Percent:</strong> ${(e.percentage*100).toFixed(3)}%</span>
        `,this.selectedSkill=e}update(e,t){let s=e.querySelector(".skill-level"),a=e.querySelector(".skill-experience-progress");s.innerHTML=`${t.level}/${he.MAX_LEVEL}`,a.style.width=`${t.percentage*100}%`,e.level=t.level,e.percentage=t.percentage}get(e){for(let t of this.list.children)if(t.name===e)return t}isInfoVisible(){return this.info.style.display==="flex"}}class ul extends q{constructor(e){super("#profile-container",void 0,"#profile-button"),this.player=e,this.state=new hl(this.player),this.skills=new dl(this.player),this.pages.push(this.state,this.skills),this.update(),this.previous.addEventListener("click",()=>this.handleNavigation("previous")),this.next.addEventListener("click",()=>this.handleNavigation("next")),this.state.onUnequip(t=>this.unequipCallback?.(t)),this.state.onStyle(t=>this.attackStyleCallback?.(t)),this.state.onPickup(()=>this.pickupCallback?.())}state;skills;pages=[];activePage=0;previous=document.querySelector("#profile-navigator > .previous");next=document.querySelector("#profile-navigator > .next");unequipCallback;attackStyleCallback;pickupCallback;hide(){super.hide(),this.skills.hideInfo()}handleNavigation(e){this.isDisabled(e)||(this.previous.classList.remove("disabled"),this.next.classList.remove("disabled"),this.pages[this.activePage]?.hide(),this.activePage+=e==="previous"?-1:1,this.update())}update(){this.activePage<=0&&(this.activePage=0,this.previous.classList.add("disabled")),this.activePage>=this.pages.length-1&&(this.activePage=this.pages.length-1,this.next.classList.add("disabled")),this.pages[this.activePage]?.show()}synchronize(){this.forEachPage(e=>e.synchronize())}resize(){this.skills.synchronize(!0)}isDisabled(e){return e==="previous"&&this.previous.classList.contains("disabled")||e==="next"&&this.next.classList.contains("disabled")}forEachPage(e){for(let t of this.pages)e(t)}onUnequip(e){this.unequipCallback=e}onAttackStyle(e){this.attackStyleCallback=e}onPickup(e){this.pickupCallback=e}}class cl extends q{constructor(e){super("#enchant","#close-enchant"),this.inventory=e,this.selectedItem.addEventListener("click",this.clear.bind(this)),this.selectedShards.addEventListener("click",this.clear.bind(this)),this.confirmButton.addEventListener("click",this.confirm.bind(this));for(let t=0;t<he.INVENTORY_SIZE;t++)this.list.append(m.createSlot(G.Inventory,t,this.select.bind(this)))}identifier=K.Enchant;list=document.querySelector("#enchant-inventory-slots");selectedItem=document.querySelector("#enchant-item-selected > div");selectedShards=document.querySelector("#enchant-item-shards > div");selectedShardsCount=document.querySelector("#enchant-item-count");confirmButton=document.querySelector("#enchant-item-confirm");selectedSlot=-1;selectedShard=-1;selectCallback;confirmCallback;synchronize(){this.isVisible()&&(this.clearSelections(),this.inventory.forEachSlot((e,t)=>{let s=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count"),n=t.querySelector(".item-image");n&&(s.style.backgroundImage=n.style.backgroundImage,a.textContent=t.textContent)}))}show(){super.show(),this.synchronize()}confirm(){this.selectedSlot===-1||this.selectedShard===-1||this.confirmCallback?.(this.selectedSlot,this.selectedShard)}select(e,t){this.selectCallback?.(t)}move(e,t=!1){let s=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count");if(this.selectedSlot!==-1&&!t){let n=this.getElement(this.selectedSlot),r=n.querySelector(".item-image");r.style.backgroundImage=this.selectedItem.style.backgroundImage}if(this.selectedShard!==-1&&t){let n=this.getElement(this.selectedShard),r=n.querySelector(".item-image"),o=n.querySelector(".item-count");r.style.backgroundImage=this.selectedShards.style.backgroundImage,o.textContent=this.selectedShardsCount.textContent}t?this.selectedShard=e:this.selectedSlot=e,(t?this.selectedShards:this.selectedItem).style.backgroundImage=s.style.backgroundImage,t&&(this.selectedShardsCount.textContent=a.textContent),s.style.backgroundImage="",a.textContent=""}clear(){this.clearSelections(),this.synchronize()}clearSelections(){this.selectedSlot=-1,this.selectedShard=-1,this.selectedItem.style.backgroundImage="",this.selectedShards.style.backgroundImage="",this.selectedShardsCount.textContent=""}getElement(e){return this.list.children[e]}onSelect(e){this.selectCallback=e}onConfirm(e){this.confirmCallback=e}}class gl extends q{identifier=K.Warp;list=document.querySelectorAll(".map-button");selectCallback;constructor(){super("#map-frame","#close-map-frame","#warp-button");for(let e of this.list)e.addEventListener("click",()=>this.handleWarp(e))}handleWarp(e){let t=parseInt(e.id.replace("warp",""));if(isNaN(t))return L.error("Invalid warp element clicked.");this.selectCallback?.(t),this.hide()}onSelect(e){this.selectCallback=e}}class ml extends q{title=document.querySelector("#notification-text-title");description=document.querySelector("#notification-text-description");timeout;constructor(){super("#notification")}show(e,t,s){if(this.isVisible()){this.hide(!1),window.setTimeout(()=>this.show(e,t,s),700);return}this.container.classList.add("active"),this.container.style.bottom="0",this.title.style.color=s,this.title.innerHTML=e,this.description.innerHTML=t,clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>this.hide(!1),7e3)}hide(e=!0){e||(this.container.classList.remove("active"),this.container.style.bottom="-6em")}isVisible(){return this.container.classList.contains("active")}getPosition(){return window.innerHeight-this.container.offsetHeight}}class fl extends q{constructor(e){super("#settings-page","#close-settings","#settings-button"),this.game=e,this.musicSlider.addEventListener("input",this.handleMusic.bind(this)),this.soundSlider.addEventListener("input",this.handleSoundVolume.bind(this)),this.brightnessSlider.addEventListener("input",this.handleBrightness.bind(this)),this.audioEnabledCheckbox.addEventListener("change",this.handleAudioEnabled.bind(this)),this.lowPowerCheckbox.addEventListener("change",this.handleLowPower.bind(this)),this.joystickEnabledCheckbox.addEventListener("change",this.handleJoystickEnabled.bind(this)),this.debugCheckbox.addEventListener("change",this.handleDebug.bind(this)),this.showNamesCheckbox.addEventListener("change",this.handleName.bind(this)),this.showLevelsCheckbox.addEventListener("change",this.handleLevel.bind(this)),this.disableCachingCheckbox.addEventListener("change",this.handleCaching.bind(this)),this.webGlCheckbox.addEventListener("change",this.handleWebGl.bind(this)),this.fpsThrottleDropdown.addEventListener("change",this.handleFpsThrottle.bind(this)),this.load()}identifier=K.Settings;musicSlider=document.querySelector("#music");soundSlider=document.querySelector("#sound");brightnessSlider=document.querySelector("#brightness");audioEnabledCheckbox=document.querySelector("#audio-enabled-checkbox > input");lowPowerCheckbox=document.querySelector("#low-power-checkbox > input");joystickEnabledCheckbox=document.querySelector("#joystick-enabled-checkbox > input");debugCheckbox=document.querySelector("#debug-mode-checkbox > input");showNamesCheckbox=document.querySelector("#show-names-checkbox > input");showLevelsCheckbox=document.querySelector("#show-levels-checkbox > input");disableCachingCheckbox=document.querySelector("#disable-region-caching-checkbox > input");webGlCheckbox=document.querySelector("#webgl-checkbox > input");fpsThrottleDropdown=document.querySelector("#frame-throttle > select");load(){let e=this.game.storage.getSettings();this.musicSlider.value=e.musicVolume?.toString(),this.soundSlider.value=e.soundVolume?.toString(),this.brightnessSlider.value=e.brightness?.toString(),this.audioEnabledCheckbox.checked=e.audioEnabled,this.lowPowerCheckbox.checked=e.lowPowerMode,this.joystickEnabledCheckbox.checked=e.joyStickEnabled,this.debugCheckbox.checked=e.debugMode,this.showNamesCheckbox.checked=e.showNames,this.showLevelsCheckbox.checked=e.showLevels,this.disableCachingCheckbox.checked=e.disableCaching,this.webGlCheckbox.checked=e.webgl,this.fpsThrottleDropdown.selectedIndex=e.fpsThrottle,Fn()&&this.hideWebGlOption(),this.hideDebugOption(),this.handleBrightness(),this.handleDebug(),this.handleLowPower(),this.handleJoystickEnabled(),this.handleName(),this.handleLevel(),this.handleInfo(),this.handleFpsThrottle()}handleMusic(){this.game.storage.setMusicVolume(this.musicSlider.valueAsNumber),this.game.audio.updateVolume()}handleSoundVolume(){this.game.storage.setSoundVolume(this.soundSlider.valueAsNumber)}handleBrightness(){this.game.storage.setBrightness(this.brightnessSlider.valueAsNumber),this.game.renderer.setBrightness(this.brightnessSlider.valueAsNumber)}handleAudioEnabled(){this.game.storage.setAudioEnabled(this.audioEnabledCheckbox.checked),this.game.audio.updateVolume()}handleLowPower(){this.game.storage.setLowPowerMode(this.lowPowerCheckbox.checked),this.game.renderer.animateTiles=!this.lowPowerCheckbox.checked,this.lowPowerCheckbox.checked?this.game.camera.decenter():(this.game.camera.center(),this.game.camera.centreOn(this.game.player))}handleJoystickEnabled(){le()?(this.game.storage.setJoyStickEnabled(this.joystickEnabledCheckbox.checked),this.joystickEnabledCheckbox.checked?this.game.joystick.show():this.game.joystick.hide()):document.querySelector("#joystick-enabled-checkbox").hidden=!0}handleDebug(){this.game.storage.setDebug(this.debugCheckbox.checked),this.game.renderer.debugging=this.debugCheckbox.checked}handleName(){this.game.storage.setShowNames(this.showNamesCheckbox.checked),this.game.renderer.drawNames=this.showNamesCheckbox.checked}handleLevel(){this.game.storage.setShowLevels(this.showLevelsCheckbox.checked),this.game.renderer.drawLevels=this.showLevelsCheckbox.checked}handleCaching(){this.game.storage.setDisableCaching(this.disableCachingCheckbox.checked)}handleWebGl(){this.game.storage.setWebGl(this.webGlCheckbox.checked),setTimeout(()=>{window.location.reload()},500)}handleFpsThrottle(){let e=this.fpsThrottleDropdown.selectedIndex;this.game.storage.setFpsThrottle(e);let t=e!==0;this.game.throttle=t,e===1?this.game.targetFPS=1e3/50:e===2&&(this.game.targetFPS=1e3/30)}handleInfo(){let{config:e}=this.game.app;document.querySelector("#game-info-version").textContent=`${e.version}${e.minor}`;let{serverId:t}=this.game.player;document.querySelector("#game-info-world").textContent=t===-1?"Unknown":t.toString()}hideWebGlOption(){let e=document.querySelector("#webgl-checkbox");e.style.display="none"}hideDebugOption(){let e=document.querySelector("#debug-mode-checkbox");e.style.display="none"}}class pl extends q{constructor(e){super("#equipments","#close-equipments","#equipment-button"),this.game=e,this.player=e.player,this.sprites=e.sprites,this.previous.addEventListener("click",()=>this.handleNavigation("previous")),this.next.addEventListener("click",()=>this.handleNavigation("next")),this.helmet.addEventListener("click",()=>this.unequipCallback?.(_.Helmet)),this.pendant.addEventListener("click",()=>this.unequipCallback?.(_.Pendant)),this.arrows.addEventListener("click",()=>this.unequipCallback?.(_.Arrows)),this.chestplate.addEventListener("click",()=>this.unequipCallback?.(_.Chestplate)),this.weapon.addEventListener("click",()=>this.unequipCallback?.(_.Weapon)),this.shield.addEventListener("click",()=>this.unequipCallback?.(_.Shield)),this.ring.addEventListener("click",()=>this.unequipCallback?.(_.Ring)),this.weaponSkin.addEventListener("click",()=>this.unequipCallback?.(_.WeaponSkin)),this.armourSkin.addEventListener("click",()=>this.unequipCallback?.(_.ArmourSkin)),this.legplates.addEventListener("click",()=>this.unequipCallback?.(_.Legplates)),this.cape.addEventListener("click",()=>this.unequipCallback?.(_.Cape)),this.boots.addEventListener("click",()=>this.unequipCallback?.(_.Boots))}identifier=K.Equipments;player;sprites;playerCanvas=document.querySelector("#equipments-player-image-canvas");equipmentSlots=document.querySelector("#equipment-slots");helmet=this.equipmentSlots.querySelector(".equipment-slot-helmet > .equipment-slot-image");pendant=this.equipmentSlots.querySelector(".equipment-slot-pendant > .equipment-slot-image");arrows=this.equipmentSlots.querySelector(".equipment-slot-arrows > .equipment-slot-image");chestplate=this.equipmentSlots.querySelector(".equipment-slot-chestplate > .equipment-slot-image");weapon=this.equipmentSlots.querySelector(".equipment-slot-weapon > .equipment-slot-image");shield=this.equipmentSlots.querySelector(".equipment-slot-shield > .equipment-slot-image");ring=this.equipmentSlots.querySelector(".equipment-slot-ring > .equipment-slot-image");weaponSkin=this.equipmentSlots.querySelector(".equipment-slot-weapon-skin > .equipment-slot-image");armourSkin=this.equipmentSlots.querySelector(".equipment-slot-armour-skin > .equipment-slot-image");legplates=this.equipmentSlots.querySelector(".equipment-slot-legplates > .equipment-slot-image");cape=this.equipmentSlots.querySelector(".equipment-slot-cape > .equipment-slot-image");boots=this.equipmentSlots.querySelector(".equipment-slot-boots > .equipment-slot-image");arrowsCount=document.querySelector(".equipment-slot-arrows-count");previous=document.querySelector("#equipments-player-image-navigator > .previous");next=document.querySelector("#equipments-player-image-navigator > .next");attackStats=document.querySelector("#attack-stats");defenseStats=document.querySelector("#defense-stats");bonuses=document.querySelector("#bonuses");imageOrientation=A.Down;unequipCallback;show(){super.show(),this.synchronize()}synchronize(){this.loadStats(),this.updatePlayerImage(),this.helmet.style.backgroundImage=m.getImageURL(this.player.getHelmet().key)||m.getEquipmentPlaceholderURL(_.Helmet),this.pendant.style.backgroundImage=m.getImageURL(this.player.getPendant().key)||m.getEquipmentPlaceholderURL(_.Pendant),this.arrows.style.backgroundImage=m.getImageURL(this.player.getArrows().key)||m.getEquipmentPlaceholderURL(_.Arrows),this.chestplate.style.backgroundImage=m.getImageURL(this.player.getChestplate().key)||m.getEquipmentPlaceholderURL(_.Chestplate),this.weapon.style.backgroundImage=m.getImageURL(this.player.getWeapon().key)||m.getEquipmentPlaceholderURL(_.Weapon),this.shield.style.backgroundImage=m.getImageURL(this.player.getShield().key)||m.getEquipmentPlaceholderURL(_.Shield),this.ring.style.backgroundImage=m.getImageURL(this.player.getRing().key)||m.getEquipmentPlaceholderURL(_.Ring),this.weaponSkin.style.backgroundImage=m.getImageURL(this.player.getWeaponSkin().key)||m.getEquipmentPlaceholderURL(_.WeaponSkin),this.armourSkin.style.backgroundImage=m.getImageURL(this.player.getArmourSkin().key)||m.getEquipmentPlaceholderURL(_.ArmourSkin),this.legplates.style.backgroundImage=m.getImageURL(this.player.getLegplate().key)||m.getEquipmentPlaceholderURL(_.Legplates),this.cape.style.backgroundImage=m.getImageURL(this.player.getCape().key)||m.getEquipmentPlaceholderURL(_.Cape),this.boots.style.backgroundImage=m.getImageURL(this.player.getBoots().key)||m.getEquipmentPlaceholderURL(_.Boots);let e=this.player.getArrows().count;this.arrowsCount.innerHTML=e<1?"":`+${e}`}handleNavigation(e){let t=[A.Left,A.Up,A.Right,A.Down],s=t.indexOf(this.imageOrientation);switch(e){case"previous":{s=s===0?t.length-1:s-1;break}case"next":{s=s===t.length-1?0:s+1;break}}this.imageOrientation=t[s],this.updatePlayerImage(A[this.imageOrientation].toString().toLowerCase())}loadStats(){let e=m.getEmptyStats(),t=m.getEmptyStats(),s=m.getEmptyBonuses();for(let r of Object.values(this.player.equipments))r.exists()&&(e.crush+=r.attackStats.crush,e.slash+=r.attackStats.slash,e.stab+=r.attackStats.stab,e.archery+=r.attackStats.archery,e.magic+=r.attackStats.magic,t.crush+=r.defenseStats.crush,t.slash+=r.defenseStats.slash,t.stab+=r.defenseStats.stab,t.archery+=r.defenseStats.archery,t.magic+=r.defenseStats.magic,s.accuracy+=r.bonuses.accuracy,s.strength+=r.bonuses.strength,s.archery+=r.bonuses.archery,s.magic+=r.bonuses.magic);let a=["Crush","Slash","Stab","Archery","Magic"],n=["Accuracy","Strength","Archery","Magic"];for(let r of a){let o=r.toLowerCase(),h=this.attackStats.querySelector(`.${o.toLowerCase()}`),l=this.defenseStats.querySelector(`.${o.toLowerCase()}`),d=e[o],c=t[o];h.textContent=`${r}: ${d>0?"+":""}${d}`,l.textContent=`${r}: ${c>0?"+":""}${c}`}for(let r of n){let o=r.toLowerCase(),h=this.bonuses.querySelector(`.${o.toLowerCase()}`),l=s[o];h.textContent=`${r}: ${l>0?"+":""}${l}`}}updatePlayerImage(e="down"){let t=this.playerCanvas.getContext("2d"),s=e==="left",{sprite:a}=this.player;if(!t||!a||a.key==="death")return;s&&(e="right");let n=a.animations[`idle_${e}`];if(!n)return L.error(`Could not find idle frame for ${e}.`);let r=n.row*a.height,o=this.playerCanvas.width,h=this.playerCanvas.height;t.imageSmoothingQuality="low",t.imageSmoothingEnabled=!1,t.clearRect(0,0,this.playerCanvas.width,this.playerCanvas.height),t.restore(),t.save(),s&&(t.translate(o,0),t.scale(-1,1));let l=h/o;t.save(),t.scale(l,1),t.translate(o/2,0),t.drawImage(a.image,0,r,a.width,a.height,0,0,o,h),this.player.forEachEquipment(d=>{let c=this.game.sprites.get(d.key);if(!c)return;c.loaded||c.load();let u=1,g=1,f=c.width!==a.width||c.height!==a.height;if(f){r=n.row*c.height,u=c.width/a.width,g=c.height/a.height;let y=c.offsetX*4-8,k=c.offsetY-8;c.width===64&&(y-=48),c.height===64&&(k-=28),t.save(),t.translate(y,k)}t.drawImage(c.image,0,r,c.width,c.height,0,0,o*u,h*g),f&&t.restore()},!0),t.restore()}onUnequip(e){this.unequipCallback=e}}class wl extends q{constructor(e){super("#achievements","#close-achievements","#achievements-button"),this.player=e,this.tabArrowLeft.addEventListener("click",this.handleTabArrowLeft.bind(this)),this.tabArrowRight.addEventListener("click",this.handleTabArrowRight.bind(this))}identifier=K.Achievements;tabArrowLeft=document.querySelector("#achievements-tab-arrow-left");tabArrowRight=document.querySelector("#achievements-tab-arrow-right");tabText=document.querySelector("#achievements-tab-text");list=document.querySelector("#achievements-content > ul");currentRegion="Mudwich";regions=[];handle(e,t){if(e===li.Batch)return this.displayAchievements();let s=this.player.achievements[t];if(s){if(s.secret)return this.createAchievement(s,t);this.update(this.list.children[s.id],s)}}handleTabArrowLeft(){let e=this.regions.indexOf(this.currentRegion);e===0?e=this.regions.length-1:e--,this.currentRegion=this.regions[e],this.displayAchievements()}handleTabArrowRight(){let e=this.regions.indexOf(this.currentRegion);e===this.regions.length-1?e=0:e++,this.currentRegion=this.regions[e],this.displayAchievements()}displayAchievements(){this.list.innerHTML="",this.list.scrollTop=0;for(let e in this.player.achievements){let t=this.player.achievements[e],{region:s}=t;s||(s="Miscellaneous"),this.regions.includes(s)||this.regions.push(s),s===this.currentRegion&&this.createAchievement(t,e)}this.regions.splice(this.regions.indexOf("Miscellaneous"),1),this.regions.push("Miscellaneous"),this.tabText.innerHTML=this.currentRegion}createAchievement(e,t){let s=document.createElement("li"),a=document.createElement("div"),n=document.createElement("div"),r=document.createElement("p"),o=document.createElement("p");s.classList.add("achievement-element","slice-list"),a.classList.add("coin-slot"),r.classList.add("achievement-title"),o.classList.add("achievement-description"),r.innerHTML=e.name,o.innerHTML=e.description,a.append(n),s.append(a,r,o),e.isFinished()?(r.style.color="#f4b41b",n.classList.add(e.secret?`coin-${t}`:"coin-default")):e.isStarted()&&s.append(this.createProgress(e)),this.list.append(s)}createProgress(e){let t=document.createElement("p");return t.classList.add("achievement-progress"),t.innerHTML=e.isStarted()?`${e.stage-1}/${e.stageCount-1}`:"",t}update(e,t){if(!e)return;let s=e.querySelector(".achievement-title"),a=e.querySelector(".achievement-description"),n=e.querySelector(".achievement-progress");if(s.innerHTML=t.name,a.innerHTML=t.description,t.isFinished()){s.style.color="#fcda1d",n?.remove();let r=e.querySelector(".coin-slot > div");r.classList.add("coin"),r.classList.add("coin-default")}else s.style.color="#fff",e.querySelector(".coin")?.remove(),n?n.innerHTML=t.isStarted()?`${t.stage-1}/${t.stageCount-1}`:"":(n=this.createProgress(t),e.append(n))}}class _l extends q{constructor(e){super("#quests","#close-quests","#quests-button"),this.player=e}identifier=K.Quests;list=document.querySelector("#quests-list > ul");questsLogsContainer=document.querySelector("#quests-logs-container");title=document.querySelector("#quests-logs-title");shortDescription=document.querySelector("#quests-logs-shortdesc");description=document.querySelector("#quests-logs-description");rewards=document.querySelector("#quests-logs-rewards");requirements=document.querySelector("#quests-logs-requirements");handle(e,t=""){switch(e){case nt.Batch:{for(let s of Object.values(this.player.quests))this.createElement(s);break}case nt.Progress:return this.handleProgress(t)}this.buildLog(this.player.quests.tutorial)}handleProgress(e){if(!e)return;let t=this.player.quests[e];if(!t)return;let s=this.list.children[t.id],a=s.querySelector("p");a&&(a.classList.remove("text-green","text-yellow"),t.isFinished()?a.classList.add("text-green"):t.isStarted()&&a.classList.add("text-yellow"))}createElement(e){let t=document.createElement("li"),s=document.createElement("p");t.classList.add("slice-list-item"),s.innerHTML=e.name,e.isFinished()?s.classList.add("text-green"):e.isStarted()&&s.classList.add("text-yellow"),t.append(s),this.list.append(t),t.addEventListener("click",()=>this.buildLog(e))}buildLog(e){this.questsLogsContainer.scrollTop=0;let[t,s]=e.description.split("|");if(this.title.innerHTML=e.name,this.shortDescription.innerHTML=t,this.description.innerHTML=s,e.rewards&&(this.rewards.innerHTML=e.rewards.join("<br>")),Object.keys(e.skillRequirements).length===0&&e.questRequirements.length===0){this.requirements.innerHTML="None";return}let a="";for(let n of e.questRequirements)a+=`Completion of ${this.player.quests[n]?.name}.<br>`;for(let n in e.skillRequirements)a+=`Your ${this.formatSkillName(n)} level must be at least ${e.skillRequirements[n]}.<br>`;this.requirements.innerHTML=a}formatSkillName(e){return e.charAt(0).toUpperCase()+e.slice(1)}}class bl extends q{constructor(e){super("#friends-container",void 0,"#friends-button"),this.game=e,this.player=e.player,this.addButton.addEventListener("click",()=>this.showPopup()),this.removeButton.addEventListener("click",()=>this.showPopup(!0)),this.confirm.addEventListener("click",this.handleConfirm.bind(this)),this.cancel.addEventListener("click",this.hidePopup.bind(this))}identifier=K.Friends;player;page=document.querySelector("#friends-page");list=document.querySelector("#friends-page > ul");addButton=document.querySelector("#add-friend");removeButton=document.querySelector("#remove-friend");input=document.querySelector("#popup-friend-input");confirm=document.querySelector("#popup-friend-confirm");cancel=document.querySelector("#popup-friend-cancel");popup=document.querySelector("#popup-container");confirmCallback;messageCallback;popupActive=!1;removeActive=!1;resize(){for(let e in this.player.friends){let t=this.player.friends[e],s=this.list.children[t.id];if(!s)return;let a=s.children[0],n=this.getMaxLength();t.username.length>n&&(a.innerHTML=`${t.username.slice(0,n)}...`)}}handle(e,t="",s=!1,a=-1){switch(e){case ge.List:{for(let n of Object.values(this.player.friends))this.createElement(n.username,n.online,n.serverId);break}case ge.Add:return this.createElement(t,s,a);case ge.Remove:return this.removeElement(t);case ge.Status:return this.updateStatus(t,s,a)}}handleConfirm(){let e=this.input.value,t=this.removeActive;this.input.value="",this.hidePopup(),!(!e||e.length>32)&&this.confirmCallback?.(e,t)}handleMessage(e){this.player.friends[e]?.online&&this.messageCallback?.(e)}notify(e){this.game.input.chatHandler.add("WORLD",e,"#0dd9e0",!0)}keyDown(e){e==="Escape"&&this.hidePopup(),e==="Enter"&&this.input.value!==""&&this.handleConfirm()}showPopup(e=!1){this.popupActive=!0,this.removeActive=e;let t=e?"Friend to remove":"Friend to add";this.input.title=t,this.input.placeholder=t,m.fadeIn(this.popup),this.page.classList.add("dimmed"),this.input.focus()}hidePopup(){this.popupActive=!1,this.removeActive=!1,m.fadeOut(this.popup),this.page.classList.remove("dimmed")}createElement(e,t=!1,s=-1){let a=document.createElement("li"),n=document.createElement("p"),r=document.createElement("p");a.classList.add("slice-list-item"),t?r.classList.add(this.player.serverId===s?"text-green":"text-yellow"):r.classList.add("text-red"),a.username=e.toLowerCase();let o=this.getMaxLength();e.length>o&&(e=`${e.slice(0,o)}...`),n.innerHTML=m.formatName(e),r.innerHTML=t?`World ${s}`:"Offline",a.append(n,r),this.list.append(a),a.addEventListener("click",()=>this.handleMessage(a.username))}removeElement(e){let t=this.get(e);t&&t.remove(),delete this.player.friends[e]}updateStatus(e,t,s){let a=this.player.friends[e];if(!a)return;let n=this.get(e);if(!n)return;let r=n.children[1];t?(r.classList.add(this.player.serverId===s?"text-green":"text-yellow"),r.innerHTML=`World ${a.serverId}`,this.notify(`${m.formatName(e)} has logged in.`)):(r.classList.remove("text-green","text-yellow"),r.innerHTML="Offline",this.notify(`${m.formatName(e)} has logged out.`))}isPopupActive(){return this.popupActive}get(e){for(let t of this.list.children)if(t.username===e.toLowerCase())return t}getMaxLength(){return Yn()?16:10}onConfirm(e){this.confirmCallback=e}onMessage(e){this.messageCallback=e}}class yl extends q{constructor(e){super("#trade","#close-trade"),this.inventory=e,this.load(),this.acceptButton.addEventListener("click",()=>this.acceptCallback?.()),this.tradeCountAccept.addEventListener("click",()=>this.sendTradeAmount()),this.tradeCountCancel.addEventListener("click",()=>this.hideTradeAmountDialog())}hideOnShow=!1;identifier=K.Trade;inventoryList=document.querySelector("#trade-inventory-slots > ul");playerSlots=document.querySelector("#trade-player-slots > ul");otherPlayerSlots=document.querySelector("#trade-oplayer-slots > ul");playerName=document.querySelector("#trade-player-name");otherPlayerName=document.querySelector("#trade-oplayer-name");tradeStatus=document.querySelector("#trade-status");acceptButton=document.querySelector("#trade-accept");tradeDialog=document.querySelector("#trade-count");tradeCount=document.querySelector("#trade-count .dialog-count");tradeCountAccept=document.querySelector("#trade-count .dialog-accept");tradeCountCancel=document.querySelector("#trade-count .dialog-cancel");inventoryIndex=-1;selectCallback;acceptCallback;closeCallback;load(){for(let e=0;e<he.INVENTORY_SIZE;e++)this.inventoryList.append(m.createSlot(G.Inventory,e,this.select.bind(this),this.showTradeAmountDialog.bind(this))),this.playerSlots.append(m.createSlot(G.Trade,e,this.select.bind(this))),this.otherPlayerSlots.append(m.createSlot(G.Trade,e))}keyDown(e){switch(e){case"Escape":return this.hideTradeAmountDialog();case"Enter":return this.sendTradeAmount()}}synchronize(){this.isVisible()&&this.inventory.forEachSlot((e,t)=>{let s=this.getElement(e).querySelector(".item-image"),a=this.getElement(e).querySelector(".item-count"),n=t.querySelector(".item-image");n&&(s.style.backgroundImage=n.style.backgroundImage,a.textContent=t.textContent)})}show(e,t){super.show(),this.synchronize(),this.playerName.textContent=e.name,this.otherPlayerName.textContent=t.name}hide(e=!1){super.hide(),e||this.closeCallback?.(),this.clearAll(),this.inventoryIndex=-1,this.tradeStatus.innerHTML=""}add(e,t,s,a=!1){let n=a?this.otherPlayerSlots.children[e]:this.playerSlots.children[e],r=n.querySelector(".item-image"),o=n.querySelector(".item-count");if(this.tradeStatus.innerHTML="",r.style.backgroundImage=a?m.getImageURL(s):this.getElementImage(this.inventoryIndex),o.innerHTML=t>1?m.getCount(t):"",!a){let h=this.getElement(this.inventoryIndex).querySelector(".item-count"),l=this.inventory.getCount(this.inventoryIndex)-t;if(n.inventoryIndex=this.inventoryIndex,isNaN(l)||l<1)return this.clearSlot(this.inventoryIndex);h.innerHTML=m.getCount(l)}}remove(e,t=!1){let s=t?this.otherPlayerSlots.children[e]:this.playerSlots.children[e],a=s.querySelector(".item-image"),n=s.querySelector(".item-count");if(!t){let r=s.inventoryIndex;this.setSlot(r,a.style.backgroundImage,this.inventory.getCount(r))}a.style.backgroundImage="",n.innerHTML="",this.tradeStatus.innerHTML="",this.inventoryIndex=-1}sendTradeAmount(){let e=this.tradeCount.valueAsNumber;e<1||(this.select(G.Inventory,this.inventoryIndex,e),this.hideTradeAmountDialog())}showTradeAmountDialog(e,t){this.inventoryIndex=t,m.fadeIn(this.tradeDialog),this.inventoryList.classList.add("dimmed"),this.tradeCount.value="1",this.tradeCount.focus()}hideTradeAmountDialog(){m.fadeOut(this.tradeDialog),this.inventoryList.classList.remove("dimmed")}accept(e){this.tradeStatus.innerHTML=e||""}select(e,t,s){this.inventoryIndex=t,this.selectCallback?.(e,t,s||1)}getElement(e){return this.inventoryList.children[e]}getElementImage(e){return this.getElement(e).querySelector(".item-image").style.backgroundImage}isInputDialogueVisible(){return this.tradeDialog.style.display==="flex"}clearSlot(e){let t=this.getElement(e),s=t.querySelector(".item-image"),a=t.querySelector(".item-count");s.style.backgroundImage="",a.innerHTML=""}clearAll(){for(let e of this.playerSlots.children){let t=e.querySelector(".item-image"),s=e.querySelector(".item-count");t.style.backgroundImage="",s.innerHTML=""}for(let e of this.otherPlayerSlots.children){let t=e.querySelector(".item-image"),s=e.querySelector(".item-count");t.style.backgroundImage="",s.innerHTML=""}}setSlot(e,t,s){let a=this.getElement(e),n=a.querySelector(".item-image"),r=a.querySelector(".item-count");n.style.backgroundImage=t,r.innerHTML=m.getCount(s)}onSelect(e){this.selectCallback=e}onAccept(e){this.acceptCallback=e}onClose(e){this.closeCallback=e}}class kl extends q{constructor(e){super("#interact"),this.player=e}buttonCallback;closeCallback;show(e,t,s=!1){this.clear();let a=[];t.isItem()&&a.push(P.Examine),t.isMob()&&a.push(P.Attack,P.Examine),t.isPlayer()&&(s?a.push(P.Attack):a.push(P.Follow),a.push(P.Trade),this.player.hasFriend(t.name)||a.push(P.AddFriend));for(let n of a)this.add(n);if(a.length>0){let n=e.x+this.container.offsetWidth>window.innerWidth?window.innerWidth-this.container.offsetWidth:e.x,r=e.y+this.container.offsetHeight>window.innerHeight?window.innerHeight-this.container.offsetHeight:e.y;this.container.style.left=`${n}px`,this.container.style.top=`${r}px`,super.show()}}hide(){super.hide(),this.closeCallback?.()}add(e){let t=document.createElement("li");t.classList.add("action-button",`action-${e}`),t.addEventListener("click",()=>this.buttonCallback(e)),this.container.append(t)}clear(){this.container.innerHTML=""}onButton(e){this.buttonCallback=e}onClose(e){this.closeCallback=e}}class El extends q{constructor(e){super("#leaderboards","#close-leaderboards","#leaderboards-button"),this.app=e,this.search.addEventListener("input",this.handleInput.bind(this));for(let t of La)this.searchElements.push({name:ne[t],key:t,type:"skill"});this.app.config.hub&&fetch(`${this.app.config.hub}/leaderboards`).then(t=>t.json()).then(t=>{if(t.availableMobs){this.availableMobs=t.availableMobs;for(let s in this.availableMobs)this.searchElements.push({name:this.availableMobs[s],key:s,type:"mob"});this.load()}}).catch(t=>{L.error(t)})}identifier=K.Leaderboards;searchList=document.querySelector("#leaderboards-search > ul");resultsList=document.querySelector("#leaderboards-results > ul");search=document.querySelector("#leaderboards-search-input");searchElements=[{name:"Total Experience",key:"",type:""},{name:"PVP Kills",key:"pvp",type:"pvp"}];availableMobs={};load(){this.searchList.innerHTML="";for(let e of this.searchElements)this.createSearchElement(e);this.handleSearchElement(this.searchElements[0])}handleInput(e){let t=e.target.value.toLowerCase();for(let s of this.searchList.children)s.querySelector("p").innerHTML.toLowerCase().includes(t)?s.hidden=!1:s.hidden=!0}handleSearchElement(e){let t=`${this.app.config.hub}/leaderboards`;e.type&&(t+=`?${e.type}=${e.key}`),fetch(t).then(s=>s.json()).then(s=>{if(!s.list)return L.info("No results found.");this.resultsList.innerHTML="";for(let a of s.list)this.createResultElement(a,e.type)}).catch(s=>{L.error(s)})}show(){super.show(),this.searchList.scrollTop=0,this.resultsList.scrollTop=0}hide(){super.hide(),this.search.value=""}keyDown(e){e==="Escape"&&this.hide()}createSearchElement(e){let t=document.createElement("li"),s=document.createElement("p");t.classList.add("slice-list-item"),s.classList.add("stroke","white"),s.innerHTML=e.name,t.append(s),t.addEventListener("click",()=>this.handleSearchElement(e)),this.searchList.append(t)}createResultElement(e,t){let s=document.createElement("li"),a=document.createElement("p"),n=document.createElement("p");s.classList.add("slice-list-item"),e.cheater&&a.classList.add("text-red"),e.cheater&&n.classList.add("text-red"),a.innerHTML=e._id,n.innerHTML=t==="skill"||t===""?`${e.experience}`:`${e.kills}`,s.append(a,n),this.resultsList.append(s)}}class Tl extends q{constructor(e){super("#guilds","#close-guilds","#guilds-button"),this.game=e,this.createButton.addEventListener("click",this.handleCreate.bind(this)),this.backButton.addEventListener("click",this.handleBackButton.bind(this)),this.createConfirmButton.addEventListener("click",this.handleCreateConfirm.bind(this)),this.leaveButton.addEventListener("click",this.handleLeave.bind(this)),this.bannerColourButton.addEventListener("click",()=>this.handleColourSelection("banner")),this.bannerOutlineButton.addEventListener("click",()=>this.handleColourSelection("outline")),this.bannerOutlineRight.addEventListener("click",()=>this.handleBannerOutlineStyle("right")),this.bannerOutlineLeft.addEventListener("click",()=>this.handleBannerOutlineStyle("left")),this.memberPromote.addEventListener("click",this.handlePromote.bind(this)),this.memberDemote.addEventListener("click",this.handleDemote.bind(this)),this.memberKick.addEventListener("click",this.handleKick.bind(this)),this.loadSidebar(),this.loadDecorations(),setInterval(()=>this.requestList(),12e3)}identifier=K.Guilds;banner=document.querySelector("#guilds .banner");listContainer=document.querySelector("#guilds-list-container");createButton=document.querySelector("#create-guild");create=document.querySelector("#guilds-create");createError=document.querySelector("#guilds-create-error");backButton=document.querySelector("#guilds-back-button");createConfirmButton=document.querySelector("#guilds-create-button");bannerColours=document.querySelector("#banner-colours");nameInput=document.querySelector("#guilds-name-input");bannerColour=Se.Grey;bannerOutline=bt.StyleOne;bannerOutlineColour=Se.GoldenYellow;bannerCrest=Wi.None;bannerColourButton=document.querySelector("#banner-colour-button");bannerOutlineButton=document.querySelector("#banner-outline-button");bannerOutlineRight=this.bannerOutlineButton.querySelector(".colour-button-arrow-left");bannerOutlineLeft=this.bannerOutlineButton.querySelector(".colour-button-arrow-right");infoContainer=document.querySelector("#guilds-info-container");chat=document.querySelector("#guilds-chat");chatLog=document.querySelector("#guilds-chat-log");chatInput=document.querySelector("#guilds-chat-input");guildName=document.querySelector("#guilds-name");leaveButton=document.querySelector("#guilds-leave");guildList=document.querySelector("#guilds-list > ul");memberListContainer=document.querySelector("#member-list-container");memberList=this.memberListContainer.querySelector("ul");sidebarList=document.querySelector("#sidebar-list");selectedMember;memberName=document.querySelector("#guild-member-selected");memberDialog=document.querySelector("#guild-member-dialog");memberPromote=document.querySelector("#guild-member-promote");memberDemote=document.querySelector("#guild-member-demote");memberKick=document.querySelector("#guild-member-kick");from=0;to=10;currentSidebar="sidebar-members";colourSelection="banner";bannerOutlineStyles=[];handle(e,t){switch(e){case B.Join:return this.handleMemberJoin(t.username,t.serverId);case B.Login:return this.handleConnect(t);case B.Leave:return t?.username&&t.username!==this.getUsername()?(this.game.player.removeGuildMember(t.username),this.handleMemberLeave(t.username)):(this.game.player.setGuild(),this.handleBackButton());case B.Rank:return this.setRank(t.username,t.rank);case B.Update:return this.loadMembers(t.members);case B.Experience:{console.log(t);break}case B.List:return this.loadList(t.guilds,t.total);case B.Error:return this.setError(t.message);case B.Chat:return this.handleChat(t)}}handleCreate(){this.listContainer.style.display="none",this.infoContainer.style.display="none",this.create.style.display="flex"}handleBackButton(){this.bannerColour=Se.Grey,this.bannerOutline=bt.StyleOne,this.bannerOutlineColour=Se.GoldenYellow,this.bannerCrest=Wi.None,this.updateBanner(),this.cleanSelectedCrests(!0),this.setError(),this.memberList.innerHTML="",this.chatLog.innerHTML="",this.create.style.display="none",this.infoContainer.style.display="none",this.listContainer.style.display="flex",this.requestList()}handleCreateConfirm(){if(this.setError(),this.nameInput.value.length<3||this.nameInput.value.length>16)return this.setError("Guild name must be between 3 and 15 characters.");this.game.socket.send(p.Guild,{opcode:B.Create,name:this.nameInput.value,colour:this.bannerColour,outline:this.bannerOutline,outlineColour:this.bannerOutlineColour,crest:this.bannerCrest})}handleLeave(){this.game.socket.send(p.Guild,{opcode:B.Leave})}handlePromote(){this.memberListContainer.querySelector("ul").classList.remove("dimmed"),this.memberDialog.style.display="none",this.game.socket.send(p.Guild,{opcode:B.Promote,username:this.selectedMember})}handleDemote(){this.memberListContainer.querySelector("ul").classList.remove("dimmed"),this.memberDialog.style.display="none",this.game.socket.send(p.Guild,{opcode:B.Demote,username:this.selectedMember})}handleKick(){this.memberListContainer.querySelector("ul").classList.remove("dimmed"),this.memberDialog.style.display="none",this.game.socket.send(p.Guild,{opcode:B.Kick,username:this.selectedMember})}handleConnect(e){this.setError(),this.listContainer.style.display="none",this.create.style.display="none",this.infoContainer.style.display="flex",this.bannerColour=e.decoration?.banner||Se.Grey,this.bannerOutline=e.decoration?.outline||bt.StyleOne,this.bannerOutlineColour=e.decoration?.outlineColour||Se.GoldenYellow,this.bannerCrest=e.decoration?.crest,this.updateBanner(),this.guildName.innerHTML="",this.memberList.innerHTML="";let t=document.createElement("p");t.className="stroke",t.innerHTML=e.name||"Unknown",this.guildName.append(t),this.getUsername()===e.owner&&(this.leaveButton.innerHTML="Disband");for(let s of e.members)this.createElement(this.memberList,s.rank,s.username)}handleMemberJoin(e,t=-1){e!==this.getUsername()&&(this.createElement(this.memberList,St.Fledgling,e),this.loadMembers([{username:e,serverId:t}]))}handleMemberLeave(e){this.getElement(this.memberList,e)?.remove()}handleSidebar(e){if(this.game.player.guild&&this.currentSidebar!==e){switch(e){case"sidebar-members":{this.memberListContainer.style.display="flex",this.chat.style.display="none";break}case"sidebar-chat":{this.memberListContainer.style.display="none",this.chat.style.display="flex";break}}this.currentSidebar=e}}handleChat(e){if(!e.username||!e.serverId)return;let t=`[W${e.serverId}] ${m.formatName(e.username)}`,s=document.createElement("p");s.innerHTML=`${t} » ${e.message}`,this.chatLog.append(s)}handleColourSelection(e){this.colourSelection=e,this.bannerColourButton.classList.remove("active"),this.bannerOutlineButton.classList.remove("active"),e==="banner"?this.bannerColourButton.classList.add("active"):this.bannerOutlineButton.classList.add("active")}handleBannerOutlineStyle(e){this.bannerOutline=e==="right"?this.bannerOutline+1:this.bannerOutline-1,this.bannerOutline<0?this.bannerOutline=this.bannerOutlineStyles.length-1:this.bannerOutline>=this.bannerOutlineStyles.length&&(this.bannerOutline=0),this.bannerOutlineButton.className=`colour-select-button outline-button-${this.bannerOutline+1} active`,this.updateBanner()}keyDown(e){e!=="Enter"||this.currentSidebar!=="sidebar-chat"||this.chatInput.value.length!==0&&this.sendChat()}requestList(){if(!(this.game.player.guild||!this.isVisible()))return this.game.socket.send(p.Guild,{opcode:B.List,from:this.from,to:this.to})}sendChat(){this.chatInput.value.length!==0&&(this.game.socket.send(p.Guild,{opcode:B.Chat,message:this.chatInput.value}),this.chatInput.value="")}loadList(e=[],t=0){this.guildList.innerHTML="";let s=this.listContainer.querySelector("#guilds-info");s.innerHTML=t===0?"There are no guilds available...":"";for(let a of e)this.createElement(this.guildList,"guild",a.name,a.members)}loadSidebar(){for(let e of this.sidebarList.children)e.addEventListener("click",()=>{this.cleanSidebar(),e.classList.add("active"),this.handleSidebar(e.id)})}loadDecorations(){this.loadColours(),this.loadOutlines(),this.loadCrests()}loadColours(){for(let e in Se){let t=document.createElement("li"),s=document.createElement("div"),a=Se[e];t.className=`banner-colour-button banner-colour-button-${a}`,s.className="banner-colour-button-outline",t.addEventListener("click",()=>{this.colourSelection==="banner"?this.bannerColour=a:this.bannerOutlineColour=a,this.updateBanner()}),t.append(s),this.bannerColours.append(t)}}loadOutlines(){for(let e in bt){let t=parseInt(e);isNaN(t)||this.bannerOutlineStyles.push(`banner-outline-${t+1}`)}}loadCrests(){}loadMembers(e){for(let t of e){let s=this.getElement(this.memberList,t.username);if(!s)continue;let a=s.querySelector(".name"),n=s.querySelector(".server"),r=t.serverId===-1?"text-red":t.serverId===this.game.player.serverId?"text-green":"text-yellow";a.className="name",n.className=`server ${r}`,n.innerHTML=t.serverId===-1?"Offline":`${this.game.app.config.name} ${t.serverId}`}}setRank(e,t){let s=this.getElement(this.memberList,e);if(!s)return;let a=s.querySelector(".slot-image");a&&(a.className=`slot-image slot-image-${St[t].toLowerCase()}`)}show(){super.show(),this.requestList()}hide(){super.hide(),this.from=0,this.to=10,this.game.player.guild||this.handleBackButton()}createElement(e,t,s,a=0){let n=document.createElement("li"),r=document.createElement("span"),o=document.createElement("div"),h=t==="guild",l=t==="guild"?"guild":St[t].toLowerCase();if(n.dataset.name=s,n.className="slot-element stroke",r.className="name",o.className="slot-image",r.innerHTML=h?s:m.formatName(s,14),n.append(o),h){if(a>0){let d=document.createElement("span");d.classList.add("count"),d.innerHTML=`${a}/${he.MAX_GUILD_MEMBERS}`,n.append(r,d)}n.addEventListener("click",()=>this.game.socket.send(p.Guild,{opcode:B.Join,identifier:s.toLowerCase()}))}else{o.classList.add(`slot-image-${l}`),n.append(r);let d=document.createElement("span"),c=this.getUsername()===n.dataset.name,u=this.game.player.getGuildMember(this.getUsername()),g=this.game.player.getGuildMember(s),f=(g?.rank||0)>(u?.rank||0);d.className=`server ${c?"text-green":"text-red"}`,d.innerHTML=c?`BagsDungeon ${this.game.player.serverId}`:"Offline",n.append(d),!c&&!f&&n.addEventListener("click",()=>{this.selectedMember=n.dataset.name,this.memberName.textContent=m.formatName(this.selectedMember,14),this.memberListContainer.querySelector("ul").classList.add("dimmed"),this.memberDialog.style.display="flex"})}e.append(n)}cleanSelectedCrests(e=!1){}cleanSidebar(){for(let e of this.sidebarList.children)e.classList.remove("active")}updateBanner(){let e=this.banner.querySelector("#banner-outline"),t=this.banner.querySelector("#banner-crest");this.banner.className=`banner banner-${this.bannerColour}`,e.className=`${this.bannerOutlineStyles[this.bannerOutline]} banner-outline-${this.bannerOutlineColour}`,this.bannerCrest&&(t.className=`banner-crest banner-crest-${this.bannerCrest}`)}getElement(e,t){for(let s of e.children)if(s.dataset.name===t)return s}getUsername(){return this.game.player.name.toLowerCase()}setError(e=""){this.createError.innerHTML=m.parseMessage(m.formatNotification(e))}}class Sl extends q{constructor(e){super("#crafting","#close-crafting"),this.player=e,this.craftOne.addEventListener("click",()=>this.handleAmount(1)),this.craftFive.addEventListener("click",()=>this.handleAmount(5)),this.craftTen.addEventListener("click",()=>this.handleAmount(10)),this.craftButton.addEventListener("click",()=>{this.craftCallback?.(this.selectedKey,this.craftAmount),this.hide()})}identifier=K.Crafting;options=document.querySelector("#crafting-options");requirements=document.querySelector("#crafting-requirements");result=document.querySelector("#crafting-result");level=document.querySelector("#crafting-level");name=document.querySelector("#crafting-result-name");craftOne=document.querySelector("#craft-one");craftFive=document.querySelector("#craft-five");craftTen=document.querySelector("#craft-ten");craftButton=document.querySelector("#craft-button");selectedKey="";craftAmount=1;type=ne.Crafting;selectCallback;craftCallback;handle(e,t){switch(e){case Lt.Open:return this.show(t.type,t.previews);case Lt.Select:return this.handleSelect(t.key,t.name,t.level,t.result,t.requirements)}}handleSelect(e,t,s,a,n){this.requirements.innerHTML="",this.selectedKey=e;let r=this.result.querySelector(".crafting-option-icon"),o=this.result.querySelector(".crafting-option-count"),h=this.level.querySelector(".crafting-option-icon"),l=this.level.querySelector(".crafting-option-count");r.style.backgroundImage=m.getImageURL(e),h.style.backgroundImage=this.getSkillIcon(),o.innerHTML=`x${a}`,l.innerHTML=`${s}`,this.name.innerHTML=t;for(let d of n)this.requirements.append(this.createSlot(d.key,d.name,d.count,0,!0))}handleAmount(e){switch(this.craftAmount=e,this.craftOne.classList.remove("active"),this.craftFive.classList.remove("active"),this.craftTen.classList.remove("active"),e){case 1:{this.craftOne.classList.add("active");break}case 5:{this.craftFive.classList.add("active");break}case 10:{this.craftTen.classList.add("active");break}}}show(e,t){super.show(),this.options.innerHTML="",this.type=e;for(let a of t)this.options.append(this.createSlot(a.key,"",0,a.level));t.length>0&&(this.selectCallback?.(t[0].key),this.options.children[0].classList.add("active"));let s="Craft";switch(e){case ne.Cooking:{s="Cook";break}case ne.Chiseling:case ne.Crafting:{s="Craft";break}case ne.Fletching:{s="Fletch";break}case ne.Smithing:{s="Smith";break}case ne.Smelting:{s="Smelt";break}case ne.Alchemy:{s="Brew";break}}this.craftButton.innerHTML=s}createSlot(e,t,s,a=0,n=!1){let r=document.createElement("li"),o=document.createElement("div");if(r.classList.add("crafting-option"),o.classList.add("crafting-option-icon"),this.player.skills[this.type]?.level<a&&o.classList.add("greyscale"),o.style.backgroundImage=m.getImageURL(e),r.append(o),s){let h=document.createElement("div");h.classList.add("crafting-option-count","stroke"),h.innerHTML=`x${s}`,r.append(h)}return n?r.classList.add("disabled"):r.addEventListener("click",()=>{for(let h of this.options.children)h.classList.remove("active");r.classList.add("active"),this.selectCallback?.(e)}),r}getSkillIcon(){return`url(/img/interface/skills/${ne[this.type].toLowerCase()}.png)`}onSelect(e){this.selectCallback=e}onCraft(e){this.craftCallback=e}}class vl extends q{constructor(e){super("#lootbag","#close-lootbag"),this.inventory=e;for(let t=0;t<he.INVENTORY_SIZE;t++)this.inventoryList.append(m.createSlot(G.LootBag,t))}identifier=K.Lootbag;itemList=document.querySelector("#lootbag-items > ul");inventoryList=document.querySelector("#lootbag-inventory > ul");selectCallback;handle(e,t){switch(e){case Tt.Open:return this.loadItems(t.items),this.show();case Tt.Take:return this.take(t.index);case Tt.Close:return this.hide()}}synchronize(){this.isVisible()&&this.inventory.forEachSlot((e,t)=>{let s=this.getInventoryElement(e).querySelector(".item-image"),a=t.querySelector(".item-image");a&&(s.style.backgroundImage=a.style.backgroundImage)})}show(){super.show(),this.synchronize()}take(e){let t=this.getLootElement(e);t&&t.remove()}loadItems(e){this.itemList.innerHTML="";for(let t of e){let s=m.createSlot(G.LootBag,t.index,()=>this.selectCallback?.(t.index)),a=s.querySelector(".item-image");a&&(a.style.backgroundImage=m.getImageURL(t.key)),s.index=t.index,this.itemList.append(s)}}getLootElement(e){for(let t of this.itemList.children)if(t.index===e)return t}getInventoryElement(e){return this.inventoryList.children[e]}onSelect(e){this.selectCallback=e}}const Il={"0.5.5-beta":{title:"BagsDungeon 0.5.5-beta",content:["- Add language selection menu","- Add FPS throttle option","- New quests","- Anti-cheating detection improvements"]}};class Cl extends q{constructor(e){super("#welcome","#close-welcome"),this.game=e}identifier=K.Welcome;changelog=document.querySelector("#welcome-changelog > ul");show(){super.show(),this.loadChangelog()}loadChangelog(){this.changelog.innerHTML="";let e=Il[this.game.app.config.version];if(!e)return;let t=document.createElement("li").innerHTML=e.title;this.changelog.append(t);for(let s of e.content){let a=document.createElement("li");a.innerHTML=s,this.changelog.append(a)}}}class Al extends q{constructor(e){super("#quest","#close-quest"),this.player=e,this.questButton.addEventListener("click",()=>{if(!this.activeQuest)return L.error("No active quest.");this.hide(),this.acceptCallback?.(this.activeQuest)})}identifier=K.Quest;title=document.querySelector("#quest > .quest-title");description=document.querySelector("#quest > .quest-description");rewards=document.querySelector("#quest > .quest-rewards");questButton=document.querySelector("#quest-button");activeQuest="";acceptCallback;handle(e){let t=this.player.quests[e.key];if(!t)return L.error(`Quest ${e.key} does not exist.`);this.activeQuest=e.key;let[,s]=t.description.split("|");this.title.innerHTML=t.name,this.description.innerHTML=s,this.show()}onAccept(e){this.acceptCallback=e}}class Nl{constructor(e){this.game=e,this.crafting=new Sl(e.player),this.inventory=new al(this.actions),this.bank=new nl(this.inventory),this.store=new rl(this.inventory),this.profile=new ul(e.player),this.enchant=new cl(this.inventory),this.notification=new ml,this.settings=new fl(e),this.header=new ol(e.player),this.equipments=new pl(e),this.achievements=new wl(e.player),this.quests=new _l(e.player),this.friends=new bl(e),this.trade=new yl(this.inventory),this.interact=new kl(e.player),this.leaderboards=new El(e.app),this.guilds=new Tl(e),this.lootBag=new vl(this.inventory),this.welcome=new Cl(e),this.quest=new Al(e.player),this.menus={inventory:this.inventory,bank:this.bank,store:this.store,profile:this.profile,enchant:this.enchant,warp:this.warp,notification:this.notification,settings:this.settings,equipments:this.equipments,achievements:this.achievements,quests:this.quests,friends:this.friends,trade:this.trade,interact:this.interact,leaderboards:this.leaderboards,guilds:this.guilds,crafting:this.crafting,lootBag:this.lootBag,welcome:this.welcome,quest:this.quest},this.inventory.onSelect(this.handleInventorySelect.bind(this)),this.bank.onSelect(this.handleBankSelect.bind(this)),this.store.onSelect(this.handleStoreSelect.bind(this)),this.equipments.onUnequip(this.handleProfileUnequip.bind(this)),this.profile.onUnequip(this.handleProfileUnequip.bind(this)),this.profile.onAttackStyle(this.handleProfileAttackStyle.bind(this)),this.profile.onPickup(this.handleProfilePickup.bind(this)),this.enchant.onSelect(this.handleEnchantSelect.bind(this)),this.enchant.onConfirm(this.handleEnchantConfirm.bind(this)),this.warp.onSelect(this.handleWarp.bind(this)),this.friends.onConfirm(this.handleFriendConfirm.bind(this)),this.trade.onSelect(this.handleTradeSelect.bind(this)),this.trade.onAccept(this.handleTradeAccept.bind(this)),this.trade.onClose(this.handleTradeClose.bind(this)),this.crafting.onSelect(this.handleCraftingSelect.bind(this)),this.crafting.onCraft(this.handleCraftingConfirm.bind(this)),this.lootBag.onSelect(this.handleLootBagSelect.bind(this)),this.quest.onAccept(this.handleQuestAccept.bind(this)),this.load()}actions=new sl;warp=new gl;crafting;inventory;bank;store;profile;enchant;notification;settings;equipments;achievements;quests;friends;trade;interact;leaderboards;guilds;lootBag;welcome;quest;header;menus;load(){this.forEachMenu(e=>e.onShow(()=>this.hide()))}hide(){this.forEachMenu(e=>{e.isVisible()&&e.hide()})}synchronize(e){if(e)return this.menus[e]?.synchronize();this.forEachMenu(t=>t.synchronize())}resize(){this.header.resize(),this.forEachMenu(e=>e.resize())}get(e){for(let t in this.menus)if(this.menus[t].identifier===e)return this.menus[t]}getInteract(){return this.interact}getInventory(){return this.inventory}getBank(){return this.bank}getStore(){return this.store}getProfile(){return this.profile}getNotification(){return this.notification}getEnchant(){return this.enchant}getWarp(){return this.warp}getAchievements(){return this.achievements}getQuests(){return this.quests}getFriends(){return this.friends}getTrade(){return this.trade}getLeaderboards(){return this.leaderboards}getGuilds(){return this.guilds}getCrafting(){return this.crafting}getLootBag(){return this.lootBag}getWelcome(){return this.welcome}getQuest(){return this.quest}handleInventorySelect(e,t,s){this.game.socket.send(p.Container,{opcode:e,type:G.Inventory,fromIndex:t,value:s})}handleBankSelect(e,t,s,a){this.game.socket.send(p.Container,{opcode:Ne.Select,type:G.Bank,fromContainer:e,fromIndex:t,toContainer:s,value:a})}handleStoreSelect(e,t,s,a=1){this.game.socket.send(p.Store,{opcode:e,key:t,index:s,count:a})}handleProfileUnequip(e){this.game.socket.send(p.Equipment,{opcode:Be.Unequip,type:e})}handleProfileAttackStyle(e){this.game.socket.send(p.Equipment,{opcode:Be.Style,style:e})}handleProfilePickup(){this.game.socket.send(p.Pet,{opcode:Aa.Pickup})}handleAbility(e,t,s){this.game.socket.send(p.Ability,{opcode:e,key:t,index:s})}handleEnchantSelect(e){this.game.socket.send(p.Enchant,{opcode:hi.Select,index:e})}handleEnchantConfirm(e,t){this.game.socket.send(p.Enchant,{opcode:hi.Confirm,index:e,shardIndex:t})}handleWarp(e){this.game.socket.send(p.Warp,{id:e})}handleFriendConfirm(e,t=!1){this.game.socket.send(p.Friends,{opcode:t?ge.Remove:ge.Add,username:e})}handleTradeSelect(e,t,s){switch(e){case G.Inventory:return this.game.socket.send(p.Trade,{opcode:ce.Add,index:t,count:s});case G.Trade:return this.game.socket.send(p.Trade,{opcode:ce.Remove,index:t,count:s})}}handleTradeAccept(){this.game.socket.send(p.Trade,{opcode:ce.Accept})}handleTradeClose(){this.game.socket.send(p.Trade,{opcode:ce.Close})}handleCraftingSelect(e){this.game.socket.send(p.Crafting,{opcode:Lt.Select,key:e})}handleCraftingConfirm(e,t){this.game.socket.send(p.Crafting,{opcode:Lt.Craft,key:e,count:t})}handleLootBagSelect(e){this.game.socket.send(p.LootBag,{opcode:Tt.Take,index:e})}handleQuestAccept(e){this.game.socket.send(p.Quest,{key:e})}forEachMenu(e){for(let t of Object.values(this.menus))e(t)}}class Ll{constructor(e,t){this.type=e,this.instance=t,this.element.classList.add("pointer"),this.blinkInterval=window.setInterval(()=>{this.visible?m.fadeOut(this.element):m.fadeIn(this.element),this.visible=!this.visible},600)}offsetWidth=36;x=-1;y=-1;element=document.createElement("div");blinkInterval=-1;visible=!0;setPosition(e,t){this.x=e,this.y=t}destroy(){clearInterval(this.blinkInterval),this.element.remove()}reset(){this.element.style.top="",this.element.style.left="",this.element.style.right="",this.element.style.bottom="",this.element.style.transform=""}}class Ol{constructor(e,t){this.renderer=e,this.entities=t,this.camera=this.renderer.camera}camera;pointers={};bubbles=document.querySelector("#bubbles");scale=1;create(e,t,s=-1,a=-1){if(t in this.pointers)return;let n=new Ll(e,t);n.setPosition(s,a),this.pointers[t]=n,this.bubbles.append(n.element)}set(e,t,s){e.setPosition(t,s);let a=(t-this.camera.x)*this.camera.zoomFactor,n=(s-this.camera.y)*this.camera.zoomFactor-this.renderer.actualTileSize,r=a/this.renderer.canvasWidth,o=n/this.renderer.canvasHeight;e.reset();let h=`scale(${this.scale})`;if(r>=0&&r<=1&&o>=0&&o<=1){let l=e.offsetWidth-this.renderer.actualTileSize/2;e.element.style.left=`${a-l}px`,e.element.style.top=`${n}px`,e.element.style.transform=h;return}r>1?(e.element.style.right="0",e.element.style.top=o>1?"":o<0?"0":`${n}px`,e.element.style.bottom=o>1?"0":"",e.element.style.transform=`${h} rotate(-90deg)`):r<0?(e.element.style.left="0",e.element.style.top=o>1?"":o<0?"0":`${n}px`,e.element.style.bottom=o>1?"0":"",e.element.style.transform=`${h} rotate(90deg)`):o>1?(e.element.style.bottom="0",e.element.style.left=r>1?"":r<0?"0":`${a}px`,e.element.style.right=r>1?"0":"",e.element.style.transform=h):o<0&&(e.element.style.top="0",e.element.style.left=r>1?"":r<0?"0":`${a}px`,e.element.style.right=r>1?"0":"",e.element.style.transform=`${h} rotate(180deg)`)}update(){for(let e in this.pointers){let t=this.pointers[e];if(t.type===Ve.Location){this.set(t,t.x,t.y);continue}if(t.type===Ve.Entity){let s=this.entities.get(e);s?this.set(t,s.x,s.y):this.remove(e);continue}}}resize(){this.scale=this.camera.zoomFactor/rt}clean(){for(let e in this.pointers)this.remove(e)}remove(e){this.pointers[e]?.destroy(),delete this.pointers[e]}}const Rl=[{id:"player/base",width:32,height:32,offsetX:-8},{id:"player/helmet/cobalthelmet",offsetX:-8},{id:"player/helmet/ironhelmet",offsetX:-8},{id:"player/helmet/copperhelmet",offsetX:-8},{id:"player/helmet/tinhelmet",offsetX:-8},{id:"player/helmet/bronzehelmet",offsetX:-8},{id:"player/helmet/goldhelmet",offsetX:-8},{id:"player/helmet/crystalhood",offsetX:-8},{id:"player/helmet/fishbowl",offsetX:-8},{id:"player/helmet/darkmagehood",offsetX:-8},{id:"player/helmet/darkmagehoodblue",offsetX:-8},{id:"player/helmet/darkmagehoodgreen",offsetX:-8},{id:"player/helmet/darkmagehoodgold",offsetX:-8},{id:"player/helmet/pilgrimhat",offsetX:-8},{id:"player/helmet/pilgrimhatpink",offsetX:-8},{id:"player/helmet/witchhat",offsetX:-8},{id:"player/helmet/witchhatblue",offsetX:-8},{id:"player/helmet/mushroomhat",offsetX:-8},{id:"player/helmet/wizardhatblue",offsetX:-8},{id:"player/helmet/wizardhatblack",offsetX:-8},{id:"player/helmet/wizardhatcrimson",offsetX:-8},{id:"player/helmet/wizardhatdarkblue",offsetX:-8},{id:"player/helmet/wizardhatgreen",offsetX:-8},{id:"player/helmet/wizardhatpink",offsetX:-8},{id:"player/helmet/wizardhatpurple",offsetX:-8},{id:"player/helmet/wizardhatred",offsetX:-8},{id:"player/helmet/wizardhatturquoise",offsetX:-8},{id:"player/helmet/wizardhatwhite",offsetX:-8},{id:"player/helmet/wizardhatyellow",offsetX:-8},{id:"player/helmet/nighthelm",offsetX:-8},{id:"player/helmet/wolfhelmet",offsetX:-8},{id:"player/helmet/demoniccrystalhood",offsetX:-8},{id:"player/helmet/demonichelm",offsetX:-8},{id:"player/helmet/helmofhaste",offsetX:-8},{id:"player/helmet/helmofliberty",offsetX:-8},{id:"player/helmet/magmahelm",offsetX:-8},{id:"player/helmet/moonhelm",offsetX:-8},{id:"player/helmet/naturecrystalhood",offsetX:-8},{id:"player/helmet/sunshinecrystalhood",offsetX:-8},{id:"player/helmet/redmoonhelm",offsetX:-8},{id:"player/helmet/hellkeeperhelm",offsetX:-8},{id:"player/helmet/sentinelhelm",offsetX:-8},{id:"player/helmet/sapphirehelm",offsetX:-8},{id:"player/helmet/amethysthelm",offsetX:-8},{id:"player/helmet/midnightamethysthelm",offsetX:-8},{id:"player/helmet/rubyhelm",offsetX:-8},{id:"player/helmet/froghelm",offsetX:-8},{id:"player/helmet/bearhelm",offsetX:-8},{id:"player/helmet/darkskeletonhelm",offsetX:-8},{id:"player/helmet/flameblackhelmet",offsetX:-8},{id:"player/helmet/flamebluehelmet",offsetX:-8},{id:"player/helmet/flamecursehelmet",offsetX:-8},{id:"player/helmet/flamehelmet",offsetX:-8},{id:"player/helmet/jesterhat",offsetX:-8},{id:"player/helmet/oldmanmask",offsetX:-8},{id:"player/helmet/refinedsapphirehelmet",offsetX:-8},{id:"player/helmet/scholarshat",offsetX:-8},{id:"player/helmet/scholarshatblack",offsetX:-8},{id:"player/helmet/scholarshatgreen",offsetX:-8},{id:"player/helmet/scholarshatred",offsetX:-8},{id:"player/helmet/scholarshatyellow",offsetX:-8},{id:"player/helmet/skeletonhelm",offsetX:-8},{id:"player/helmet/slimehelmet",offsetX:-8},{id:"player/helmet/slimekinghelmet",offsetX:-8},{id:"player/helmet/slimekingrarehelmet",offsetX:-8},{id:"player/helmet/slimepurplehelmet",offsetX:-8},{id:"player/helmet/slimeredhelmet",offsetX:-8},{id:"player/helmet/slimetealhelmet",offsetX:-8},{id:"player/helmet/knighthelmet",offsetX:-8},{id:"player/helmet/paladinhelmet",offsetX:-8},{id:"player/helmet/samuraihelmet",offsetX:-8},{id:"player/helmet/toyhat",offsetX:-8},{id:"player/helmet/toyhatprogrammer",offsetX:-8},{id:"player/helmet/toyhatwhite",offsetX:-8},{id:"player/helmet/leatherhelmet",offsetX:-8},{id:"player/helmet/artistcrown",offsetX:-8},{id:"player/helmet/conquerorhelmet",offsetX:-8},{id:"player/helmet/elfhelmet",offsetX:-8},{id:"player/helmet/elfhelmetgrown",offsetX:-8},{id:"player/helmet/minitaurushelmet",offsetX:-8},{id:"player/helmet/scarabhelmet",offsetX:-8},{id:"player/chestplate/copperchestplate",offsetX:-8},{id:"player/chestplate/tinchestplate",offsetX:-8},{id:"player/chestplate/bronzechestplate",offsetX:-8},{id:"player/chestplate/ironchestplate",offsetX:-8},{id:"player/chestplate/goldchestplate",offsetX:-8},{id:"player/chestplate/cobaltchestplate",offsetX:-8},{id:"player/chestplate/hellkeeperchestplate",offsetX:-8},{id:"player/chestplate/sentinelchestplate",offsetX:-8},{id:"player/chestplate/nightchestplate",offsetX:-8},{id:"player/chestplate/sapphirechestplate",offsetX:-8},{id:"player/chestplate/refinedsapphirechestplate",offsetX:-8},{id:"player/chestplate/amethystchestplate",offsetX:-8},{id:"player/chestplate/midnightamethystchestplate",offsetX:-8},{id:"player/chestplate/rubychestplate",offsetX:-8},{id:"player/chestplate/paladinchestplate",offsetX:-8},{id:"player/chestplate/samuraichestplate",offsetX:-8},{id:"player/chestplate/leatherchest",offsetX:-8},{id:"player/chestplate/knightchestplate",offsetX:-8},{id:"player/chestplate/bluemysticchest",offsetX:-8},{id:"player/chestplate/conquerorchestplate",offsetX:-8},{id:"player/chestplate/greenmysticchest",offsetX:-8},{id:"player/chestplate/minitauruschest",offsetX:-8},{id:"player/chestplate/mysticchest",offsetX:-8},{id:"player/chestplate/scarabchest",offsetX:-8},{id:"player/chestplate/sentinelchestplate",offsetX:-8},{id:"player/legplates/copperlegplates",offsetX:-8},{id:"player/legplates/tinlegplates",offsetX:-8},{id:"player/legplates/bronzelegplates",offsetX:-8},{id:"player/legplates/ironlegplates",offsetX:-8},{id:"player/legplates/goldlegplates",offsetX:-8},{id:"player/legplates/cobaltlegplates",offsetX:-8},{id:"player/legplates/hellkeeperlegplates",offsetX:-8},{id:"player/legplates/sentinellegplates",offsetX:-8},{id:"player/legplates/nightlegplates",offsetX:-8},{id:"player/legplates/sapphirelegplates",offsetX:-8},{id:"player/legplates/amethystlegplates",offsetX:-8},{id:"player/legplates/midnightamethystlegplates",offsetX:-8},{id:"player/legplates/rubylegplates",offsetX:-8},{id:"player/legplates/paladinlegplates",offsetX:-8},{id:"player/legplates/samurailegplates",offsetX:-8},{id:"player/legplates/leatherleggings",offsetX:-8},{id:"player/legplates/knightlegplates",offsetX:-8},{id:"player/legplates/refinedsapphirelegplates",offsetX:-8},{id:"player/legplates/conquerorlegplates",offsetX:-8},{id:"player/legplates/minitaurslegplates",offsetX:-8},{id:"player/legplates/scarablegplates",offsetX:-8},{id:"player/cape/wings",offsetX:-8},{id:"player/cape/wingsdark",offsetX:-8},{id:"player/skin/danbo",offsetX:-8},{id:"player/skin/danboblue",offsetX:-8},{id:"player/skin/danbogreen",offsetX:-8},{id:"player/skin/danbored",offsetX:-8},{id:"player/skin/taekwondo",offsetX:-8},{id:"player/skin/skeletonskin",offsetX:-8},{id:"player/skin/darkskeletonskin",offsetX:-8},{id:"player/skin/oldmanskin",offsetX:-8},{id:"player/weapon/bronzebattleaxe",offsetY:-24},{id:"player/weapon/ironbattleaxe",offsetY:-24},{id:"player/weapon/goldbattleaxe",offsetY:-24},{id:"player/weapon/cobaltbattleaxe",offsetY:-24},{id:"player/weapon/bronzeaxe",offsetY:-24},{id:"player/weapon/ironaxe",offsetY:-24},{id:"player/weapon/goldaxe",offsetY:-24},{id:"player/weapon/cobaltaxe",offsetY:-24},{id:"player/weapon/fishingpole",offsetX:-8},{id:"player/weapon/icesword",offsetY:-24},{id:"player/weapon/coppersword",offsetY:-24},{id:"player/weapon/tinsword",offsetY:-24},{id:"player/weapon/bronzesword",offsetY:-24},{id:"player/weapon/ironsword",offsetY:-24},{id:"player/weapon/nisocsword",offsetY:-24},{id:"player/weapon/cinnabarsword",offsetY:-24},{id:"player/weapon/pytharsword",offsetY:-24},{id:"player/weapon/ibosword",offsetY:-24},{id:"player/weapon/goldsword",offsetY:-24},{id:"player/weapon/nightsword",offsetY:-24},{id:"player/weapon/sentinelsword",offsetY:-24},{id:"player/weapon/adamantitesworth",offsetY:-24},{id:"player/weapon/adeptsrapier",offsetY:-24},{id:"player/weapon/alchemistalimony",width:64,height:64,offsetX:-24,offsetY:-32},{id:"player/weapon/ancientshovel",offsetY:-24},{id:"player/weapon/ancientstaff",offsetY:-24},{id:"player/weapon/angelicblade",width:64,height:64,offsetX:-24,offsetY:-32},{id:"player/weapon/berserkerssanity",offsetY:-24},{id:"player/weapon/bident",offsetY:-24},{id:"player/weapon/bladeofdarkness",offsetY:-24},{id:"player/weapon/bloodmoonstaff",offsetY:-24},{id:"player/weapon/bluelightsaber",offsetY:-24},{id:"player/weapon/bluemoonstaff",offsetY:-24},{id:"player/weapon/bonebonker",offsetY:-24},{id:"player/weapon/brutishblade",offsetY:-24},{id:"player/weapon/cellobello",width:64,height:64,offsetX:-24,offsetY:-32},{id:"player/weapon/club",offsetY:-24},{id:"player/weapon/demonicstaff",offsetY:-24},{id:"player/weapon/dragonscale",offsetY:-24},{id:"player/weapon/etherialblade",width:64,height:64,offsetX:-24,offsetY:-32},{id:"player/weapon/executionershammer",offsetY:-24},{id:"player/weapon/eyesword",offsetY:-24},{id:"player/weapon/firesword",offsetY:-24},{id:"player/weapon/golemsmace",offsetY:-24},{id:"player/weapon/goldgolemsmace",offsetY:-24},{id:"player/weapon/greenlightsaber",offsetY:-24},{id:"player/weapon/hellhoundfang",offsetY:-24},{id:"player/weapon/hellsword",offsetY:-24},{id:"player/weapon/lolipop",offsetY:-24},{id:"player/weapon/moongreataxe",offsetY:-24},{id:"player/weapon/oldonesblade",width:64,height:64,offsetX:-24,offsetY:-32},{id:"player/weapon/peddlepounder",offsetY:-24},{id:"player/weapon/pinklightsaber",offsetY:-24},{id:"player/weapon/redlightsaber",offsetY:-24},{id:"player/weapon/royalrapier",offsetY:-24},{id:"player/weapon/scimitar",width:64,height:64,offsetX:-24,offsetY:-32},{id:"player/weapon/smithshammer",offsetY:-24},{id:"player/weapon/spoon",offsetY:-24},{id:"player/weapon/sunrisegreataxe",offsetY:-24},{id:"player/weapon/sunshinestaff",offsetY:-24},{id:"player/weapon/swashbuckler",offsetY:-24},{id:"player/weapon/swordofliberty",offsetY:-24},{id:"player/weapon/sycophant",offsetY:-24},{id:"player/weapon/timelessglaive",offsetY:-24},{id:"player/weapon/twilightgreataxe",offsetY:-24},{id:"player/weapon/witchsstaffancient",offsetY:-24},{id:"player/weapon/witchsstaffblood",offsetY:-24},{id:"player/weapon/witchsstaffdemonic",offsetY:-24},{id:"player/weapon/witchsstaffmoon",offsetY:-24},{id:"player/weapon/witchsstaffsunshine",offsetY:-24},{id:"player/weapon/zweipiercer",offsetY:-24},{id:"player/weapon/aquastaff",offsetY:-20},{id:"player/weapon/lightningstaff",offsetY:-20},{id:"player/weapon/naturestaff",offsetY:-20},{id:"player/weapon/firestaff",offsetY:-20},{id:"player/weapon/cursestaff",offsetY:-20},{id:"player/weapon/magichamberge",offsetY:-22},{id:"player/weapon/bronzescythe",offsetX:-12},{id:"player/weapon/ironscythe",offsetX:-12},{id:"player/weapon/goldscythe",offsetX:-12},{id:"player/weapon/cobaltscythe",offsetX:-12},{id:"player/weapon/bronzespear",offsetX:-12},{id:"player/weapon/ironspear",offsetX:-12},{id:"player/weapon/goldspear",offsetX:-12},{id:"player/weapon/cobaltspear",offsetX:-12},{id:"player/weapon/gun",offsetX:-16,offsetY:-22},{id:"player/weapon/balloonyellow",offsetY:-24},{id:"player/weapon/balloonblue",offsetY:-24},{id:"player/weapon/balloongreen",offsetY:-24},{id:"player/weapon/balloonpink",offsetY:-24},{id:"player/weapon/balloonturquoise",offsetY:-24},{id:"player/weapon/balloonwhite",offsetY:-24},{id:"player/weapon/woodenbow",offsetX:-8,offsetY:-32},{id:"player/weapon/bowbamboo",offsetX:-8,offsetY:-32},{id:"player/weapon/bowdeuteranom",offsetX:-8,offsetY:-32},{id:"player/weapon/boweggplant",offsetX:-8,offsetY:-32},{id:"player/weapon/bowfleshflinger",offsetX:-8,offsetY:-32},{id:"player/weapon/bowiceicemaybe",offsetX:-8,offsetY:-32},{id:"player/weapon/bowillmuscal",offsetX:-8,offsetY:-32},{id:"player/weapon/bowkelpysburden",offsetX:-8,offsetY:-32},{id:"player/weapon/bowmagiccool",offsetX:-8,offsetY:-32},{id:"player/weapon/bowmagichot",offsetX:-8,offsetY:-32},{id:"player/weapon/bowmoon",offsetX:-8,offsetY:-32},{id:"player/weapon/bowocean",offsetX:-8,offsetY:-32},{id:"player/weapon/bowpine",offsetX:-8,offsetY:-32},{id:"player/weapon/bowsky",offsetX:-8,offsetY:-32},{id:"player/weapon/bowsun",offsetX:-8,offsetY:-32},{id:"player/weapon/bowswineslayer",offsetX:-8,offsetY:-32},{id:"player/weapon/bowwillowtwine",offsetX:-8,offsetY:-32},{id:"player/weapon/bronzepickaxe",offsetY:-24},{id:"player/weapon/ironpickaxe",offsetY:-24},{id:"player/weapon/goldpickaxe",offsetY:-24},{id:"player/weapon/cobaltpickaxe",offsetY:-24},{id:"player/weapon/bonepickaxe",offsetY:-24},{id:"player/weapon/cursedbattleaxe",offsetY:-24},{id:"player/weapon/cursedpickaxe",offsetY:-24},{id:"player/weapon/cursedsapphirepickaxe",offsetY:-24},{id:"player/weapon/heavyberylpickaxe",offsetY:-24},{id:"player/shield/lantern",offsetY:-20},{id:"player/shield/lantern2",offsetY:-21},{id:"player/shield/lanternarcan",offsetY:-24},{id:"player/shield/coppershield",offsetY:-24},{id:"player/shield/tinshield",offsetY:-24},{id:"player/shield/cobaltshield",offsetY:-24},{id:"player/shield/goldshield",offsetY:-24},{id:"player/shield/ironroundshield",offsetY:-24},{id:"player/shield/woodenshield",offsetY:-24},{id:"player/shield/ironshield",offsetY:-24},{id:"player/shield/shieldofliberty",offsetY:-24},{id:"player/shield/shieldofglory",width:32,height:32,offsetX:-8},{id:"crowns/artist",preload:!0},{id:"crowns/tier1",preload:!0},{id:"crowns/tier2",preload:!0},{id:"crowns/tier3",preload:!0},{id:"crowns/tier4",preload:!0},{id:"crowns/tier5",preload:!0},{id:"crowns/tier6",preload:!0},{id:"crowns/tier7",preload:!0,width:17},{id:"crowns/bronzemedal",preload:!0,width:12,height:12},{id:"crowns/goldmedal",preload:!0,width:12,height:12},{id:"crowns/silvermedal",preload:!0,width:12,height:12},{id:"cursors/hand",width:14,height:14},{id:"cursors/axe",width:14,height:14},{id:"cursors/pickaxe",width:14,height:14},{id:"cursors/sword",width:14,height:14},{id:"cursors/loot",width:14,height:14},{id:"cursors/talk",width:14,height:14},{id:"cursors/bow"},{id:"cursors/cooking"},{id:"cursors/smithing"},{id:"cursors/smelting"},{id:"cursors/crafting"},{id:"cursors/foraging"},{id:"cursors/fishing"},{id:"cursors/spell"},{id:"skills/accuracy",width:16,height:16},{id:"skills/alchemy",width:16,height:16},{id:"skills/archery",width:16,height:16},{id:"skills/chiseling",width:16,height:16},{id:"skills/chiseling2",width:16,height:16},{id:"skills/cooking",width:16,height:16},{id:"skills/crafting",width:16,height:16},{id:"skills/defense",width:16,height:16},{id:"skills/eating",width:16,height:16},{id:"skills/fishing",width:16,height:16},{id:"skills/fletching",width:16,height:16},{id:"skills/foraging",width:16,height:16},{id:"skills/health",width:16,height:16},{id:"skills/loitering",width:16,height:16},{id:"skills/lumberjacking",width:16,height:16},{id:"skills/magic",width:16,height:16},{id:"skills/mining",width:16,height:16},{id:"skills/smelting",width:16,height:16},{id:"skills/smithing",width:16,height:16},{id:"skills/strength",width:16,height:16},{id:"npcs/agent",width:32,height:32},{id:"npcs/superiorangelnpc",width:32,height:32},{id:"npcs/sponge",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/snowshepherdboy",width:32,height:32},{id:"npcs/secondsonangelnpc",width:32,height:32},{id:"npcs/shepherdboy",width:32,height:32},{id:"npcs/scientist",width:32,height:32},{id:"npcs/madscientist",width:32,height:32},{id:"npcs/redstoremannpc",width:32,height:32},{id:"npcs/purplestoremannpc",width:32,height:32},{id:"npcs/greenstoremannpc",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/redbikinigirlnpc",width:32,height:32},{id:"npcs/priest",width:32,height:32},{id:"npcs/pirategirlnpc",width:32,height:32},{id:"npcs/momangelnpc",width:32,height:32},{id:"npcs/nyan",width:49,height:24,offsetX:-22,offsetY:-6},{id:"npcs/octocat",width:32,height:32,offsetX:-8,offsetY:-12},{id:"npcs/octopus",width:32,height:32},{id:"npcs/oddeyecat",width:32,height:32},{id:"npcs/mojojojonpc",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/mermaidnpc",width:32,height:32},{id:"npcs/forestnpc",width:32,height:32},{id:"npcs/firstsonangelnpc",width:32,height:32},{id:"npcs/fisherman",width:32,height:32},{id:"npcs/fairynpc",width:32,height:32},{id:"npcs/fairynpc2",width:32,height:32},{id:"npcs/elfnpc",width:32,height:32},{id:"npcs/doctor",width:32,height:32},{id:"npcs/desertnpc",width:32,height:32},{id:"npcs/coder",width:32,height:32},{id:"npcs/bluestoremannpc",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/boxingman",width:32,height:32},{id:"npcs/beachnpc",width:32,height:32},{id:"npcs/bluebikinigirlnpc",width:32,height:32},{id:"npcs/guard",width:32,height:32},{id:"npcs/guard2",width:32,height:32},{id:"npcs/redbikinigirlnpc",width:32,height:32},{id:"npcs/royalguard",width:25,height:24,offsetX:-5,offsetY:-8},{id:"npcs/royalguard2",width:32,height:32,offsetX:-4,offsetY:-20},{id:"npcs/royalguard3",width:32,height:32,offsetX:-12,offsetY:-20},{id:"npcs/iamverycoldnpc",width:32,height:32},{id:"npcs/ancientmanumentnpc",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/oldlady",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/oldlady2",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/iceelfnpc",width:32,height:32},{id:"npcs/guildnpc",width:32,height:32},{id:"npcs/picklenpc",height:24,offsetX:-2,offsetY:-8},{id:"npcs/santaelfnpc",width:32,height:32},{id:"npcs/king",width:32,height:32},{id:"npcs/king2",width:32,height:32},{id:"npcs/lavanpc",width:32,height:32},{id:"npcs/soldier",width:32,height:32},{id:"npcs/vampire",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/vendingmachine",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/villagegirl",width:32,height:32},{id:"npcs/villagegirl2",width:32,height:32},{id:"npcs/villagegirl3",width:32,height:32},{id:"npcs/villagegirl4",width:32,height:32},{id:"npcs/villagegirl5",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/villagegirl6",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/villagegirl7",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/villager",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/villager2",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/villager3",width:32,height:32},{id:"npcs/villager4",width:32,height:32},{id:"npcs/prisoner",width:32,height:32},{id:"npcs/miner",width:32,height:32},{id:"npcs/miner2",width:32,height:32},{id:"npcs/zombiegf",width:24,height:24,offsetX:-4,offsetY:-8},{id:"npcs/angelnpc",width:32,height:32},{id:"npcs/rick",width:32,height:32},{id:"npcs/rickgf",width:32,height:32},{id:"npcs/sorcerer",width:32,height:32},{id:"npcs/ratnpc",width:32,height:32,animations:{idle_down:{length:4,row:0}},offsetX:-8,offsetY:-10},{id:"npcs/blacksmith",width:32,height:36,idleSpeed:200,animations:{idle_down:{length:5,row:0}},offsetX:-6,offsetY:-20},{id:"npcs/blacksmith2",width:48,height:48,idleSpeed:130,animations:{idle_down:{length:7,row:0}},offsetX:-10,offsetY:-24},{id:"npcs/herbalist",width:34,height:34,animations:{idle_down:{length:4,row:0}}},{id:"pets/rat",width:48,height:48,animations:{death:{length:4,row:0},walk_right:{length:3,row:2},idle_right:{length:2,row:3},walk_up:{length:4,row:5},idle_up:{length:4,row:6},walk_down:{length:4,row:8},idle_down:{length:4,row:9}}},{id:"pets/rathat",width:48,height:48,idleSpeed:250,animations:{death:{length:4,row:0},walk_right:{length:3,row:2},idle_right:{length:2,row:3},walk_up:{length:4,row:5},idle_up:{length:4,row:6},walk_down:{length:4,row:8},idle_down:{length:4,row:9}}},{id:"pets/ratballoon",width:48,height:48,idleSpeed:250,animations:{walk_right:{length:4,row:0},idle_right:{length:4,row:1},walk_up:{length:4,row:2},idle_up:{length:4,row:3},walk_down:{length:4,row:4},idle_down:{length:4,row:5}},offsetY:-24},{id:"effectentity/fire",width:16,height:16,animations:{idle:{length:8,row:0}},offsetX:-4,offsetY:-4},{id:"mobs/angel",width:32,height:32,offsetX:-8,offsetY:-13},{id:"mobs/card",width:32,height:32,offsetX:-8,offsetY:-13},{id:"mobs/card2",width:32,height:32,offsetX:-8,offsetY:-13},{id:"mobs/snowman2",width:32,height:32,offsetX:-8,offsetY:-13},{id:"mobs/rabbitman",width:32,height:32,offsetX:-8,offsetY:-13},{id:"mobs/cowwarrior",width:42,height:42,offsetX:-13,offsetY:-18},{id:"mobs/rooster",width:42,height:42,offsetX:-13,offsetY:-18},{id:"mobs/adherer",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/goldgolem",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-24},{id:"mobs/ant",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-28},{id:"mobs/babyspider",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"mobs/bat",idleSpeed:100,width:32,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offsetX:-8,offsetY:-24},{id:"mobs/icebat",idleSpeed:100,width:32,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offsetX:-8,offsetY:-24},{id:"mobs/beetle",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-24,offsetY:-54},{id:"mobs/blackpirateskeleton",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-15},{id:"mobs/blackwizard",width:48,height:48,offsetY:-22},{id:"mobs/icewizard",width:48,height:48,offsetY:-22},{id:"mobs/ancientwizard",width:48,height:48,offsetY:-22},{id:"mobs/blazespider",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-22},{id:"mobs/greencockroach",width:42,height:42,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:3,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:3,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-20},{id:"mobs/bluepreta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/brownmouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"effects/bucklerbenef",width:32,height:32,animations:{atk_right:{length:10,row:0},walk_right:{length:10,row:0},idle_right:{length:10,row:0},atk_up:{length:10,row:0},walk_up:{length:10,row:0},idle_up:{length:10,row:0},atk_down:{length:10,row:0},walk_down:{length:10,row:0},idle_down:{length:10,row:0}},offsetX:-9,offsetY:-32},{id:"mobs/paladin",width:32,height:32,offsetX:-5,offsetY:-8},{id:"mobs/cactus",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:3,row:1},idle_right:{length:1,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:1,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:1,row:8}},offsetY:-28},{id:"mobs/cat",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:4,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:4,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:4,row:8}},offsetY:-25},{id:"objects/chest",animations:{idle_down:{length:1,row:0}},offsetX:0,offsetY:0},{id:"objects/seachest",animations:{idle_down:{length:1,row:0}},offsetX:0,offsetY:0},{id:"trees/spruce",width:64,height:80,animations:{idle:{length:1,row:0},shake:{length:5,row:1},exhausted:{length:1,row:2}},offsetX:-24,offsetY:-56},{id:"trees/oak",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/tutorialoak",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/oak2",width:48,height:80,offsetX:-16,offsetY:-58},{id:"trees/oak3",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/oak4",width:48,height:80,offsetX:-16,offsetY:-56},{id:"trees/oak5",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/oak6",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/oak7",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/bloodwood",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/inibti",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/puhrix",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/flastel",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/iceoak",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/iceoak4",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/iceoak5",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/iceoak6",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/palm",width:48,height:64,offsetX:-16,offsetY:-40},{id:"trees/icepalm",width:48,height:64,offsetX:-16,offsetY:-40},{id:"trees/snowoak",width:80,height:96,offsetX:-36,offsetY:-64},{id:"trees/pine",width:48,height:64,offsetX:-18,offsetY:-48},{id:"trees/zoncil",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/zondul",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/heliphatit",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/aquasillius",width:80,height:96,offsetX:-32,offsetY:-64},{id:"trees/alkythn",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/iceoak2",width:64,height:96,offsetX:-24,offsetY:-64},{id:"trees/iceoak3",width:64,height:96,offsetX:-24,offsetY:-64},{id:"rocks/amethystrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/berylrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/cinnabarrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/citrinerock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/coalrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/copperrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/emeraldrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/goldrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/iborock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/ironrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/lapislazulirock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/moonrockrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/nisocrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/opalrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/peridotrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/pytharrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/rubyrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/taaffeiterock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/tinrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"rocks/topazrock",width:24,height:24,offsetX:-4,offsetY:-4},{id:"fishspots/clamspot",width:16,height:16,offsetX:0,offsetY:0},{id:"fishspots/jellyfishspot",width:16,height:16,offsetX:0,offsetY:0},{id:"fishspots/shrimpspot",width:16,height:16,offsetX:0,offsetY:0},{id:"fishspots/tutorialshrimpspot",width:16,height:16,offsetX:0,offsetY:0},{id:"fishspots/tunaspot",width:16,height:16,offsetX:0,offsetY:0},{id:"bushes/blueberrybush",width:24,height:24,offsetX:-4,offsetY:-4},{id:"bushes/raspberrybush",width:24,height:24,offsetX:-4,offsetY:-4},{id:"bushes/blackberrybush",width:24,height:24,offsetX:-4,offsetY:-4},{id:"bushes/bluelilybush",width:32,height:48,offsetX:-6,offsetY:-24},{id:"bushes/cornbush",width:24,height:36,offsetX:-2,offsetY:-20},{id:"bushes/cuminbush",width:32,height:32,offsetX:-6,offsetY:-6},{id:"bushes/treestump1",width:32,height:32,offsetX:-8,offsetY:-8},{id:"bushes/mustardbush",width:24,height:24,offsetX:-4,offsetY:-4},{id:"bushes/paprikabush",width:32,height:32,offsetX:-6,offsetY:-6},{id:"bushes/peachbush",width:24,height:32,offsetX:-4,offsetY:-16},{id:"bushes/tomatobush",width:24,height:32,offsetX:-4,offsetY:-16},{id:"mobs/clam",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:3,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/picklemob",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/ghost",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/cobra",width:28,height:28,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:6,row:8}},offsetX:-6,offsetY:-10},{id:"mobs/crab",width:32,height:32,idleSpeed:300,animations:{death:{length:8,row:0},atk_right:{length:7,row:1},walk_right:{length:6,row:2},idle_right:{length:4,row:3},atk_up:{length:8,row:4},idle_up:{length:4,row:5},walk_up:{length:6,row:6},atk_down:{length:8,row:7},walk_down:{length:6,row:8},idle_down:{length:7,row:9}},offsetX:-8,offsetY:-8},{id:"mobs/icecrab",width:32,height:32,idleSpeed:300,animations:{death:{length:8,row:0},atk_right:{length:7,row:1},walk_right:{length:6,row:2},idle_right:{length:4,row:3},atk_up:{length:8,row:4},idle_up:{length:4,row:5},walk_up:{length:6,row:6},atk_down:{length:8,row:7},walk_down:{length:6,row:8},idle_down:{length:7,row:9}},offsetX:-8,offsetY:-8},{id:"effects/critical",width:48,height:48,animations:{effect:{length:10,row:0}},offsetX:-17,offsetY:-21},{id:"mobs/crystalscorpion",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-24,offsetY:-32},{id:"mobs/cursedhahoemask",width:64,height:72,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-21,offsetY:-49},{id:"mobs/cursedjangseung",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetY:-30},{id:"mobs/darkogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/darkregionillusion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/darkregion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/darkscorpion",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-24,offsetY:-32},{id:"mobs/darkskeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetY:-22},{id:"mobs/deathknight",width:42,height:42,offsetX:-13,offsetY:-17},{id:"mobs/desertscorpion",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-24,offsetY:-32},{id:"mobs/devilkazya",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/earthworm",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetY:-22},{id:"mobs/eliminator",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/enel",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/eye",width:40,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:14,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:14,row:5},atk_down:{length:8,row:6},walk_down:{length:4,row:7},idle_down:{length:14,row:8}},offsetX:-12,offsetY:-18},{id:"mobs/firespider",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-22},{id:"effects/flaredance",width:48,height:48,animations:{effect:{length:4,row:0}},offsetX:-17,offsetY:-21},{id:"effects/feathers",width:48,height:48,animations:{effect:{length:7,row:0}},offsetX:-17,offsetY:-21},{id:"mobs/flaredeathknight",width:42,height:42,offsetX:-13,offsetY:-17},{id:"mobs/fluffy",width:28,height:32,animations:{death:{length:1,row:8},atk_right:{length:4,row:7},walk_right:{length:6,row:3},idle_right:{length:1,row:3},atk_up:{length:4,row:6},idle_up:{length:1,row:2},walk_up:{length:6,row:2},atk_down:{length:4,row:4},walk_down:{length:6,row:0},idle_down:{length:1,row:0}},offsetX:-8,offsetY:-8},{id:"mobs/forestdragon",width:64,height:72,animations:{atk_right:{length:7,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:7,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:7,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-30,offsetY:-30},{id:"mobs/frog",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/frostqueen",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetY:-22},{id:"mobs/ghostrider",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/goblin",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-9},{id:"pointer",width:32,height:32},{id:"mobs/golem",width:32,height:32,offsetX:-8,offsetY:-17},{id:"mobs/greenfish",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/greenpirateskeleton",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-15},{id:"mobs/guardmace",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/guardsword",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/hellspider",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-33},{id:"mobs/hermitcrab",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-8,offsetY:-10},{id:"mobs/hobgoblin",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"mobs/hongcheol",width:32,height:32,offsetX:-8,offsetY:-15},{id:"mobs/icegolem",width:32,height:32,offsetX:-5,offsetY:-12},{id:"mobs/iceknight",width:42,height:42,offsetX:-13,offsetY:-17},{id:"mobs/icevulture",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/infectedguard",width:32,height:32,offsetX:-7,offsetY:-13},{id:"mobs/ironogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-16},{id:"mobs/lightningguardian",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-49},{id:"mobs/jirisanmoonbear",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-26},{id:"mobs/kaonashi",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-22},{id:"mobs/windguardian",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-49},{id:"mobs/livingarmor",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"mobs/mantis",width:42,height:42,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-21},{id:"mobs/mermaid",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/mimic",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:1,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:1,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:1,row:8}},offsetX:-8,offsetY:-11},{id:"mobs/minidragon",width:32,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-8,offsetY:-22},{id:"mobs/miniemperor",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"mobs/miniiceknight1",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniiceknight2",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniiceknight3",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniiceknight4",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniiceknight5",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniknight1",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniknight2",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniknight3",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniknight4",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniknight5",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniknight6",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/miniseadragon",width:32,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-8,offsetY:-22},{id:"mobs/moleking",width:32,height:32,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/nightmareregion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/ogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-24},{id:"mobs/ogrelord",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/hellhound",width:64,height:72,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetY:-48},{id:"mobs/oldogre",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/orc",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/infectedvillager",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/penguin",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/pierrot",width:32,height:32,offsetX:-5,offsetY:-13},{id:"mobs/pinkelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"mobs/piratecaptain",width:64,height:64,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-36},{id:"mobs/pirateking",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/pirateskeleton",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/poisonspider",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-22},{id:"mobs/preta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"effects/provocation",width:32,height:64,animations:{effect:{length:10,row:0}},offsetX:-8,offsetY:-42},{id:"mobs/purplepreta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/queenant",width:64,height:72,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-54},{id:"mobs/queenspider",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/rat",width:32,height:32,idleSpeed:250,animations:{death:{length:4,row:0},atk_right:{length:6,row:1},walk_right:{length:3,row:2},idle_right:{length:2,row:3},atk_up:{length:4,row:4},walk_up:{length:4,row:5},idle_up:{length:4,row:6},atk_down:{length:4,row:7},walk_down:{length:4,row:8},idle_down:{length:4,row:9}},offsetX:-8,offsetY:-8},{id:"mobs/icerat",width:32,height:32,idleSpeed:200,animations:{death:{length:4,row:0},atk_right:{length:6,row:1},walk_right:{length:3,row:2},idle_right:{length:2,row:3},atk_up:{length:4,row:4},walk_up:{length:4,row:5},idle_up:{length:4,row:6},atk_down:{length:4,row:7},walk_down:{length:4,row:8},idle_down:{length:4,row:9}},offsetX:-8,offsetY:-8},{id:"mobs/redcockroach",width:42,height:42,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:3,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:3,row:7},idle_down:{length:2,row:8}},offsetX:-14,offsetY:-21},{id:"mobs/redelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"mobs/redfish",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/redguard",width:32,height:32,offsetX:-4,offsetY:-8},{id:"mobs/redmouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"mobs/redpirateskeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetY:-23},{id:"mobs/regionhenchman",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:5,row:7},idle_down:{length:2,row:8}},offsetX:-24,offsetY:-39},{id:"mobs/rhaphidophoridae",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-22},{id:"mobs/rudolf",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/santaelf",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/santa",width:64,height:72,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetX:-24,offsetY:-55},{id:"mobs/seadragon",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-39},{id:"mobs/shadowregion",width:42,height:42,offsetX:-14,offsetY:-21},{id:"effects/shieldbenef",width:32,height:30,animations:{atk_right:{length:8,row:0},walk_right:{length:8,row:0},idle_right:{length:8,row:0},atk_up:{length:8,row:0},walk_up:{length:8,row:0},idle_up:{length:8,row:0},atk_down:{length:8,row:0},walk_down:{length:8,row:0},idle_down:{length:8,row:0}},offsetX:-6,offsetY:-10},{id:"mobs/skeleton2",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetY:-20},{id:"mobs/skeleton",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetY:-20},{id:"mobs/skeletonking",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:3,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-36},{id:"mobs/skydinosaur",width:64,height:72,animations:{atk_right:{length:6,row:0},walk_right:{length:5,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-49},{id:"mobs/skyelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"mobs/slime",width:32,height:32,offsetX:-6,offsetY:-12},{id:"mobs/lavaslime",width:32,height:32,animations:{atk_right:{length:4,row:1},walk_right:{length:4,row:0},idle_right:{length:4,row:0},atk_up:{length:4,row:1},walk_up:{length:4,row:0},idle_up:{length:4,row:0},atk_down:{length:4,row:1},walk_down:{length:4,row:0},idle_down:{length:4,row:0}},offsetX:-7,offsetY:-13},{id:"mobs/smalldevil",width:42,height:42,animations:{atk_right:{length:4,row:0},walk_right:{length:2,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:2,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:2,row:7},idle_down:{length:2,row:8}},offsetX:-14},{id:"mobs/snek",width:28,height:28,animations:{atk_right:{length:5,row:0},walk_right:{length:4,row:1},idle_right:{length:4,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:6,row:8}},offsetX:-6,offsetY:-10},{id:"mobs/snowelf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-12},{id:"mobs/snowlady",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/snowman",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/snowrabbit",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/snowwolf",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/soldierant",width:48,height:48,animations:{atk_right:{length:4,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:4,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-27},{id:"mobs/soybeanbug",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-30},{id:"mobs/spectre",width:34,height:34,animations:{atk_right:{length:8,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:8,row:4},idle_up:{length:8,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-9,offsetY:-13},{id:"mobs/spider",width:35,height:35,animations:{death:{length:1,row:8},atk_right:{length:2,row:7},walk_right:{length:5,row:3},idle_right:{length:1,row:3},atk_up:{length:2,row:6},idle_up:{length:1,row:2},walk_up:{length:5,row:2},atk_down:{length:2,row:4},walk_down:{length:5,row:0},idle_down:{length:1,row:0}},offsetX:-8,offsetY:-8},{id:"mobs/squid",width:48,height:48,animations:{atk_right:{length:5,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-30},{id:"effects/stun",width:48,height:48,animations:{effect:{length:6,row:0}},offsetX:-15,offsetY:-38},{id:"mobs/suicideghost",width:48,height:48,animations:{atk_right:{length:6,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:6,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:6,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetY:-30},{id:"effects/supercat",width:32,height:64,animations:{effect:{length:10,row:0}},offsetX:-8,offsetY:-42},{id:"target",animations:{move:{length:4,row:0},atk:{length:4,row:1},info:{length:4,row:2}}},{id:"mobs/vulture",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:5,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-25},{id:"mobs/whitebear",width:48,height:48,animations:{atk_right:{length:3,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:6,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:6,row:7},idle_down:{length:2,row:8}},offsetY:-22},{id:"mobs/whitemouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"mobs/whitetiger",width:64,height:72,animations:{atk_right:{length:5,row:0},walk_right:{length:6,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:6,row:4},idle_up:{length:4,row:5},atk_down:{length:5,row:6},walk_down:{length:6,row:7},idle_down:{length:4,row:8},"Group 5":{length:3,row:9}},offsetX:-24,offsetY:-54},{id:"mobs/wizard",width:26,height:26,animations:{death:{length:3,row:0},atk_right:{length:4,row:1},atk_up:{length:4,row:2},atk_down:{length:4,row:3},walk_right:{length:4,row:4},walk_up:{length:4,row:5},walk_down:{length:4,row:6},idle_right:{length:6,row:7},idle_up:{length:6,row:8},idle_down:{length:6,row:9}},offsetX:-5,offsetY:-9},{id:"mobs/darkwolf",width:42,height:42,offsetX:-14,offsetY:-21},{id:"mobs/wolf",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:3,row:2},atk_up:{length:4,row:3},walk_up:{length:4,row:4},idle_up:{length:3,row:5},atk_down:{length:4,row:6},walk_down:{length:4,row:7},idle_down:{length:3,row:8}},offsetX:-8,offsetY:-13},{id:"mobs/yellowbat",width:32,height:48,idleSpeed:100,animations:{atk_right:{length:5,row:0},walk_right:{length:5,row:1},idle_right:{length:5,row:2},atk_up:{length:5,row:3},walk_up:{length:5,row:4},idle_up:{length:5,row:5},atk_down:{length:5,row:6},walk_down:{length:5,row:7},idle_down:{length:5,row:8}},offsetX:-8,offsetY:-24},{id:"mobs/yellowfish",width:32,height:32,offsetX:-8,offsetY:-12},{id:"mobs/yellowmouse",width:26,height:26,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-5,offsetY:-8},{id:"mobs/yellowpreta",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:4,row:3},walk_up:{length:3,row:4},idle_up:{length:4,row:5},atk_down:{length:4,row:6},walk_down:{length:3,row:7},idle_down:{length:4,row:8}},offsetX:-5,offsetY:-13},{id:"mobs/zombie",width:32,height:32,animations:{atk_right:{length:4,row:0},walk_right:{length:4,row:1},idle_right:{length:2,row:2},atk_up:{length:5,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:5,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-8,offsetY:-13},{id:"projectiles/fireball",idleSpeed:75,width:48,height:48,animations:{travel:{length:8,row:0}},offsetX:-24,offsetY:-24},{id:"projectiles/fireball2",idleSpeed:75,width:48,height:48,animations:{travel:{length:8,row:0}},offsetX:-24,offsetY:-24},{id:"projectiles/iceball",idleSpeed:75,width:48,height:48,animations:{travel:{length:8,row:0}},offsetX:-24,offsetY:-24},{id:"projectiles/bluelightning",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/redlightning",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/greenbolt",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/purplebolt",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/yellowlightning",width:50,height:50,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/poisonball",width:50,height:48,animations:{travel:{length:10,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/bloodball",width:50,height:48,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/lightningarc",width:50,height:48,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/firearc",width:50,height:48,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/shadowarc",width:50,height:48,animations:{travel:{length:8,row:0}},offsetX:-18,offsetY:-17},{id:"projectiles/boulder",idleSpeed:75,width:32,height:32,animations:{travel:{length:8,row:0}}},{id:"projectiles/arrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/firearrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-16,offsetY:-8},{id:"projectiles/poisonarrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/icearrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/lightningarrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/nisocarrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/cinnabararrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/pythararrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/iboarrow",idleSpeed:75,animations:{travel:{length:4,row:0}},offsetX:-12,offsetY:-12},{id:"projectiles/none",idleSpeed:75,width:64,height:64,animations:{travel:{length:1,row:0}},offsetX:-32,offsetY:-32},{id:"projectiles/tornado",idleSpeed:75,width:48,height:64,animations:{travel:{length:8,row:0}},offsetX:-29,offsetY:-37},{id:"projectiles/terror",idleSpeed:75,width:64,height:64,animations:{travel:{length:8,row:0}},offsetX:-32,offsetY:-32},{id:"projectiles/gift",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetY:-24},{id:"projectiles/gift2",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetY:-24},{id:"projectiles/gift3",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetY:-24},{id:"projectiles/gift4",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetY:-24},{id:"projectiles/gift5",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetY:-24},{id:"projectiles/gift6",idleSpeed:75,width:32,height:32,animations:{travel:{length:4,row:0}},offsetY:-24},{id:"effects/fireball",width:48,height:48,animations:{effect:{length:8,row:0}},offsetX:-17},{id:"effects/poisonball",width:40,height:40,animations:{effect:{length:10,row:0}},offsetX:-13,offsetY:-14},{id:"effects/burn",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/freeze",width:32,height:32,animations:{effect:{length:6,row:0}},offsetX:-8},{id:"effects/lavaball",width:48,height:48,animations:{effect:{length:8,row:0}},offsetY:-24},{id:"effects/heal",width:48,height:48,animations:{effect:{length:8,row:0}}},{id:"effects/iceball",width:48,height:48,animations:{effect:{length:9,row:0}},offsetX:-18,offsetY:-15},{id:"effects/lightningexplosion",width:50,height:48,animations:{effect:{length:8,row:0}},offsetX:-18,offsetY:-15},{id:"effects/boulder",animations:{effect:{length:7,row:0}},offsetX:-9,offsetY:-12},{id:"effects/terror",width:64,height:64,animations:{effect:{length:8,row:0}},offsetX:-24,offsetY:-32},{id:"effects/terror2",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/heal2",animations:{effect:{length:10,row:0}},offsetX:-8,offsetY:-10},{id:"effects/attack",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/strength",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/defense",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/magic",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/archery",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/attacksuper",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/strengthsuper",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/defensesuper",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/magicsuper",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/archerysuper",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"effects/bleed",width:32,height:32,animations:{effect:{length:5,row:0}},offsetX:-8},{id:"mobs/icegoblin",width:32,height:32,animations:{atk_right:{length:3,row:0},walk_right:{length:3,row:1},idle_right:{length:2,row:2},atk_up:{length:3,row:3},walk_up:{length:4,row:4},idle_up:{length:2,row:5},atk_down:{length:3,row:6},walk_down:{length:4,row:7},idle_down:{length:2,row:8}},offsetX:-7,offsetY:-13},{id:"death",width:24,height:24,preload:!0,animations:{death:{length:6,row:0}},offsetX:-4,offsetY:-4},{id:"shadow",preload:!0},{id:"sparks",preload:!0,animations:{idle_down:{length:6,row:0}},offsetX:0,offsetY:0},{id:"exclamation",idleSpeed:360,animations:{idle_down:{length:2,row:0}},preload:!0,offsetY:-24},{id:"exclamationblue",idleSpeed:360,animations:{idle_down:{length:2,row:0}},preload:!0,offsetY:-24},{id:"items/accuracypotion"},{id:"items/adamantitesworth"},{id:"items/adeptsrapier"},{id:"items/alchemistalimony"},{id:"items/alkythnlogs"},{id:"items/amethyst"},{id:"items/amethystboots"},{id:"items/amethystchestplate"},{id:"items/amethysthelm"},{id:"items/amethystlegplates"},{id:"items/ancientshovel"},{id:"items/ancientstaff"},{id:"items/angelicblade"},{id:"items/apple"},{id:"items/aquasilliuslogs"},{id:"items/aquastaff"},{id:"items/arcanahypercube"},{id:"items/arrow"},{id:"items/ashworm"},{id:"items/avocado"},{id:"items/balloonblue"},{id:"items/balloongreen"},{id:"items/balloonpink"},{id:"items/balloonturquoise"},{id:"items/balloonwhite"},{id:"items/balloonyellow"},{id:"items/banana"},{id:"items/barley"},{id:"items/basil"},{id:"items/basilbowlmedium"},{id:"items/basilpowder"},{id:"items/basilshaker"},{id:"items/basket"},{id:"items/bayleaves"},{id:"items/bayleavesbottle"},{id:"items/bayleavesbowlmedium"},{id:"items/bead"},{id:"items/bearhelm"},{id:"items/beer"},{id:"items/beermug"},{id:"items/berserkerssanity"},{id:"items/beryl"},{id:"items/berylgoldring"},{id:"items/berylpendant"},{id:"items/berylsilverring"},{id:"items/bident"},{id:"items/bigemptyvial"},{id:"items/bigflask"},{id:"items/bigmanaflask"},{id:"items/blackberry"},{id:"items/blackpepperplant"},{id:"items/blackpotion"},{id:"items/bladeofdarkness"},{id:"items/bloodmoonstaff"},{id:"items/bloodwoodlogs"},{id:"items/blueberry"},{id:"items/bluelightsaber"},{id:"items/bluelily"},{id:"items/bluemoonstaff"},{id:"items/blueworm"},{id:"items/bonebonker"},{id:"items/bonepickaxe"},{id:"items/book"},{id:"items/borth"},{id:"items/bowbamboo"},{id:"items/bowdeuteranom"},{id:"items/boweggplant"},{id:"items/bowfleshflinger"},{id:"items/bowiceicemaybe"},{id:"items/bowillmuscal"},{id:"items/bowkelpysburden"},{id:"items/bowlmedium"},{id:"items/bowlsmall"},{id:"items/bowmagiccool"},{id:"items/bowmagichot"},{id:"items/bowmoon"},{id:"items/bowocean"},{id:"items/bowpine"},{id:"items/bowsky"},{id:"items/bowsun"},{id:"items/bowswineslayer"},{id:"items/bowwillowtwine"},{id:"items/braceletbronzeberyl"},{id:"items/braceletbronzeemerald"},{id:"items/braceletbronzepythar"},{id:"items/braceletbronzeruby"},{id:"items/braceletbronzesapphire"},{id:"items/braceletgoldberyl"},{id:"items/braceletgoldemerald"},{id:"items/braceletgoldpythar"},{id:"items/braceletgoldruby"},{id:"items/braceletgoldsapphire"},{id:"items/braceletsilverberyl"},{id:"items/braceletsilveremerald"},{id:"items/braceletsilverpythar"},{id:"items/braceletsilverruby"},{id:"items/braceletsilversapphire"},{id:"items/bronzeaxe"},{id:"items/bronzebar"},{id:"items/bronzebattleaxe"},{id:"items/bronzeboots"},{id:"items/bronzechestplate"},{id:"items/bronzehelmet"},{id:"items/bronzelegplates"},{id:"items/bronzeore"},{id:"items/bronzepickaxe"},{id:"items/bronzering"},{id:"items/bronzescythe"},{id:"items/bronzespear"},{id:"items/bronzesword"},{id:"items/brutishblade"},{id:"items/bucket"},{id:"items/burger"},{id:"items/cake"},{id:"items/candykey"},{id:"items/cayennebowlsmall"},{id:"items/cayennepepper"},{id:"items/cayenneshaker"},{id:"items/cd"},{id:"items/cellobello"},{id:"items/cheese"},{id:"items/chilli"},{id:"items/chisel"},{id:"items/cilantro"},{id:"items/cinnabararrow"},{id:"items/cinnabarore"},{id:"items/cinnabarsword"},{id:"items/cinnamon"},{id:"items/cinnamonbark"},{id:"items/cinnamonbowlsmall"},{id:"items/cinnamonshaker"},{id:"items/citrine"},{id:"items/clamchowder"},{id:"items/clamobject"},{id:"items/cloth"},{id:"items/cloudberry"},{id:"items/club"},{id:"items/coal"},{id:"items/cobaltaxe"},{id:"items/cobaltbattleaxe"},{id:"items/cobaltboots"},{id:"items/cobaltchestplate"},{id:"items/cobalthelmet"},{id:"items/cobaltlegplates"},{id:"items/cobaltpickaxe"},{id:"items/cobaltscythe"},{id:"items/cobaltshield"},{id:"items/cobaltspear"},{id:"items/cookedbeef"},{id:"items/cookedchicken"},{id:"items/cookedpork"},{id:"items/cookedsausage"},{id:"items/cookedshrimp"},{id:"items/copperbar"},{id:"items/copperchestplate"},{id:"items/copperhelmet"},{id:"items/copperlegplates"},{id:"items/copperore"},{id:"items/coppershield"},{id:"items/coppersword"},{id:"items/corn"},{id:"items/crystalhood"},{id:"items/crystallegplates"},{id:"items/cumin"},{id:"items/cuminbowlsmall"},{id:"items/cuminplant"},{id:"items/cuminshaker"},{id:"items/cure"},{id:"items/cursebead"},{id:"items/cursedbattleaxe"},{id:"items/cursedpickaxe"},{id:"items/cursedsapphirepickaxe"},{id:"items/cursestaff"},{id:"items/danbo"},{id:"items/danboblue"},{id:"items/danbogreen"},{id:"items/danbored"},{id:"items/dandelion"},{id:"items/darkmagehood"},{id:"items/darkmagehoodblue"},{id:"items/darkmagehoodgold"},{id:"items/darkmagehoodgreen"},{id:"items/darkskeletonhelm"},{id:"items/darkskeletonskin"},{id:"items/defensepotion"},{id:"items/demoniccrystalhood"},{id:"items/demonichelm"},{id:"items/demonicstaff"},{id:"items/diamondring"},{id:"items/dinosaurarmor"},{id:"items/dolring"},{id:"items/dragonscale"},{id:"items/egg"},{id:"items/element"},{id:"items/emerald"},{id:"items/emeraldpendant"},{id:"items/emeraldring"},{id:"items/emptybottle"},{id:"items/emptyshaker"},{id:"items/essentialrage"},{id:"items/etherialblade"},{id:"items/ettispinefruit"},{id:"items/executionershammer"},{id:"items/eyesword"},{id:"items/feather"},{id:"items/firearrow"},{id:"items/firebead"},{id:"items/firepotion"},{id:"items/fireshot"},{id:"items/firestaff"},{id:"items/firesword"},{id:"items/fishbowl"},{id:"items/fishingpole"},{id:"items/flameblackhelmet"},{id:"items/flamebluehelmet"},{id:"items/flamecursehelmet"},{id:"items/flamehelmet"},{id:"items/flask"},{id:"items/froghelm"},{id:"items/frostring"},{id:"items/galaxylilies"},{id:"items/ginderpowderbowlsmall"},{id:"items/ginger"},{id:"items/gingerbottle"},{id:"items/gingerpowder"},{id:"items/godscroissant"},{id:"items/gold"},{id:"items/goldaxe"},{id:"items/goldbar"},{id:"items/goldbattleaxe"},{id:"items/goldboots"},{id:"items/goldchestplate"},{id:"items/goldgolemsmace"},{id:"items/goldhelmet"},{id:"items/goldlegplates"},{id:"items/goldnugget"},{id:"items/goldore"},{id:"items/goldpickaxe"},{id:"items/goldring"},{id:"items/goldring2"},{id:"items/goldscythe"},{id:"items/goldshield"},{id:"items/goldspear"},{id:"items/goldsword"},{id:"items/golemsmace"},{id:"items/gooseberry"},{id:"items/greenlightsaber"},{id:"items/greenpendant"},{id:"items/greenworm"},{id:"items/gun"},{id:"items/hammer"},{id:"items/harmoniccrossband"},{id:"items/heavyberylpickaxe"},{id:"items/heliphatitlogs"},{id:"items/hellhoundfang"},{id:"items/hellkeeperboots"},{id:"items/hellkeeperchestplate"},{id:"items/hellkeeperhelm"},{id:"items/hellkeeperlegplates"},{id:"items/hellsword"},{id:"items/helmofhaste"},{id:"items/helmofliberty"},{id:"items/hemocytelogs"},{id:"items/hilt1"},{id:"items/hilt2"},{id:"items/horseradish"},{id:"items/horseradishbottle"},{id:"items/horseradishbowlsmall"},{id:"items/horseradishsmashedbowlsmall"},{id:"items/hotsauce"},{id:"items/iboarrow"},{id:"items/iboore"},{id:"items/ibosword"},{id:"items/icearrow"},{id:"items/icebead"},{id:"items/icelogs"},{id:"items/icepalmlogs"},{id:"items/icepinelogs"},{id:"items/icerose"},{id:"items/icesword"},{id:"items/ironaxe"},{id:"items/ironbar"},{id:"items/ironbattleaxe"},{id:"items/ironboots"},{id:"items/ironchestplate"},{id:"items/ironhelmet"},{id:"items/ironlegplates"},{id:"items/ironore"},{id:"items/ironpickaxe"},{id:"items/ironring"},{id:"items/ironroundshield"},{id:"items/ironscythe"},{id:"items/ironshield"},{id:"items/ironspear"},{id:"items/ironsword"},{id:"items/jellyfish"},{id:"items/jellyfishsmoothie"},{id:"items/jesterhat"},{id:"items/kelp"},{id:"items/kiwi"},{id:"items/knife"},{id:"items/knightchestplate"},{id:"items/knighthelmet"},{id:"items/knightlegplates"},{id:"items/lantern"},{id:"items/lantern2"},{id:"items/lanternarcan"},{id:"items/lapislazuli"},{id:"items/largeemptyvial"},{id:"items/lavaboots"},{id:"items/lavender"},{id:"items/lavenderbowlsmall"},{id:"items/lavenderseeds"},{id:"items/lavendershaker"},{id:"items/leaf"},{id:"items/leatherboots"},{id:"items/leatherchest"},{id:"items/leatherhelmet"},{id:"items/leatherleggings"},{id:"items/lightningarrow"},{id:"items/lightningbead"},{id:"items/lightningstaff"},{id:"items/livinganchorroot"},{id:"items/logs"},{id:"items/lolipop"},{id:"items/lootbag"},{id:"items/loveactring"},{id:"items/magichamberge"},{id:"items/magmaboots"},{id:"items/magmahelm"},{id:"items/manaberry"},{id:"items/manaflask"},{id:"items/mango"},{id:"items/midnightamethystboots"},{id:"items/midnightamethystchestplate"},{id:"items/midnightamethysthelm"},{id:"items/midnightamethystlegplates"},{id:"items/milkbottle"},{id:"items/mineral"},{id:"items/mint"},{id:"items/mintbowlsmall"},{id:"items/moongreataxe"},{id:"items/moonhelm"},{id:"items/moonrockore"},{id:"items/mulberry"},{id:"items/mushroom1"},{id:"items/mushroom2"},{id:"items/mushroom3"},{id:"items/mushroom4"},{id:"items/mushroom5"},{id:"items/mushroom6"},{id:"items/mushroomhat"},{id:"items/mustardbottle"},{id:"items/mustardbowlsmall"},{id:"items/mustardplant"},{id:"items/naturebead"},{id:"items/naturecrystalhood"},{id:"items/naturestaff"},{id:"items/nexuscross"},{id:"items/nightboots"},{id:"items/nightchestplate"},{id:"items/nighthelm"},{id:"items/nightlegplates"},{id:"items/nightsword"},{id:"items/nisocarrow"},{id:"items/nisocore"},{id:"items/nisocring"},{id:"items/nisocsword"},{id:"items/null"},{id:"items/oat"},{id:"items/oldmanmask"},{id:"items/oldmanskin"},{id:"items/oldonesblade"},{id:"items/onion"},{id:"items/opal"},{id:"items/orange"},{id:"items/orchardsbane"},{id:"items/paladinchestplate"},{id:"items/paladinhelmet"},{id:"items/paladinlegplates"},{id:"items/palmlogs"},{id:"items/paprika"},{id:"items/paprikabowlsmall"},{id:"items/paprikapowder"},{id:"items/paprikashaker"},{id:"items/peach"},{id:"items/pearlpendant"},{id:"items/pearlring"},{id:"items/peddlepounder"},{id:"items/pendant1"},{id:"items/pendantbronzeberyl"},{id:"items/pendantbronzeemerald"},{id:"items/pendantbronzepythar"},{id:"items/pendantbronzeruby"},{id:"items/pendantbronzesapphire"},{id:"items/pendantgoldberyl"},{id:"items/pendantgoldemerald"},{id:"items/pendantgoldpythar"},{id:"items/pendantgoldruby"},{id:"items/pendantgoldsapphire"},{id:"items/pendantsilverberyl"},{id:"items/pendantsilveremerald"},{id:"items/pendantsilverpythar"},{id:"items/pendantsilverruby"},{id:"items/pendantsilversapphire"},{id:"items/pepper"},{id:"items/pepperbowlsmall"},{id:"items/peppershaker"},{id:"items/peridot"},{id:"items/pilgrimhat"},{id:"items/pilgrimhatpink"},{id:"items/pineapple"},{id:"items/pinelogs"},{id:"items/pinklightsaber"},{id:"items/plum"},{id:"items/plunger"},{id:"items/poisonarrow"},{id:"items/potato"},{id:"items/pythararrow"},{id:"items/pytharore"},{id:"items/pytharring"},{id:"items/pytharsword"},{id:"items/quinoa"},{id:"items/raspberry"},{id:"items/ratballoonpet"},{id:"items/rathatpet"},{id:"items/ratpet"},{id:"items/rawbeef"},{id:"items/rawchicken"},{id:"items/rawpork"},{id:"items/rawsausage"},{id:"items/rawshrimp"},{id:"items/rawtuna"},{id:"items/redlightsaber"},{id:"items/redmoonhelm"},{id:"items/refinedsapphireboots"},{id:"items/refinedsapphirechestplate"},{id:"items/refinedsapphirehelmet"},{id:"items/refinedsapphirelegplates"},{id:"items/rice"},{id:"items/ring1"},{id:"items/ringbronzeberyl"},{id:"items/ringbronzeemerald"},{id:"items/ringbronzepythar"},{id:"items/ringbronzeruby"},{id:"items/ringbronzesapphire"},{id:"items/ringgoldberyl"},{id:"items/ringgoldemerald"},{id:"items/ringgoldpythar"},{id:"items/ringgoldruby"},{id:"items/ringgoldsapphire"},{id:"items/ringsilverberyl"},{id:"items/ringsilveremerald"},{id:"items/ringsilverpythar"},{id:"items/ringsilverruby"},{id:"items/ringsilversapphire"},{id:"items/rock"},{id:"items/rockfish"},{id:"items/rosemary"},{id:"items/rosemarybottle"},{id:"items/rosemarybowlsmall"},{id:"items/rosemarypowder"},{id:"items/royalazalea"},{id:"items/royalrapier"},{id:"items/ruby"},{id:"items/rubyboots"},{id:"items/rubychestplate"},{id:"items/rubygem"},{id:"items/rubyhelm"},{id:"items/rubylegplates"},{id:"items/rubypendant"},{id:"items/rubyring"},{id:"items/sage"},{id:"items/sagebowlsmall"},{id:"items/sagepowder"},{id:"items/sageshaker"},{id:"items/salt"},{id:"items/saltbowlsmall"},{id:"items/saltcrystal"},{id:"items/saltshaker"},{id:"items/samuraichestplate"},{id:"items/samuraihelmet"},{id:"items/samurailegplates"},{id:"items/sapphireboots"},{id:"items/sapphirechestplate"},{id:"items/sapphirehelm"},{id:"items/sapphirelegplates"},{id:"items/sapphirering"},{id:"items/sausage"},{id:"items/scholarshat"},{id:"items/scholarshatblack"},{id:"items/scholarshatgreen"},{id:"items/scholarshatred"},{id:"items/scholarshatyellow"},{id:"items/scimitar"},{id:"items/seaweedroll"},{id:"items/seed"},{id:"items/sentinelboots"},{id:"items/sentinelchestplate"},{id:"items/sentinelhelm"},{id:"items/sentinellegplates"},{id:"items/sentinelsword"},{id:"items/shardt1"},{id:"items/shardt2"},{id:"items/shardt3"},{id:"items/shardt4"},{id:"items/shardt5"},{id:"items/shieldofglory"},{id:"items/shieldofliberty"},{id:"items/silverring"},{id:"items/silverring2"},{id:"items/skeletonhelm"},{id:"items/skeletonskin"},{id:"items/slimehelmet"},{id:"items/slimekinghelmet"},{id:"items/slimekingrarehelmet"},{id:"items/slimepurplehelmet"},{id:"items/slimeredhelmet"},{id:"items/slimetealhelmet"},{id:"items/smallemptyvial"},{id:"items/smithshammer"},{id:"items/snowpotion"},{id:"items/speedpotion"},{id:"items/spiritring"},{id:"items/spoon"},{id:"items/sproutring"},{id:"items/steelboots"},{id:"items/stellarcluster"},{id:"items/stew"},{id:"items/stew2"},{id:"items/stick"},{id:"items/strawberry"},{id:"items/strengthpotion"},{id:"items/string"},{id:"items/sunrisegreataxe"},{id:"items/sunshinecrystalhood"},{id:"items/sunshinestaff"},{id:"items/swashbuckler"},{id:"items/swiftboots"},{id:"items/swordofliberty"},{id:"items/sycophant"},{id:"items/taaffeite"},{id:"items/taekwondo"},{id:"items/tamagotchiring"},{id:"items/timelessglaive"},{id:"items/tinbar"},{id:"items/tinchestplate"},{id:"items/tinhelmet"},{id:"items/tinlegplates"},{id:"items/tinore"},{id:"items/tinshield"},{id:"items/tinsword"},{id:"items/tofu"},{id:"items/token"},{id:"items/tomato"},{id:"items/topaz"},{id:"items/topazring"},{id:"items/toyhat"},{id:"items/toyhatprogrammer"},{id:"items/toyhatwhite"},{id:"items/tunasushi"},{id:"items/twilightgreataxe"},{id:"items/undefined"},{id:"items/vanila"},{id:"items/vanillabottle"},{id:"items/vanillabowlsmall"},{id:"items/wartberries"},{id:"items/waterbucket"},{id:"items/watermelon"},{id:"items/watermelonbow"},{id:"items/watermelonslice"},{id:"items/wings"},{id:"items/wingsdark"},{id:"items/witchhat"},{id:"items/witchhatblue"},{id:"items/witchsstaffancient"},{id:"items/witchsstaffblood"},{id:"items/witchsstaffdemonic"},{id:"items/witchsstaffmoon"},{id:"items/witchsstaffsunshine"},{id:"items/wizardhatblack"},{id:"items/wizardhatblue"},{id:"items/wizardhatcrimson"},{id:"items/wizardhatdarkblue"},{id:"items/wizardhatgreen"},{id:"items/wizardhatpink"},{id:"items/wizardhatpurple"},{id:"items/wizardhatred"},{id:"items/wizardhatturquoise"},{id:"items/wizardhatwhite"},{id:"items/wizardhatyellow"},{id:"items/wolfhelmet"},{id:"items/woodenbow"},{id:"items/woodenshield"},{id:"items/worm"},{id:"items/zephyrsgaleblade"},{id:"items/zoncillogs"},{id:"items/zondullogs"},{id:"items/zweipiercer"},{id:"artistcrown"},{id:"conquerorhelmet"},{id:"elfhelmet"},{id:"elfhelmetgrown"},{id:"minitauruschestplate"},{id:"minitaurushelmet"},{id:"minitauruslegboots"},{id:"minitauruslegplates"},{id:"scarabboots"},{id:"scarabchest"},{id:"scarabhelmet"},{id:"scarablegplates"},{id:"bluemysticchest"},{id:"conquerorchestplate"},{id:"greenmysticchest"},{id:"minitauruschest"},{id:"mysticchest"},{id:"scarabchest"},{id:"sentinelchestplate"},{id:"conquerorlegplates"},{id:"minitauruslegplates"},{id:"scarablegplates"},{id:"sentinelegplates"}];class xl{sprites={};preloadedAnimations=[];constructor(){this.load()}load(){for(let e of Rl){let t=new $i(e);if(this.sprites[t.key]=t,t.preload){t.load();let s=t.animations.idle_down;s?.length>1&&(this.preloadedAnimations.push(s),s.setSpeed(t.idleSpeed||200))}}L.debug("Finished loading sprite data...")}get(e){return this.sprites[e]}getDeath(){return this.get("death")}}class Dl{direction;reset(){this.direction=null}setUp(){this.direction=A.Up}setDown(){this.direction=A.Down}setRight(){this.direction=A.Right}setLeft(){this.direction=A.Left}getDirection(){return this.direction}}class Yl{constructor(e){this.game=e,this.container.addEventListener("touchstart",t=>{this.handle.classList.add("active"),this.onTouch(t)}),this.container.addEventListener("touchmove",this.onTouch.bind(this)),this.container.addEventListener("touchend",this.onTouchEnd.bind(this)),this.container.addEventListener("touchcancel",this.onTouchEnd.bind(this))}container=document.querySelector("#joystick");handle=document.querySelector("#joystick-handle");position;moving=!1;show(){this.container.hidden=!1}hide(){this.container.hidden=!0}onTouch(e){let[{clientX:t,clientY:s}]=e.touches,{left:a,top:n,width:r,height:o}=this.container.getBoundingClientRect(),h=Math.max(0,Math.min(1,(t-a)/r)),l=Math.max(0,Math.min(1,(s-n)/o)),d=Math.min(.75,Math.hypot(h-.5,l-.5)*2),c=Math.atan2(l-.5,h-.5),u=Math.cos(c),g=Math.sin(c);if(this.handle.style.transform=`translate(${u*d*100}%, ${g*d*100}%)`,d<.25){this.moving=!1,this.game.player.joystickMovement=!1;return}let f=this.moving;this.position={x:Math.round(u),y:Math.round(g)},this.moving=!0,this.game.player.joystickMovement=!0,f||this.move()}move(){let{player:e,map:t,input:s}=this.game,a=e.x+this.position.x*t.tileSize,n=e.y+this.position.y*t.tileSize,r=Math.round(e.x/t.tileSize+this.position.x),o=Math.round(e.y/t.tileSize+this.position.y);s.player.disableAction=!1,s.move({x:a,y:n,gridX:r,gridY:o},!1),this.moving&&requestAnimationFrame(this.move.bind(this))}onTouchEnd(){this.moving=!1,this.handle.classList.remove("active"),this.handle.style.transform=""}}class Ml extends Fa{constructor(e){super(e),this.character=e,this.map=e.game.map,this.game=e.game,this.entities=e.game.entities}map;lastStepX=-1;lastStepY=-1;game;entities;handleRequestPath(e,t){if(this.character.gridX===e&&this.character.gridY===t)return[];if(this.character.dead||this.character.frozen)return[];if(!this.character.hasKeyboardMovement()&&!this.character.target&&this.character.lookAtPosition(e,t),this.character.canAttackTarget()&&!this.character.trading)return[];let s=this.map.isObject(e,t),a=this.character.target?.isResource(),n=this.character.target?.isNPC();if(this.map.isColliding(e,t)&&!s&&!a&&!n)return[];this.game.socket.send(p.Movement,{opcode:ue.Request,requestX:e,requestY:t,playerX:this.character.gridX,playerY:this.character.gridY,targetInstance:this.character.target?.instance,following:this.character.following});let r=[],o="";return s&&(r.push({x:e,y:t}),o=this.map.getTileCursor(e,t),o==="fishing"&&r.push({x:e+1,y:t},{x:e-1,y:t},{x:e,y:t+1},{x:e,y:t-1})),(a||n)&&r.push({x:e,y:t}),this.game.findPath(this.character,e,t,r,o)}handleStartPathing(e){[this.game.input.selectedX,this.game.input.selectedY]=e.at(-1),this.character.moving=!0,this.game.input.selectedCellVisible=!0,this.game.socket.send(p.Movement,{opcode:ue.Started,requestX:this.game.input.selectedX,requestY:this.game.input.selectedY,playerX:this.character.gridX,playerY:this.character.gridY,movementSpeed:this.character.movementSpeed,targetInstance:this.character.target?.instance})}handleStopPathing(e,t){this.entities.registerPosition(this.character),this.game.input.selectedCellVisible=!1,this.game.socket.send(p.Movement,{opcode:ue.Stop,playerX:this.character.gridX,playerY:this.character.gridY,targetInstance:this.character.target?.instance||this.game.getEntityAt(e,t)?.instance,orientation:this.character.orientation}),this.character.trading&&this.game.socket.send(p.Trade,{opcode:ce.Request,instance:this.character.target?.instance}),this.getTargetType()!==xe.None&&this.game.socket.send(p.Target,[this.getTargetType(),this.character.target?.instance||""]),this.character.target&&(this.character.lookAt(this.character.target),this.character.target.isObject()&&this.character.removeTarget(),this.character.disableAction=!0),this.game.input.setPassiveTarget(),this.game.storage.setOrientation(this.character.orientation),this.character.hasKeyboardMovement()||this.character.performAction(this.character.orientation,ae.Idle),this.character.moving=!1,this.character.trading=!1}handleStep(){this.character.hasNextStep()&&this.entities.registerPosition(this.character),this.game.camera.isCentered()||this.game.updateCameraBounds(),!(this.lastStepX===this.character.gridX&&this.lastStepY===this.character.gridY)&&(this.handleAttackers(),this.handleFollowers(),this.character.hasTarget()&&this.game.socket.send(p.Movement,{opcode:ue.Entity,targetInstance:this.character.target?.instance,requestX:this.character.target?.gridX,requestY:this.character.target?.gridY}),this.game.socket.send(p.Movement,{opcode:ue.Step,playerX:this.character.gridX,playerY:this.character.gridY,nextGridX:this.character.nextGridX,nextGridY:this.character.nextGridY,timestamp:~~(performance.now()-this.game.timeOffset)}),this.lastStepX=this.character.gridX,this.lastStepY=this.character.gridY,this.character.canAttackTarget()&&this.character.stop())}handleMove(){this.game.camera.isCentered()&&this.game.camera.centreOn(this.character)}getTargetType(){return this.character.target?this.character.target.isNPC()||this.character.target.isChest()?xe.Talk:this.character.target.isObject()||this.character.target.isResource()?xe.Object:this.character.target.isMob()||this.character.target.isPlayer()&&this.game.pvp?xe.Attack:xe.None:xe.None}}class Pl{constructor(e){this.map=e}renderingGrid=[];addToRenderingGrid(e){let{instance:t,gridX:s,gridY:a}=e;this.map.isOutOfBounds(s,a)||(this.renderingGrid[a][s][t]=e)}removeFromRenderingGrid(e){if(e instanceof Le&&e.hasPath())for(let t of e.path)delete this.renderingGrid[t[1]][t[0]][e.instance];delete this.renderingGrid[e.gridY][e.gridX][e.instance]}getEntitiesAround(e,t,s=2){let a=[];for(let n=t-s;n<t+s;n++)for(let r=e-s;r<e+s;r++)this.map.isOutOfBounds(r,n)||(a=[...a,...Object.values(this.renderingGrid[n][r])]);return a}}const Fl=1152,Ul=1008,ql=16,zl=1695981410504,Bl=[17,18,19,58,59,74,77,78,81,82,83,131,132,133,134,135,136,137,140,141,142,143,186,187,192,193,195,196,197,198,199,200,201,203,204,205,206,207,208,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,320,321,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,387,393,394,401,458,465,566,567,630,631,640,641,704,705,896,897,960,961,1292,1293,1356,1357,1399,1401,1414,1415,1416,1419,1420,1421,1422,1423,1424,1425,1426,1462,1463,1464,1465,1466,1477,1478,1479,1480,1481,1483,1484,1485,1486,1487,1488,1489,1490,1526,1527,1528,1529,1530,1531,1532,1540,1541,1542,1543,1544,1545,1546,1547,1548,1549,1550,1551,1552,1553,1554,1590,1591,1592,1593,1594,1595,1596,1604,1605,1606,1607,1608,1609,1610,1648,1649,1650,1653,1654,1655,1656,1657,1658,1659,1660,1668,1669,1670,1671,1672,1673,1674,1712,1713,1714,1717,1718,1719,1720,1721,1722,1723,1776,1777,1778,1781,1782,1787,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1845,1846,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1942,1949,1950,1951,1952,1953,1954,1955,2004,2005,2068,2069,4174,4175,4178,4179,4182,4184,4185,4186,4187,4270,4271,4273,4274,4275,4276,4277,4278,4279,4365,4366,4367,4368,4369,4370,4371,4372,4373,4374,4375,4376,4377,4378,4379,4461,4462,4463,4464,4465,4466,4467,4468,4469,4470,4471,4557,4558,4559,4560,4561,4562,4563,4564,4565,4566,4567,4653,4654,4655,4656,4657,4658,4659,4660,4661,4662,4663,4719,4720,4721,4722,4723,4724,4725,4726,4727,4728,4729,4730,4815,4816,4817,4818,4819,4820,4821,4822,4823,4824,4825,4826,4911,4912,4913,4914,4915,4916,4917,4918,4919,4920,4921,4922,5005,5006,5058,5059,5060,5068,5069,5070,5117,5118,5119,5152,5153,5154,5155,5156,5157,5158,5159,5160,5161,5162,5163,5164,5165,5166,5167,5168,5169,5170,5248,5249,5250,5251,5252,5253,5254,5255,5256,5257,5258,5259,5260,5261,5262,5263,5264,5265,5266,5344,5345,5346,5347,5348,5350,5351,5352,5353,5354,5355,5356,5357,5358,5359,5360,5361,5362,5387,5388,5440,5441,5442,5443,5444,5501,5502,5503,5605,5606,5607,5608,5609,5610,5611,5612,5613,5614,5615,5701,5702,5703,5704,5705,5706,5707,5708,5709,5710,5711,5796,5797,5798,5799,5800,5801,5802,5803,5804,5805,5806,5807,5892,5893,5894,5895,5896,5960,5961,5962,6018,6019,6032,6056,6057,6058,6059,6069,6070,6071,6072,6073,6113,6114,6115,6116,6117,6127,6128,6129,6130,6152,6153,6154,6155,6208,6209,6210,6211,6212,6213,6216,6217,6218,6221,6222,6223,6224,6225,6226,6248,6249,6250,6304,6305,6306,6307,6308,6311,6312,6313,6314,6315,6317,6318,6319,6320,6321,6322,6400,6401,6402,6403,6404,6405,6406,6407,6408,6409,6410,6411,6412,6413,6414,6415,6416,6417,6418,8276,8277,8278,8372,8373,8374,8552,8553,8554,8648,8649,8650,8709,8710,8711,8721,8722,8723,8730,8731,8732,8766,8767,8768,8775,8776,8777,8784,8785,8786,8793,8794,8795,8805,8806,8807,8817,8818,8819,8826,8827,8828,8862,8863,8864,8871,8872,8873,8880,8881,8882,8889,8890,8891,8900,8901,8902,8903,8904,8905,8912,8913,8914,8915,8916,8917,8921,8922,8923,8924,8925,8926,8939,8940,8941,8942,8943,8944,8948,8949,8950,8951,8952,8953,8957,8958,8959,8960,8961,8962,8966,8967,8968,8969,8970,8971,8975,8976,8977,8978,8979,8980,8984,8985,8986,8987,8988,8989,8996,8997,8998,8999,9e3,9001,9008,9009,9010,9011,9012,9013,9017,9018,9019,9020,9021,9022,9035,9036,9037,9038,9039,9040,9044,9045,9046,9047,9048,9049,9053,9054,9055,9056,9057,9058,9062,9063,9064,9065,9066,9067,9071,9072,9073,9074,9075,9076,9080,9081,9082,9083,9084,9085,9092,9093,9094,9095,9096,9097,9104,9105,9106,9107,9108,9109,9113,9114,9115,9116,9117,9118,9131,9132,9133,9134,9135,9136,9140,9141,9142,9143,9144,9145,9149,9150,9151,9152,9153,9154,9158,9159,9160,9161,9162,9163,9167,9168,9169,9170,9171,9172,9176,9177,9178,9179,9180,9181,9294,9295,9296,9297,9303,9304,9305,9306,9321,9322,9323,9324,9330,9331,9332,9333,9339,9340,9341,9342,9348,9349,9350,9351,9357,9358,9359,9360,9366,9367,9368,9369,10245,10246,10247,10248,10265,10266,10267,10268,10269,10270,10271,10272,10273,10274,10275,10309,10310,10311,10312,10313,10329,10330,10331,10332,10333,10334,10335,10336,10337,10338,10339,10373,10374,10375,10376,10377,10393,10403,10457,10467,10521,10531,10698,10699,10700,10701,10753,10754,10755,10756,10757,10758,10759,10760,10777,10778,10779,10780,10781,10782,10783,10817,10818,10819,10820,10826,10827,10829,10841,10842,10843,10844,10845,10846,10847,10881,10882,10883,10884,10905,10906,10907,10908,10909,10910,10911,10944,10949,10950,10951,10952,10953,10954,10955,10956,10957,10969,10975,11033,11039,11072,11074,11077,11079,11080,11081,11082,11084,11085,11143,11144,11145,11146,11200,11201,11202,11207,11208,11209,11210,11328,11329,11330,11340,11341,11456,11457,11458,11459,11545,11546,11547,11548,11549,11550,11551,11552,11553,11554,11555,11556,11557,11558,11584,11585,11586,11587,11596,11609,11610,11611,11612,11613,11614,11615,11616,11617,11618,11619,11620,11621,11622,11673,11674,11675,11676,11677,11678,11679,11680,11681,11682,11683,11684,11685,11686,11714,11715,11726,11737,11750,11801,11814,11905,11906,11907,11908,11909,11910,11911,11913,11914,11915,11916,11917,11918,11919,11920,11968,11969,11970,11971,11972,11973,11974,11975,11976,11977,11978,11979,11980,11981,11982,11983,11984,12032,12033,12034,12035,12036,12037,12038,12039,12040,12041,12042,12043,12044,12045,12046,12047,12063,12064,12065,12066,12067,12068,12069,12070,12096,12097,12098,12099,12100,12101,12102,12103,12105,12106,12107,12108,12109,12110,12111,12127,12128,12129,12130,12131,12132,12133,12134,12160,12161,12166,12167,12169,12175,12191,12192,12193,12194,12195,12196,12197,12198,12224,12225,12230,12231,12233,12239,12288,12416,12417,12418,12419,12420,12421,12422,12423,12424,12425,12426,12427,12428,12429,12430,12431,12432,12433,12434,12435,12436,12437,12438,12480,12481,12482,12483,12484,12485,12486,12487,12488,12489,12490,12491,12492,12493,12494,12495,12496,12497,12498,12499,12500,12501,12502,12544,12545,12546,12547,12548,12549,12550,12551,12552,12553,12554,12555,12556,12557,12558,12559,12560,12561,12562,12563,12564,12565,12566,12608,12609,12613,12614,12615,12621,12622,12630,12639,12640,12643,12644,12672,12673,12677,12678,12679,12685,12686,12694,12702,12703,12704,12705,12706,12707,12708,12709,12743,12749,12750,12758,12766,12767,12768,12769,12770,12771,12772,12773,12807,12813,12814,12822,12830,12831,12832,12835,12836,12837,12886,12894,12897,12898,12901,12950,13278,13283,13286,13287,13288,13289,13290,13291,13340,13341,13342,13343,13345,13346,13347,13348,13350,13351,13352,13353,13354,13355,13404,13405,13406,13407,13408,13409,13410,13411,13412,13413,13414,13415,13416,13417,13418,13470,13475,13476,13477,13479,13480,13481,13482,13485,13671,13672,13673,13674,13734,13735,13736,13737,13740,13741,13742,13745,13746,13747,13749,13750,13751,13798,13799,13800,13801,13803,13804,13805,13806,13808,13809,13810,13811,13812,13867,13868,13869,13870,13872,13873,13874,13875,13876,13991,13992,13993,14054,14055,14056,14057,14058,14060,14061,14062,14065,14066,14067,14070,14071,14072,14075,14076,14077,14118,14119,14120,14121,14122,14123,14124,14125,14126,14127,14128,14129,14130,14131,14132,14133,14134,14135,14136,14137,14138,14139,14140,14141,14142,14182,14183,14184,14187,14188,14189,14190,14191,14192,14193,14194,14195,14196,14197,14198,14199,14200,14201,14202,14203,14204,14205,14206,14996,14997,15011,15012,15036,15037,15038,15039,15040,15041,15042,15043,15044,15045,15046,15047,15049,15051,15053,15075,15076,15114,15116,15118,15139,15140,15177,15179,15181,15184,15185,15186,15189,15190,15191,15192,15242,15244,15246,15248,15249,15250,15251,15252,15313,15314,15315,15316,15317,15318,15319,15320,15368,15369,15370,15371,15384,15441,15442,15445,15446,15447,15496,15497,15498,15499,15504,15505,15506,15507,15572,15573,15639,15842,15858,15906,16854],Xl=[{firstGid:0,lastGid:4095,path:"tilesets/tilesheet-1.png",relativePath:"tilesheet-1.png"},{firstGid:4096,lastGid:10239,path:"tilesets/tilesheet-2.png",relativePath:"tilesheet-2.png"},{firstGid:10240,lastGid:14335,path:"tilesets/tilesheet-3.png",relativePath:"tilesheet-3.png"},{firstGid:14992,lastGid:19087,path:"tilesets/tilesheet-4.png",relativePath:"tilesheet-4.png"}],Hl={29:[{duration:300,tileId:28},{duration:300,tileId:29},{duration:300,tileId:30},{duration:300,tileId:31}],33:[{duration:300,tileId:32},{duration:300,tileId:33},{duration:300,tileId:34},{duration:300,tileId:35}],64:[{duration:250,tileId:63},{duration:250,tileId:64},{duration:250,tileId:65},{duration:250,tileId:66},{duration:250,tileId:67},{duration:250,tileId:68}],93:[{duration:300,tileId:92},{duration:300,tileId:93},{duration:300,tileId:94},{duration:300,tileId:95}],97:[{duration:300,tileId:96},{duration:300,tileId:97},{duration:300,tileId:98},{duration:300,tileId:99}],128:[{duration:250,tileId:127},{duration:250,tileId:0},{duration:250,tileId:1},{duration:250,tileId:2},{duration:250,tileId:3},{duration:250,tileId:4}],146:[{duration:350,tileId:145},{duration:350,tileId:146}],157:[{duration:300,tileId:156},{duration:300,tileId:157},{duration:300,tileId:158},{duration:300,tileId:159}],161:[{duration:300,tileId:160},{duration:300,tileId:161},{duration:300,tileId:162},{duration:300,tileId:163}],210:[{duration:350,tileId:209},{duration:350,tileId:210}],221:[{duration:300,tileId:220},{duration:300,tileId:221},{duration:300,tileId:222},{duration:300,tileId:223}],225:[{duration:300,tileId:224},{duration:300,tileId:225},{duration:300,tileId:226},{duration:300,tileId:227}],285:[{duration:300,tileId:284},{duration:300,tileId:285},{duration:300,tileId:286},{duration:300,tileId:287}],289:[{duration:300,tileId:288},{duration:300,tileId:289},{duration:300,tileId:290},{duration:300,tileId:291}],349:[{duration:300,tileId:348},{duration:300,tileId:349},{duration:300,tileId:350},{duration:300,tileId:351}],353:[{duration:300,tileId:352},{duration:300,tileId:353},{duration:300,tileId:354},{duration:300,tileId:355}],1211:[{duration:300,tileId:1210},{duration:300,tileId:1211},{duration:300,tileId:1212}],3361:[{duration:400,tileId:3360},{duration:400,tileId:3361}],3395:[{duration:400,tileId:3394},{duration:400,tileId:3395},{duration:400,tileId:3396}],3413:[{duration:400,tileId:3412},{duration:400,tileId:3413},{duration:400,tileId:3414}],3425:[{duration:400,tileId:3424},{duration:400,tileId:3425}],3431:[{duration:400,tileId:3430},{duration:400,tileId:3431},{duration:400,tileId:3432}],3437:[{duration:400,tileId:3436},{duration:400,tileId:3437},{duration:400,tileId:3438}],3443:[{duration:400,tileId:3442},{duration:400,tileId:3443},{duration:400,tileId:3444}],3449:[{duration:400,tileId:3448},{duration:400,tileId:3449},{duration:400,tileId:3450}],3459:[{duration:400,tileId:3458},{duration:400,tileId:3459}],3477:[{duration:400,tileId:3476},{duration:400,tileId:3477}],3489:[{duration:400,tileId:3488},{duration:400,tileId:3489}],3495:[{duration:400,tileId:3494},{duration:400,tileId:3495}],3501:[{duration:400,tileId:3500},{duration:400,tileId:3501}],3507:[{duration:400,tileId:3506},{duration:400,tileId:3507}],3513:[{duration:400,tileId:3512},{duration:400,tileId:3513}],3553:[{duration:400,tileId:3552},{duration:400,tileId:3553},{duration:400,tileId:3554}],4096:[{duration:250,tileId:4095},{duration:250,tileId:4096},{duration:250,tileId:4097},{duration:250,tileId:4098},{duration:250,tileId:4099},{duration:250,tileId:4100},{duration:250,tileId:4101},{duration:250,tileId:4102},{duration:250,tileId:4103},{duration:250,tileId:4104},{duration:250,tileId:4105},{duration:250,tileId:4106},{duration:250,tileId:4107},{duration:250,tileId:4108},{duration:250,tileId:4109},{duration:250,tileId:4110},{duration:250,tileId:4111}],4184:[{duration:200,tileId:4183},{duration:200,tileId:4185},{duration:200,tileId:4375},{duration:200,tileId:4377}],4185:[{duration:200,tileId:4184},{duration:200,tileId:4186},{duration:200,tileId:4376},{duration:200,tileId:4378}],4192:[{duration:250,tileId:4191},{duration:250,tileId:4192},{duration:250,tileId:4193},{duration:250,tileId:4194},{duration:250,tileId:4195},{duration:250,tileId:4196},{duration:250,tileId:4197},{duration:250,tileId:4198},{duration:250,tileId:4199},{duration:250,tileId:4200},{duration:250,tileId:4201},{duration:250,tileId:4202},{duration:250,tileId:4203},{duration:250,tileId:4204},{duration:250,tileId:4205}],4288:[{duration:250,tileId:4287},{duration:250,tileId:4288},{duration:250,tileId:4289},{duration:250,tileId:4290},{duration:250,tileId:4291},{duration:250,tileId:4292},{duration:250,tileId:4293},{duration:250,tileId:4294},{duration:250,tileId:4295},{duration:250,tileId:4296},{duration:250,tileId:4297},{duration:250,tileId:4298},{duration:250,tileId:4299},{duration:250,tileId:4300},{duration:250,tileId:4301},{duration:250,tileId:4302},{duration:250,tileId:4303}],4384:[{duration:250,tileId:4383},{duration:250,tileId:4384},{duration:250,tileId:4385},{duration:250,tileId:4386},{duration:250,tileId:4387},{duration:250,tileId:4388},{duration:250,tileId:4389},{duration:250,tileId:4390},{duration:250,tileId:4391},{duration:250,tileId:4392},{duration:250,tileId:4393},{duration:250,tileId:4394},{duration:250,tileId:4395},{duration:250,tileId:4396},{duration:250,tileId:4397}],4491:[{duration:250,tileId:4490},{duration:250,tileId:4491},{duration:250,tileId:4492},{duration:250,tileId:4493}],4495:[{duration:250,tileId:4494},{duration:250,tileId:4495},{duration:250,tileId:4496},{duration:250,tileId:4497}],4591:[{duration:250,tileId:4590},{duration:250,tileId:4591},{duration:250,tileId:4592},{duration:250,tileId:4593}],4672:[{duration:250,tileId:4671},{duration:250,tileId:4672},{duration:250,tileId:4673},{duration:250,tileId:4674},{duration:250,tileId:4675},{duration:250,tileId:4676},{duration:250,tileId:4677},{duration:250,tileId:4678},{duration:250,tileId:4679},{duration:250,tileId:4680},{duration:250,tileId:4681},{duration:250,tileId:4682},{duration:250,tileId:4683},{duration:250,tileId:4684},{duration:250,tileId:4685},{duration:250,tileId:4686},{duration:250,tileId:4687},{duration:250,tileId:4688},{duration:250,tileId:4689}],4768:[{duration:250,tileId:4767},{duration:250,tileId:4768},{duration:250,tileId:4769},{duration:250,tileId:4770},{duration:250,tileId:4771},{duration:250,tileId:4772},{duration:250,tileId:4773},{duration:250,tileId:4774},{duration:250,tileId:4775},{duration:250,tileId:4776},{duration:250,tileId:4777},{duration:250,tileId:4778},{duration:250,tileId:4779},{duration:250,tileId:4780},{duration:250,tileId:4781},{duration:250,tileId:4782},{duration:250,tileId:4783},{duration:250,tileId:4784},{duration:250,tileId:4785}],4864:[{duration:250,tileId:4863},{duration:250,tileId:4864},{duration:250,tileId:4865},{duration:250,tileId:4866},{duration:250,tileId:4867},{duration:250,tileId:4868},{duration:250,tileId:4869},{duration:250,tileId:4870},{duration:250,tileId:4871},{duration:250,tileId:4872},{duration:250,tileId:4873},{duration:250,tileId:4874},{duration:250,tileId:4875},{duration:250,tileId:4876},{duration:250,tileId:4877},{duration:250,tileId:4878},{duration:250,tileId:4879},{duration:250,tileId:4880},{duration:250,tileId:4881}],4960:[{duration:250,tileId:4959},{duration:250,tileId:4960},{duration:250,tileId:4961},{duration:250,tileId:4962},{duration:250,tileId:4963},{duration:250,tileId:4964},{duration:250,tileId:4965},{duration:250,tileId:4966},{duration:250,tileId:4967},{duration:250,tileId:4968},{duration:250,tileId:4969},{duration:250,tileId:4970},{duration:250,tileId:4971},{duration:250,tileId:4972},{duration:250,tileId:4973},{duration:250,tileId:4974},{duration:250,tileId:4975},{duration:250,tileId:4976},{duration:250,tileId:4977}],5608:[{duration:250,tileId:5607},{duration:250,tileId:5609},{duration:250,tileId:5611},{duration:250,tileId:5613}],5609:[{duration:250,tileId:5608},{duration:250,tileId:5610},{duration:250,tileId:5612},{duration:250,tileId:5614}],5704:[{duration:250,tileId:5703},{duration:250,tileId:5705},{duration:250,tileId:5707},{duration:250,tileId:5709}],5705:[{duration:250,tileId:5704},{duration:250,tileId:5706},{duration:250,tileId:5708},{duration:250,tileId:5710}],5800:[{duration:250,tileId:5799},{duration:250,tileId:5801},{duration:250,tileId:5803},{duration:250,tileId:5805}],5801:[{duration:250,tileId:5800},{duration:250,tileId:5802},{duration:250,tileId:5804},{duration:250,tileId:5806}],6074:[{duration:350,tileId:6073},{duration:350,tileId:6169},{duration:350,tileId:6265},{duration:350,tileId:6361},{duration:350,tileId:6457},{duration:350,tileId:6553}],6075:[{duration:350,tileId:6074},{duration:350,tileId:6170},{duration:350,tileId:6266},{duration:350,tileId:6362},{duration:350,tileId:6458},{duration:350,tileId:6554}],6076:[{duration:350,tileId:6075},{duration:350,tileId:6171},{duration:350,tileId:6267},{duration:350,tileId:6363},{duration:350,tileId:6459},{duration:350,tileId:6555}],6077:[{duration:350,tileId:6076},{duration:350,tileId:6172},{duration:350,tileId:6268},{duration:350,tileId:6364},{duration:350,tileId:6460},{duration:350,tileId:6556}],6078:[{duration:350,tileId:6077},{duration:350,tileId:6173},{duration:350,tileId:6269},{duration:350,tileId:6365},{duration:350,tileId:6461},{duration:350,tileId:6557}],6079:[{duration:350,tileId:6078},{duration:350,tileId:6174},{duration:350,tileId:6270},{duration:350,tileId:6366},{duration:350,tileId:6462},{duration:350,tileId:6558}],8752:[{duration:250,tileId:8751},{duration:250,tileId:8753},{duration:250,tileId:8847},{duration:250,tileId:8849}],8753:[{duration:250,tileId:8752},{duration:250,tileId:8754},{duration:250,tileId:8848},{duration:250,tileId:8850}],8928:[{duration:350,tileId:8927},{duration:350,tileId:8928}],8930:[{duration:350,tileId:8929},{duration:350,tileId:8930},{duration:350,tileId:9023}],9024:[{duration:350,tileId:9023},{duration:350,tileId:8927}],15283:[{duration:250,tileId:15282},{duration:250,tileId:15283},{duration:250,tileId:15284},{duration:250,tileId:15285}],15834:[{duration:250,tileId:15833},{duration:250,tileId:15835},{duration:250,tileId:15837},{duration:250,tileId:15839}],15835:[{duration:250,tileId:15834},{duration:250,tileId:15836},{duration:250,tileId:15838},{duration:250,tileId:15840}],15842:[{duration:250,tileId:15841},{duration:250,tileId:15842},{duration:250,tileId:15843},{duration:250,tileId:15844}],15853:[{duration:150,tileId:15852},{duration:150,tileId:15853},{duration:150,tileId:15854},{duration:150,tileId:15855}],15898:[{duration:250,tileId:15897},{duration:250,tileId:15899},{duration:250,tileId:15901},{duration:250,tileId:15903}],15899:[{duration:250,tileId:15898},{duration:250,tileId:15900},{duration:250,tileId:15902},{duration:250,tileId:15904}],15906:[{duration:250,tileId:15905},{duration:250,tileId:15906},{duration:250,tileId:15907},{duration:250,tileId:15908}],15917:[{duration:150,tileId:15916},{duration:150,tileId:15917},{duration:150,tileId:15918},{duration:150,tileId:15919}],15962:[{duration:250,tileId:15961},{duration:250,tileId:15962},{duration:250,tileId:15963},{duration:250,tileId:15964},{duration:250,tileId:15965},{duration:250,tileId:15966}],15981:[{duration:150,tileId:15980},{duration:150,tileId:15981},{duration:150,tileId:15982},{duration:150,tileId:15983}],16026:[{duration:250,tileId:16025},{duration:250,tileId:16026},{duration:250,tileId:16027},{duration:250,tileId:16028}],16045:[{duration:150,tileId:16044},{duration:150,tileId:16045},{duration:150,tileId:16046},{duration:150,tileId:16047}],16090:[{duration:250,tileId:16089},{duration:250,tileId:16090},{duration:250,tileId:16091},{duration:250,tileId:16092},{duration:250,tileId:16093},{duration:250,tileId:16094}],16154:[{duration:250,tileId:16153},{duration:250,tileId:16154},{duration:250,tileId:16155},{duration:250,tileId:16156}],16218:[{duration:250,tileId:16217},{duration:250,tileId:16218},{duration:250,tileId:16219},{duration:250,tileId:16220},{duration:250,tileId:16221},{duration:250,tileId:16222}]},tt={width:Fl,height:Ul,tileSize:ql,version:zl,high:Bl,tilesets:Xl,animations:Hl};class Gl{constructor(e){this.game=e,this.grids=new Pl(this),this.loadGrid(),this.loadTilesets(),this.loadRegionData(),this.ready(),m.tileSize=this.tileSize,m.sideLength=this.width/he.MAP_DIVISION_SIZE,m.halfTile=this.tileSize/2,m.tileAndAQuarter=this.tileSize*1.25}width=tt.width;height=tt.height;tileSize=tt.tileSize;data=[];grid=[];high=tt.high;cachedHighTiles={};objects=[];lights=[];tilesets=[];rawTilesets=tt.tilesets;cursorTiles={};animatedTiles=tt.animations;dynamicAnimatedTiles={};grids;mapLoaded=!1;regionsLoaded=0;tilesetsLoaded=!1;ready(){this.mapLoaded&&this.tilesetsLoaded?this.readyCallback?.():window.setTimeout(()=>this.ready(),100)}loadGrid(){let e=Date.now();for(let t=0;t<this.height;t++){this.grid[t]=[],this.grids.renderingGrid[t]=[];for(let s=0;s<this.width;s++)this.data.push(0),this.grid[t][s]=1,this.grids.renderingGrid[t][s]={}}L.debug(`Loaded empty grid in ${Date.now()-e}ms.`),this.mapLoaded=!0}loadRegions(e){for(let t in e)this.loadRegion(e[t],parseInt(t));this.saveMapData(),this.game.useWebGl&&this.game.renderer.bindTileLayers()}loadRegion(e,t){for(let s of e)this.loadRegionTileData(s);this.game.storage.setRegionData(e,t)}loadRegionTileData(e){let t=this.coordToIndex(e.x,e.y),s=this.objects.indexOf(t),a=!(t in this.dynamicAnimatedTiles)&&!this.game.isLowPowerMode(),n=this.parseTileData(e.data),r=e.animation?this.parseTileData(e.animation):void 0;this.data[t]=a&&r||n,r&&(this.dynamicAnimatedTiles[t]=n),e.c&&!this.isColliding(e.x,e.y)&&(this.grid[e.y][e.x]=1),!e.c&&this.isColliding(e.x,e.y)&&(this.grid[e.y][e.x]=0),e.cur&&(this.cursorTiles[t]=e.cur),!e.cur&&t in this.cursorTiles&&(this.cursorTiles[t]=""),e.o&&s<0&&this.objects.push(t),!e.o&&s>-1&&this.objects.splice(s,1),this.game.useWebGl&&this.game.renderer.setTile(t,this.data[t])}loadTilesets(){for(let e in this.rawTilesets)this.loadTileset(this.rawTilesets[e],parseInt(e),t=>{for(let s of this.tilesets)if(s.src===t.src)return;this.tilesets.push(t),this.tilesets.length===this.rawTilesets.length&&(this.tilesets=this.tilesets.sort((s,a)=>s.firstGid-a.firstGid),this.tilesetsLoaded=!0)})}loadTileset(e,t,s){let a=new Image,n=`/img/tilesets/${e.relativePath}`;a.crossOrigin="Anonymous",a.path=n,a.src=n,a.index=t,a.firstGid=e.firstGid,a.lastGid=e.lastGid,a.addEventListener("load",()=>{a.width%this.tileSize>0&&L.error(`The tile size is malformed in the tile set: ${e.path}`),a.loaded=!0,s(a)}),a.addEventListener("error",()=>{L.error(`Could not find tile set: ${e.path}`)}),setTimeout(()=>{a.loaded||(this.loadTileset(e,t,s),L.debug(`Retrying to load tileset: ${e.path}`))},500)}loadRegionData(){this.game.storage.getRegionData(e=>{let t=Object.keys(e.regionData);if(t.length>0){try{this.loadRegions(e.regionData)}catch{this.game.storage.clear(),this.game.storage.clearIndexedDB()}this.objects=e.objects,this.cursorTiles=e.cursorTiles,this.regionsLoaded=t.length,L.debug(`Preloaded map data with ${t.length} regions.`)}})}parseTileData(e){let t=Array.isArray(e),s=t?[]:0;return this.forEachTile(e,a=>{let n=a;this.isFlippedTileId(a)&&(n=this.getFlippedTile(a)),t?s.push(n):s=n}),s}getFlippedTile(e){let t=!!(e&Re.HORIZONTAL_FLAG),s=!!(e&Re.VERTICAL_FLAG),a=!!(e&Re.DIAGONAL_FLAG);return e&=~(Re.DIAGONAL_FLAG|Re.VERTICAL_FLAG|Re.HORIZONTAL_FLAG),{tileId:e,h:t,v:s,d:a}}saveMapData(){this.game.storage.setMapData(this.objects,this.cursorTiles)}coordToIndex(e,t){return t*this.width+e}indexToCoord(e){return{x:e%this.width,y:~~(e/this.width)}}isColliding(e,t,s=!1){return this.isOutOfBounds(e,t)||this.data[this.coordToIndex(e,t)]<1?!0:this.grid[t][e]===1||s&&this.grid[t][e]===2}isObject(e,t){let s=this.coordToIndex(e,t);return this.objects.includes(s)}isHighTile(e){return this.cachedHighTiles[e]?!0:this.high.includes(e)?(this.cachedHighTiles[e]=0,!0):!1}isLightTile(e){return this.lights.includes(e)}isAnimatedTile(e){return e in this.animatedTiles}hasCachedDate(){return this.regionsLoaded>0}isOutOfBounds(e,t){return e<0||e>=this.width||t<0||t>=this.height}isFlipped(e){return e.v||e.h||e.d}isFlippedTileId(e){return e>Re.DIAGONAL_FLAG}getTileAnimation(e){return this.animatedTiles[e]}getTilesetFromId(e){for(let t of this.tilesets)if(e>=t.firstGid&&e<=t.lastGid)return t}getTileCursor(e,t){let s=this.coordToIndex(e,t);return this.cursorTiles[s]}onReady(e){this.readyCallback=e}forEachTile(e,t){if(Array.isArray(e))for(let s in e)t(e[s],parseInt(s));else t(e)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Vl=4,Ms=0,Ps=1,Wl=2;function ut(i){let e=i.length;for(;--e>=0;)i[e]=0}const $l=0,qa=1,Kl=2,jl=3,Zl=258,os=29,zt=256,Rt=zt+1+os,ot=30,ls=19,za=2*Rt+1,Xe=15,Ci=16,Ql=7,hs=256,Ba=16,Xa=17,Ha=18,ji=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),si=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Jl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ga=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eh=512,Ce=new Array((Rt+2)*2);ut(Ce);const It=new Array(ot*2);ut(It);const xt=new Array(eh);ut(xt);const Dt=new Array(Zl-jl+1);ut(Dt);const ds=new Array(os);ut(ds);const pi=new Array(ot);ut(pi);function Ai(i,e,t,s,a){this.static_tree=i,this.extra_bits=e,this.extra_base=t,this.elems=s,this.max_length=a,this.has_stree=i&&i.length}let Va,Wa,$a;function Ni(i,e){this.dyn_tree=i,this.max_code=0,this.stat_desc=e}const Ka=i=>i<256?xt[i]:xt[256+(i>>>7)],Yt=(i,e)=>{i.pending_buf[i.pending++]=e&255,i.pending_buf[i.pending++]=e>>>8&255},te=(i,e,t)=>{i.bi_valid>Ci-t?(i.bi_buf|=e<<i.bi_valid&65535,Yt(i,i.bi_buf),i.bi_buf=e>>Ci-i.bi_valid,i.bi_valid+=t-Ci):(i.bi_buf|=e<<i.bi_valid&65535,i.bi_valid+=t)},we=(i,e,t)=>{te(i,t[e*2],t[e*2+1])},ja=(i,e)=>{let t=0;do t|=i&1,i>>>=1,t<<=1;while(--e>0);return t>>>1},th=i=>{i.bi_valid===16?(Yt(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},ih=(i,e)=>{const t=e.dyn_tree,s=e.max_code,a=e.stat_desc.static_tree,n=e.stat_desc.has_stree,r=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,d,c,u,g,f,y=0;for(u=0;u<=Xe;u++)i.bl_count[u]=0;for(t[i.heap[i.heap_max]*2+1]=0,l=i.heap_max+1;l<za;l++)d=i.heap[l],u=t[t[d*2+1]*2+1]+1,u>h&&(u=h,y++),t[d*2+1]=u,!(d>s)&&(i.bl_count[u]++,g=0,d>=o&&(g=r[d-o]),f=t[d*2],i.opt_len+=f*(u+g),n&&(i.static_len+=f*(a[d*2+1]+g)));if(y!==0){do{for(u=h-1;i.bl_count[u]===0;)u--;i.bl_count[u]--,i.bl_count[u+1]+=2,i.bl_count[h]--,y-=2}while(y>0);for(u=h;u!==0;u--)for(d=i.bl_count[u];d!==0;)c=i.heap[--l],!(c>s)&&(t[c*2+1]!==u&&(i.opt_len+=(u-t[c*2+1])*t[c*2],t[c*2+1]=u),d--)}},Za=(i,e,t)=>{const s=new Array(Xe+1);let a=0,n,r;for(n=1;n<=Xe;n++)a=a+t[n-1]<<1,s[n]=a;for(r=0;r<=e;r++){let o=i[r*2+1];o!==0&&(i[r*2]=ja(s[o]++,o))}},sh=()=>{let i,e,t,s,a;const n=new Array(Xe+1);for(t=0,s=0;s<os-1;s++)for(ds[s]=t,i=0;i<1<<ji[s];i++)Dt[t++]=s;for(Dt[t-1]=s,a=0,s=0;s<16;s++)for(pi[s]=a,i=0;i<1<<si[s];i++)xt[a++]=s;for(a>>=7;s<ot;s++)for(pi[s]=a<<7,i=0;i<1<<si[s]-7;i++)xt[256+a++]=s;for(e=0;e<=Xe;e++)n[e]=0;for(i=0;i<=143;)Ce[i*2+1]=8,i++,n[8]++;for(;i<=255;)Ce[i*2+1]=9,i++,n[9]++;for(;i<=279;)Ce[i*2+1]=7,i++,n[7]++;for(;i<=287;)Ce[i*2+1]=8,i++,n[8]++;for(Za(Ce,Rt+1,n),i=0;i<ot;i++)It[i*2+1]=5,It[i*2]=ja(i,5);Va=new Ai(Ce,ji,zt+1,Rt,Xe),Wa=new Ai(It,si,0,ot,Xe),$a=new Ai(new Array(0),Jl,0,ls,Ql)},Qa=i=>{let e;for(e=0;e<Rt;e++)i.dyn_ltree[e*2]=0;for(e=0;e<ot;e++)i.dyn_dtree[e*2]=0;for(e=0;e<ls;e++)i.bl_tree[e*2]=0;i.dyn_ltree[hs*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},Ja=i=>{i.bi_valid>8?Yt(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},Fs=(i,e,t,s)=>{const a=e*2,n=t*2;return i[a]<i[n]||i[a]===i[n]&&s[e]<=s[t]},Li=(i,e,t)=>{const s=i.heap[t];let a=t<<1;for(;a<=i.heap_len&&(a<i.heap_len&&Fs(e,i.heap[a+1],i.heap[a],i.depth)&&a++,!Fs(e,s,i.heap[a],i.depth));)i.heap[t]=i.heap[a],t=a,a<<=1;i.heap[t]=s},Us=(i,e,t)=>{let s,a,n=0,r,o;if(i.sym_next!==0)do s=i.pending_buf[i.sym_buf+n++]&255,s+=(i.pending_buf[i.sym_buf+n++]&255)<<8,a=i.pending_buf[i.sym_buf+n++],s===0?we(i,a,e):(r=Dt[a],we(i,r+zt+1,e),o=ji[r],o!==0&&(a-=ds[r],te(i,a,o)),s--,r=Ka(s),we(i,r,t),o=si[r],o!==0&&(s-=pi[r],te(i,s,o)));while(n<i.sym_next);we(i,hs,e)},Zi=(i,e)=>{const t=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,n=e.stat_desc.elems;let r,o,h=-1,l;for(i.heap_len=0,i.heap_max=za,r=0;r<n;r++)t[r*2]!==0?(i.heap[++i.heap_len]=h=r,i.depth[r]=0):t[r*2+1]=0;for(;i.heap_len<2;)l=i.heap[++i.heap_len]=h<2?++h:0,t[l*2]=1,i.depth[l]=0,i.opt_len--,a&&(i.static_len-=s[l*2+1]);for(e.max_code=h,r=i.heap_len>>1;r>=1;r--)Li(i,t,r);l=n;do r=i.heap[1],i.heap[1]=i.heap[i.heap_len--],Li(i,t,1),o=i.heap[1],i.heap[--i.heap_max]=r,i.heap[--i.heap_max]=o,t[l*2]=t[r*2]+t[o*2],i.depth[l]=(i.depth[r]>=i.depth[o]?i.depth[r]:i.depth[o])+1,t[r*2+1]=t[o*2+1]=l,i.heap[1]=l++,Li(i,t,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],ih(i,e),Za(t,h,i.bl_count)},qs=(i,e,t)=>{let s,a=-1,n,r=e[0*2+1],o=0,h=7,l=4;for(r===0&&(h=138,l=3),e[(t+1)*2+1]=65535,s=0;s<=t;s++)n=r,r=e[(s+1)*2+1],!(++o<h&&n===r)&&(o<l?i.bl_tree[n*2]+=o:n!==0?(n!==a&&i.bl_tree[n*2]++,i.bl_tree[Ba*2]++):o<=10?i.bl_tree[Xa*2]++:i.bl_tree[Ha*2]++,o=0,a=n,r===0?(h=138,l=3):n===r?(h=6,l=3):(h=7,l=4))},zs=(i,e,t)=>{let s,a=-1,n,r=e[0*2+1],o=0,h=7,l=4;for(r===0&&(h=138,l=3),s=0;s<=t;s++)if(n=r,r=e[(s+1)*2+1],!(++o<h&&n===r)){if(o<l)do we(i,n,i.bl_tree);while(--o!==0);else n!==0?(n!==a&&(we(i,n,i.bl_tree),o--),we(i,Ba,i.bl_tree),te(i,o-3,2)):o<=10?(we(i,Xa,i.bl_tree),te(i,o-3,3)):(we(i,Ha,i.bl_tree),te(i,o-11,7));o=0,a=n,r===0?(h=138,l=3):n===r?(h=6,l=3):(h=7,l=4)}},ah=i=>{let e;for(qs(i,i.dyn_ltree,i.l_desc.max_code),qs(i,i.dyn_dtree,i.d_desc.max_code),Zi(i,i.bl_desc),e=ls-1;e>=3&&i.bl_tree[Ga[e]*2+1]===0;e--);return i.opt_len+=3*(e+1)+5+5+4,e},nh=(i,e,t,s)=>{let a;for(te(i,e-257,5),te(i,t-1,5),te(i,s-4,4),a=0;a<s;a++)te(i,i.bl_tree[Ga[a]*2+1],3);zs(i,i.dyn_ltree,e-1),zs(i,i.dyn_dtree,t-1)},rh=i=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&i.dyn_ltree[t*2]!==0)return Ms;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return Ps;for(t=32;t<zt;t++)if(i.dyn_ltree[t*2]!==0)return Ps;return Ms};let Bs=!1;const oh=i=>{Bs||(sh(),Bs=!0),i.l_desc=new Ni(i.dyn_ltree,Va),i.d_desc=new Ni(i.dyn_dtree,Wa),i.bl_desc=new Ni(i.bl_tree,$a),i.bi_buf=0,i.bi_valid=0,Qa(i)},en=(i,e,t,s)=>{te(i,($l<<1)+(s?1:0),3),Ja(i),Yt(i,t),Yt(i,~t),t&&i.pending_buf.set(i.window.subarray(e,e+t),i.pending),i.pending+=t},lh=i=>{te(i,qa<<1,3),we(i,hs,Ce),th(i)},hh=(i,e,t,s)=>{let a,n,r=0;i.level>0?(i.strm.data_type===Wl&&(i.strm.data_type=rh(i)),Zi(i,i.l_desc),Zi(i,i.d_desc),r=ah(i),a=i.opt_len+3+7>>>3,n=i.static_len+3+7>>>3,n<=a&&(a=n)):a=n=t+5,t+4<=a&&e!==-1?en(i,e,t,s):i.strategy===Vl||n===a?(te(i,(qa<<1)+(s?1:0),3),Us(i,Ce,It)):(te(i,(Kl<<1)+(s?1:0),3),nh(i,i.l_desc.max_code+1,i.d_desc.max_code+1,r+1),Us(i,i.dyn_ltree,i.dyn_dtree)),Qa(i),s&&Ja(i)},dh=(i,e,t)=>(i.pending_buf[i.sym_buf+i.sym_next++]=e,i.pending_buf[i.sym_buf+i.sym_next++]=e>>8,i.pending_buf[i.sym_buf+i.sym_next++]=t,e===0?i.dyn_ltree[t*2]++:(i.matches++,e--,i.dyn_ltree[(Dt[t]+zt+1)*2]++,i.dyn_dtree[Ka(e)*2]++),i.sym_next===i.sym_end);var uh=oh,ch=en,gh=hh,mh=dh,fh=lh,ph={_tr_init:uh,_tr_stored_block:ch,_tr_flush_block:gh,_tr_tally:mh,_tr_align:fh};const wh=(i,e,t,s)=>{let a=i&65535|0,n=i>>>16&65535|0,r=0;for(;t!==0;){r=t>2e3?2e3:t,t-=r;do a=a+e[s++]|0,n=n+a|0;while(--r);a%=65521,n%=65521}return a|n<<16|0};var Mt=wh;const _h=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var s=0;s<8;s++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},bh=new Uint32Array(_h()),yh=(i,e,t,s)=>{const a=bh,n=s+t;i^=-1;for(let r=s;r<n;r++)i=i>>>8^a[(i^e[r])&255];return i^-1};var $=yh,lt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Bt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:kh,_tr_stored_block:Qi,_tr_flush_block:Eh,_tr_tally:Pe,_tr_align:Th}=ph,{Z_NO_FLUSH:Fe,Z_PARTIAL_FLUSH:Sh,Z_FULL_FLUSH:vh,Z_FINISH:oe,Z_BLOCK:Xs,Z_OK:j,Z_STREAM_END:Hs,Z_STREAM_ERROR:be,Z_DATA_ERROR:Ih,Z_BUF_ERROR:Oi,Z_DEFAULT_COMPRESSION:Ch,Z_FILTERED:Ah,Z_HUFFMAN_ONLY:$t,Z_RLE:Nh,Z_FIXED:Lh,Z_DEFAULT_STRATEGY:Oh,Z_UNKNOWN:Rh,Z_DEFLATED:ki}=Bt,xh=9,Dh=15,Yh=8,Mh=29,Ph=256,Ji=Ph+1+Mh,Fh=30,Uh=19,qh=2*Ji+1,zh=15,x=3,Ye=258,ye=Ye+x+1,Bh=32,ht=42,us=57,es=69,ts=73,is=91,ss=103,He=113,yt=666,ee=1,ct=2,$e=3,gt=4,Xh=3,Ge=(i,e)=>(i.msg=lt[e],e),Gs=i=>i*2-(i>4?9:0),De=i=>{let e=i.length;for(;--e>=0;)i[e]=0},Hh=i=>{let e,t,s,a=i.w_size;e=i.hash_size,s=e;do t=i.head[--s],i.head[s]=t>=a?t-a:0;while(--e);e=a,s=e;do t=i.prev[--s],i.prev[s]=t>=a?t-a:0;while(--e)};let Gh=(i,e,t)=>(e<<i.hash_shift^t)&i.hash_mask,Ue=Gh;const se=i=>{const e=i.state;let t=e.pending;t>i.avail_out&&(t=i.avail_out),t!==0&&(i.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),i.next_out),i.next_out+=t,e.pending_out+=t,i.total_out+=t,i.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},re=(i,e)=>{Eh(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,e),i.block_start=i.strstart,se(i.strm)},Y=(i,e)=>{i.pending_buf[i.pending++]=e},ft=(i,e)=>{i.pending_buf[i.pending++]=e>>>8&255,i.pending_buf[i.pending++]=e&255},as=(i,e,t,s)=>{let a=i.avail_in;return a>s&&(a=s),a===0?0:(i.avail_in-=a,e.set(i.input.subarray(i.next_in,i.next_in+a),t),i.state.wrap===1?i.adler=Mt(i.adler,e,a,t):i.state.wrap===2&&(i.adler=$(i.adler,e,a,t)),i.next_in+=a,i.total_in+=a,a)},tn=(i,e)=>{let t=i.max_chain_length,s=i.strstart,a,n,r=i.prev_length,o=i.nice_match;const h=i.strstart>i.w_size-ye?i.strstart-(i.w_size-ye):0,l=i.window,d=i.w_mask,c=i.prev,u=i.strstart+Ye;let g=l[s+r-1],f=l[s+r];i.prev_length>=i.good_match&&(t>>=2),o>i.lookahead&&(o=i.lookahead);do if(a=e,!(l[a+r]!==f||l[a+r-1]!==g||l[a]!==l[s]||l[++a]!==l[s+1])){s+=2,a++;do;while(l[++s]===l[++a]&&l[++s]===l[++a]&&l[++s]===l[++a]&&l[++s]===l[++a]&&l[++s]===l[++a]&&l[++s]===l[++a]&&l[++s]===l[++a]&&l[++s]===l[++a]&&s<u);if(n=Ye-(u-s),s=u-Ye,n>r){if(i.match_start=e,r=n,n>=o)break;g=l[s+r-1],f=l[s+r]}}while((e=c[e&d])>h&&--t!==0);return r<=i.lookahead?r:i.lookahead},dt=i=>{const e=i.w_size;let t,s,a;do{if(s=i.window_size-i.lookahead-i.strstart,i.strstart>=e+(e-ye)&&(i.window.set(i.window.subarray(e,e+e-s),0),i.match_start-=e,i.strstart-=e,i.block_start-=e,i.insert>i.strstart&&(i.insert=i.strstart),Hh(i),s+=e),i.strm.avail_in===0)break;if(t=as(i.strm,i.window,i.strstart+i.lookahead,s),i.lookahead+=t,i.lookahead+i.insert>=x)for(a=i.strstart-i.insert,i.ins_h=i.window[a],i.ins_h=Ue(i,i.ins_h,i.window[a+1]);i.insert&&(i.ins_h=Ue(i,i.ins_h,i.window[a+x-1]),i.prev[a&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=a,a++,i.insert--,!(i.lookahead+i.insert<x)););}while(i.lookahead<ye&&i.strm.avail_in!==0)},sn=(i,e)=>{let t=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,s,a,n,r=0,o=i.strm.avail_in;do{if(s=65535,n=i.bi_valid+42>>3,i.strm.avail_out<n||(n=i.strm.avail_out-n,a=i.strstart-i.block_start,s>a+i.strm.avail_in&&(s=a+i.strm.avail_in),s>n&&(s=n),s<t&&(s===0&&e!==oe||e===Fe||s!==a+i.strm.avail_in)))break;r=e===oe&&s===a+i.strm.avail_in?1:0,Qi(i,0,0,r),i.pending_buf[i.pending-4]=s,i.pending_buf[i.pending-3]=s>>8,i.pending_buf[i.pending-2]=~s,i.pending_buf[i.pending-1]=~s>>8,se(i.strm),a&&(a>s&&(a=s),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+a),i.strm.next_out),i.strm.next_out+=a,i.strm.avail_out-=a,i.strm.total_out+=a,i.block_start+=a,s-=a),s&&(as(i.strm,i.strm.output,i.strm.next_out,s),i.strm.next_out+=s,i.strm.avail_out-=s,i.strm.total_out+=s)}while(r===0);return o-=i.strm.avail_in,o&&(o>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=o&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-o,i.strm.next_in),i.strstart),i.strstart+=o,i.insert+=o>i.w_size-i.insert?i.w_size-i.insert:o),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),r?gt:e!==Fe&&e!==oe&&i.strm.avail_in===0&&i.strstart===i.block_start?ct:(n=i.window_size-i.strstart,i.strm.avail_in>n&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,n+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),n>i.strm.avail_in&&(n=i.strm.avail_in),n&&(as(i.strm,i.window,i.strstart,n),i.strstart+=n,i.insert+=n>i.w_size-i.insert?i.w_size-i.insert:n),i.high_water<i.strstart&&(i.high_water=i.strstart),n=i.bi_valid+42>>3,n=i.pending_buf_size-n>65535?65535:i.pending_buf_size-n,t=n>i.w_size?i.w_size:n,a=i.strstart-i.block_start,(a>=t||(a||e===oe)&&e!==Fe&&i.strm.avail_in===0&&a<=n)&&(s=a>n?n:a,r=e===oe&&i.strm.avail_in===0&&s===a?1:0,Qi(i,i.block_start,s,r),i.block_start+=s,se(i.strm)),r?$e:ee)},Ri=(i,e)=>{let t,s;for(;;){if(i.lookahead<ye){if(dt(i),i.lookahead<ye&&e===Fe)return ee;if(i.lookahead===0)break}if(t=0,i.lookahead>=x&&(i.ins_h=Ue(i,i.ins_h,i.window[i.strstart+x-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),t!==0&&i.strstart-t<=i.w_size-ye&&(i.match_length=tn(i,t)),i.match_length>=x)if(s=Pe(i,i.strstart-i.match_start,i.match_length-x),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=x){i.match_length--;do i.strstart++,i.ins_h=Ue(i,i.ins_h,i.window[i.strstart+x-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Ue(i,i.ins_h,i.window[i.strstart+1]);else s=Pe(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(s&&(re(i,!1),i.strm.avail_out===0))return ee}return i.insert=i.strstart<x-1?i.strstart:x-1,e===oe?(re(i,!0),i.strm.avail_out===0?$e:gt):i.sym_next&&(re(i,!1),i.strm.avail_out===0)?ee:ct},it=(i,e)=>{let t,s,a;for(;;){if(i.lookahead<ye){if(dt(i),i.lookahead<ye&&e===Fe)return ee;if(i.lookahead===0)break}if(t=0,i.lookahead>=x&&(i.ins_h=Ue(i,i.ins_h,i.window[i.strstart+x-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=x-1,t!==0&&i.prev_length<i.max_lazy_match&&i.strstart-t<=i.w_size-ye&&(i.match_length=tn(i,t),i.match_length<=5&&(i.strategy===Ah||i.match_length===x&&i.strstart-i.match_start>4096)&&(i.match_length=x-1)),i.prev_length>=x&&i.match_length<=i.prev_length){a=i.strstart+i.lookahead-x,s=Pe(i,i.strstart-1-i.prev_match,i.prev_length-x),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=a&&(i.ins_h=Ue(i,i.ins_h,i.window[i.strstart+x-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=x-1,i.strstart++,s&&(re(i,!1),i.strm.avail_out===0))return ee}else if(i.match_available){if(s=Pe(i,0,i.window[i.strstart-1]),s&&re(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return ee}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(s=Pe(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<x-1?i.strstart:x-1,e===oe?(re(i,!0),i.strm.avail_out===0?$e:gt):i.sym_next&&(re(i,!1),i.strm.avail_out===0)?ee:ct},Vh=(i,e)=>{let t,s,a,n;const r=i.window;for(;;){if(i.lookahead<=Ye){if(dt(i),i.lookahead<=Ye&&e===Fe)return ee;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=x&&i.strstart>0&&(a=i.strstart-1,s=r[a],s===r[++a]&&s===r[++a]&&s===r[++a])){n=i.strstart+Ye;do;while(s===r[++a]&&s===r[++a]&&s===r[++a]&&s===r[++a]&&s===r[++a]&&s===r[++a]&&s===r[++a]&&s===r[++a]&&a<n);i.match_length=Ye-(n-a),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=x?(t=Pe(i,1,i.match_length-x),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(t=Pe(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),t&&(re(i,!1),i.strm.avail_out===0))return ee}return i.insert=0,e===oe?(re(i,!0),i.strm.avail_out===0?$e:gt):i.sym_next&&(re(i,!1),i.strm.avail_out===0)?ee:ct},Wh=(i,e)=>{let t;for(;;){if(i.lookahead===0&&(dt(i),i.lookahead===0)){if(e===Fe)return ee;break}if(i.match_length=0,t=Pe(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,t&&(re(i,!1),i.strm.avail_out===0))return ee}return i.insert=0,e===oe?(re(i,!0),i.strm.avail_out===0?$e:gt):i.sym_next&&(re(i,!1),i.strm.avail_out===0)?ee:ct};function fe(i,e,t,s,a){this.good_length=i,this.max_lazy=e,this.nice_length=t,this.max_chain=s,this.func=a}const kt=[new fe(0,0,0,0,sn),new fe(4,4,8,4,Ri),new fe(4,5,16,8,Ri),new fe(4,6,32,32,Ri),new fe(4,4,16,16,it),new fe(8,16,32,32,it),new fe(8,16,128,128,it),new fe(8,32,128,256,it),new fe(32,128,258,1024,it),new fe(32,258,258,4096,it)],$h=i=>{i.window_size=2*i.w_size,De(i.head),i.max_lazy_match=kt[i.level].max_lazy,i.good_match=kt[i.level].good_length,i.nice_match=kt[i.level].nice_length,i.max_chain_length=kt[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=x-1,i.match_available=0,i.ins_h=0};function Kh(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ki,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(qh*2),this.dyn_dtree=new Uint16Array((2*Fh+1)*2),this.bl_tree=new Uint16Array((2*Uh+1)*2),De(this.dyn_ltree),De(this.dyn_dtree),De(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(zh+1),this.heap=new Uint16Array(2*Ji+1),De(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ji+1),De(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Xt=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.status!==ht&&e.status!==us&&e.status!==es&&e.status!==ts&&e.status!==is&&e.status!==ss&&e.status!==He&&e.status!==yt?1:0},an=i=>{if(Xt(i))return Ge(i,be);i.total_in=i.total_out=0,i.data_type=Rh;const e=i.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?us:e.wrap?ht:He,i.adler=e.wrap===2?0:1,e.last_flush=-2,kh(e),j},nn=i=>{const e=an(i);return e===j&&$h(i.state),e},jh=(i,e)=>Xt(i)||i.state.wrap!==2?be:(i.state.gzhead=e,j),rn=(i,e,t,s,a,n)=>{if(!i)return be;let r=1;if(e===Ch&&(e=6),s<0?(r=0,s=-s):s>15&&(r=2,s-=16),a<1||a>xh||t!==ki||s<8||s>15||e<0||e>9||n<0||n>Lh||s===8&&r!==1)return Ge(i,be);s===8&&(s=9);const o=new Kh;return i.state=o,o.strm=i,o.status=ht,o.wrap=r,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+x-1)/x),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=n,o.method=t,nn(i)},Zh=(i,e)=>rn(i,e,ki,Dh,Yh,Oh),Qh=(i,e)=>{if(Xt(i)||e>Xs||e<0)return i?Ge(i,be):be;const t=i.state;if(!i.output||i.avail_in!==0&&!i.input||t.status===yt&&e!==oe)return Ge(i,i.avail_out===0?Oi:be);const s=t.last_flush;if(t.last_flush=e,t.pending!==0){if(se(i),i.avail_out===0)return t.last_flush=-1,j}else if(i.avail_in===0&&Gs(e)<=Gs(s)&&e!==oe)return Ge(i,Oi);if(t.status===yt&&i.avail_in!==0)return Ge(i,Oi);if(t.status===ht&&t.wrap===0&&(t.status=He),t.status===ht){let a=ki+(t.w_bits-8<<4)<<8,n=-1;if(t.strategy>=$t||t.level<2?n=0:t.level<6?n=1:t.level===6?n=2:n=3,a|=n<<6,t.strstart!==0&&(a|=Bh),a+=31-a%31,ft(t,a),t.strstart!==0&&(ft(t,i.adler>>>16),ft(t,i.adler&65535)),i.adler=1,t.status=He,se(i),t.pending!==0)return t.last_flush=-1,j}if(t.status===us){if(i.adler=0,Y(t,31),Y(t,139),Y(t,8),t.gzhead)Y(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),Y(t,t.gzhead.time&255),Y(t,t.gzhead.time>>8&255),Y(t,t.gzhead.time>>16&255),Y(t,t.gzhead.time>>24&255),Y(t,t.level===9?2:t.strategy>=$t||t.level<2?4:0),Y(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(Y(t,t.gzhead.extra.length&255),Y(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(i.adler=$(i.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=es;else if(Y(t,0),Y(t,0),Y(t,0),Y(t,0),Y(t,0),Y(t,t.level===9?2:t.strategy>=$t||t.level<2?4:0),Y(t,Xh),t.status=He,se(i),t.pending!==0)return t.last_flush=-1,j}if(t.status===es){if(t.gzhead.extra){let a=t.pending,n=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+n>t.pending_buf_size;){let o=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+o),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>a&&(i.adler=$(i.adler,t.pending_buf,t.pending-a,a)),t.gzindex+=o,se(i),t.pending!==0)return t.last_flush=-1,j;a=0,n-=o}let r=new Uint8Array(t.gzhead.extra);t.pending_buf.set(r.subarray(t.gzindex,t.gzindex+n),t.pending),t.pending+=n,t.gzhead.hcrc&&t.pending>a&&(i.adler=$(i.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=ts}if(t.status===ts){if(t.gzhead.name){let a=t.pending,n;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(i.adler=$(i.adler,t.pending_buf,t.pending-a,a)),se(i),t.pending!==0)return t.last_flush=-1,j;a=0}t.gzindex<t.gzhead.name.length?n=t.gzhead.name.charCodeAt(t.gzindex++)&255:n=0,Y(t,n)}while(n!==0);t.gzhead.hcrc&&t.pending>a&&(i.adler=$(i.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=is}if(t.status===is){if(t.gzhead.comment){let a=t.pending,n;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(i.adler=$(i.adler,t.pending_buf,t.pending-a,a)),se(i),t.pending!==0)return t.last_flush=-1,j;a=0}t.gzindex<t.gzhead.comment.length?n=t.gzhead.comment.charCodeAt(t.gzindex++)&255:n=0,Y(t,n)}while(n!==0);t.gzhead.hcrc&&t.pending>a&&(i.adler=$(i.adler,t.pending_buf,t.pending-a,a))}t.status=ss}if(t.status===ss){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(se(i),t.pending!==0))return t.last_flush=-1,j;Y(t,i.adler&255),Y(t,i.adler>>8&255),i.adler=0}if(t.status=He,se(i),t.pending!==0)return t.last_flush=-1,j}if(i.avail_in!==0||t.lookahead!==0||e!==Fe&&t.status!==yt){let a=t.level===0?sn(t,e):t.strategy===$t?Wh(t,e):t.strategy===Nh?Vh(t,e):kt[t.level].func(t,e);if((a===$e||a===gt)&&(t.status=yt),a===ee||a===$e)return i.avail_out===0&&(t.last_flush=-1),j;if(a===ct&&(e===Sh?Th(t):e!==Xs&&(Qi(t,0,0,!1),e===vh&&(De(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),se(i),i.avail_out===0))return t.last_flush=-1,j}return e!==oe?j:t.wrap<=0?Hs:(t.wrap===2?(Y(t,i.adler&255),Y(t,i.adler>>8&255),Y(t,i.adler>>16&255),Y(t,i.adler>>24&255),Y(t,i.total_in&255),Y(t,i.total_in>>8&255),Y(t,i.total_in>>16&255),Y(t,i.total_in>>24&255)):(ft(t,i.adler>>>16),ft(t,i.adler&65535)),se(i),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?j:Hs)},Jh=i=>{if(Xt(i))return be;const e=i.state.status;return i.state=null,e===He?Ge(i,Ih):j},ed=(i,e)=>{let t=e.length;if(Xt(i))return be;const s=i.state,a=s.wrap;if(a===2||a===1&&s.status!==ht||s.lookahead)return be;if(a===1&&(i.adler=Mt(i.adler,e,t,0)),s.wrap=0,t>=s.w_size){a===0&&(De(s.head),s.strstart=0,s.block_start=0,s.insert=0);let h=new Uint8Array(s.w_size);h.set(e.subarray(t-s.w_size,t),0),e=h,t=s.w_size}const n=i.avail_in,r=i.next_in,o=i.input;for(i.avail_in=t,i.next_in=0,i.input=e,dt(s);s.lookahead>=x;){let h=s.strstart,l=s.lookahead-(x-1);do s.ins_h=Ue(s,s.ins_h,s.window[h+x-1]),s.prev[h&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=h,h++;while(--l);s.strstart=h,s.lookahead=x-1,dt(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=x-1,s.match_available=0,i.next_in=r,i.input=o,i.avail_in=n,s.wrap=a,j};var td=Zh,id=rn,sd=nn,ad=an,nd=jh,rd=Qh,od=Jh,ld=ed,hd="pako deflate (from Nodeca project)",Ct={deflateInit:td,deflateInit2:id,deflateReset:sd,deflateResetKeep:ad,deflateSetHeader:nd,deflate:rd,deflateEnd:od,deflateSetDictionary:ld,deflateInfo:hd};const dd=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var ud=function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const s in t)dd(t,s)&&(i[s]=t[s])}}return i},cd=i=>{let e=0;for(let s=0,a=i.length;s<a;s++)e+=i[s].length;const t=new Uint8Array(e);for(let s=0,a=0,n=i.length;s<n;s++){let r=i[s];t.set(r,a),a+=r.length}return t},Ei={assign:ud,flattenChunks:cd};let on=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{on=!1}const Pt=new Uint8Array(256);for(let i=0;i<256;i++)Pt[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;Pt[254]=Pt[254]=1;var gd=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,s,a,n,r=i.length,o=0;for(a=0;a<r;a++)t=i.charCodeAt(a),(t&64512)===55296&&a+1<r&&(s=i.charCodeAt(a+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),a++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),n=0,a=0;n<o;a++)t=i.charCodeAt(a),(t&64512)===55296&&a+1<r&&(s=i.charCodeAt(a+1),(s&64512)===56320&&(t=65536+(t-55296<<10)+(s-56320),a++)),t<128?e[n++]=t:t<2048?(e[n++]=192|t>>>6,e[n++]=128|t&63):t<65536?(e[n++]=224|t>>>12,e[n++]=128|t>>>6&63,e[n++]=128|t&63):(e[n++]=240|t>>>18,e[n++]=128|t>>>12&63,e[n++]=128|t>>>6&63,e[n++]=128|t&63);return e};const md=(i,e)=>{if(e<65534&&i.subarray&&on)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let s=0;s<e;s++)t+=String.fromCharCode(i[s]);return t};var fd=(i,e)=>{const t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let s,a;const n=new Array(t*2);for(a=0,s=0;s<t;){let r=i[s++];if(r<128){n[a++]=r;continue}let o=Pt[r];if(o>4){n[a++]=65533,s+=o-1;continue}for(r&=o===2?31:o===3?15:7;o>1&&s<t;)r=r<<6|i[s++]&63,o--;if(o>1){n[a++]=65533;continue}r<65536?n[a++]=r:(r-=65536,n[a++]=55296|r>>10&1023,n[a++]=56320|r&1023)}return md(n,a)},pd=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+Pt[i[t]]>e?t:e},Ft={string2buf:gd,buf2string:fd,utf8border:pd};function wd(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ln=wd;const hn=Object.prototype.toString,{Z_NO_FLUSH:_d,Z_SYNC_FLUSH:bd,Z_FULL_FLUSH:yd,Z_FINISH:kd,Z_OK:wi,Z_STREAM_END:Ed,Z_DEFAULT_COMPRESSION:Td,Z_DEFAULT_STRATEGY:Sd,Z_DEFLATED:vd}=Bt;function cs(i){this.options=Ei.assign({level:Td,method:vd,chunkSize:16384,windowBits:15,memLevel:8,strategy:Sd},i||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ln,this.strm.avail_out=0;let t=Ct.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==wi)throw new Error(lt[t]);if(e.header&&Ct.deflateSetHeader(this.strm,e.header),e.dictionary){let s;if(typeof e.dictionary=="string"?s=Ft.string2buf(e.dictionary):hn.call(e.dictionary)==="[object ArrayBuffer]"?s=new Uint8Array(e.dictionary):s=e.dictionary,t=Ct.deflateSetDictionary(this.strm,s),t!==wi)throw new Error(lt[t]);this._dict_set=!0}}cs.prototype.push=function(i,e){const t=this.strm,s=this.options.chunkSize;let a,n;if(this.ended)return!1;for(e===~~e?n=e:n=e===!0?kd:_d,typeof i=="string"?t.input=Ft.string2buf(i):hn.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),(n===bd||n===yd)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(a=Ct.deflate(t,n),a===Ed)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),a=Ct.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===wi;if(t.avail_out===0){this.onData(t.output);continue}if(n>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};cs.prototype.onData=function(i){this.chunks.push(i)};cs.prototype.onEnd=function(i){i===wi&&(this.result=Ei.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};const Kt=16209,Id=16191;var Cd=function(e,t){let s,a,n,r,o,h,l,d,c,u,g,f,y,k,T,v,S,w,E,M,b,D,O,I;const R=e.state;s=e.next_in,O=e.input,a=s+(e.avail_in-5),n=e.next_out,I=e.output,r=n-(t-e.avail_out),o=n+(e.avail_out-257),h=R.dmax,l=R.wsize,d=R.whave,c=R.wnext,u=R.window,g=R.hold,f=R.bits,y=R.lencode,k=R.distcode,T=(1<<R.lenbits)-1,v=(1<<R.distbits)-1;e:do{f<15&&(g+=O[s++]<<f,f+=8,g+=O[s++]<<f,f+=8),S=y[g&T];t:for(;;){if(w=S>>>24,g>>>=w,f-=w,w=S>>>16&255,w===0)I[n++]=S&65535;else if(w&16){E=S&65535,w&=15,w&&(f<w&&(g+=O[s++]<<f,f+=8),E+=g&(1<<w)-1,g>>>=w,f-=w),f<15&&(g+=O[s++]<<f,f+=8,g+=O[s++]<<f,f+=8),S=k[g&v];i:for(;;){if(w=S>>>24,g>>>=w,f-=w,w=S>>>16&255,w&16){if(M=S&65535,w&=15,f<w&&(g+=O[s++]<<f,f+=8,f<w&&(g+=O[s++]<<f,f+=8)),M+=g&(1<<w)-1,M>h){e.msg="invalid distance too far back",R.mode=Kt;break e}if(g>>>=w,f-=w,w=n-r,M>w){if(w=M-w,w>d&&R.sane){e.msg="invalid distance too far back",R.mode=Kt;break e}if(b=0,D=u,c===0){if(b+=l-w,w<E){E-=w;do I[n++]=u[b++];while(--w);b=n-M,D=I}}else if(c<w){if(b+=l+c-w,w-=c,w<E){E-=w;do I[n++]=u[b++];while(--w);if(b=0,c<E){w=c,E-=w;do I[n++]=u[b++];while(--w);b=n-M,D=I}}}else if(b+=c-w,w<E){E-=w;do I[n++]=u[b++];while(--w);b=n-M,D=I}for(;E>2;)I[n++]=D[b++],I[n++]=D[b++],I[n++]=D[b++],E-=3;E&&(I[n++]=D[b++],E>1&&(I[n++]=D[b++]))}else{b=n-M;do I[n++]=I[b++],I[n++]=I[b++],I[n++]=I[b++],E-=3;while(E>2);E&&(I[n++]=I[b++],E>1&&(I[n++]=I[b++]))}}else if(w&64){e.msg="invalid distance code",R.mode=Kt;break e}else{S=k[(S&65535)+(g&(1<<w)-1)];continue i}break}}else if(w&64)if(w&32){R.mode=Id;break e}else{e.msg="invalid literal/length code",R.mode=Kt;break e}else{S=y[(S&65535)+(g&(1<<w)-1)];continue t}break}}while(s<a&&n<o);E=f>>3,s-=E,f-=E<<3,g&=(1<<f)-1,e.next_in=s,e.next_out=n,e.avail_in=s<a?5+(a-s):5-(s-a),e.avail_out=n<o?257+(o-n):257-(n-o),R.hold=g,R.bits=f};const st=15,Vs=852,Ws=592,$s=0,xi=1,Ks=2,Ad=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Nd=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ld=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Od=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Rd=(i,e,t,s,a,n,r,o)=>{const h=o.bits;let l=0,d=0,c=0,u=0,g=0,f=0,y=0,k=0,T=0,v=0,S,w,E,M,b,D=null,O;const I=new Uint16Array(st+1),R=new Uint16Array(st+1);let ke=null,Oe,me,Ee;for(l=0;l<=st;l++)I[l]=0;for(d=0;d<s;d++)I[e[t+d]]++;for(g=h,u=st;u>=1&&I[u]===0;u--);if(g>u&&(g=u),u===0)return a[n++]=1<<24|64<<16|0,a[n++]=1<<24|64<<16|0,o.bits=1,0;for(c=1;c<u&&I[c]===0;c++);for(g<c&&(g=c),k=1,l=1;l<=st;l++)if(k<<=1,k-=I[l],k<0)return-1;if(k>0&&(i===$s||u!==1))return-1;for(R[1]=0,l=1;l<st;l++)R[l+1]=R[l]+I[l];for(d=0;d<s;d++)e[t+d]!==0&&(r[R[e[t+d]]++]=d);if(i===$s?(D=ke=r,O=20):i===xi?(D=Ad,ke=Nd,O=257):(D=Ld,ke=Od,O=0),v=0,d=0,l=c,b=n,f=g,y=0,E=-1,T=1<<g,M=T-1,i===xi&&T>Vs||i===Ks&&T>Ws)return 1;for(;;){Oe=l-y,r[d]+1<O?(me=0,Ee=r[d]):r[d]>=O?(me=ke[r[d]-O],Ee=D[r[d]-O]):(me=32+64,Ee=0),S=1<<l-y,w=1<<f,c=w;do w-=S,a[b+(v>>y)+w]=Oe<<24|me<<16|Ee|0;while(w!==0);for(S=1<<l-1;v&S;)S>>=1;if(S!==0?(v&=S-1,v+=S):v=0,d++,--I[l]===0){if(l===u)break;l=e[t+r[d]]}if(l>g&&(v&M)!==E){for(y===0&&(y=g),b+=c,f=l-y,k=1<<f;f+y<u&&(k-=I[f+y],!(k<=0));)f++,k<<=1;if(T+=1<<f,i===xi&&T>Vs||i===Ks&&T>Ws)return 1;E=v&M,a[E]=g<<24|f<<16|b-n|0}}return v!==0&&(a[b+v]=l-y<<24|64<<16|0),o.bits=g,0};var At=Rd;const xd=0,dn=1,un=2,{Z_FINISH:js,Z_BLOCK:Dd,Z_TREES:jt,Z_OK:Ke,Z_STREAM_END:Yd,Z_NEED_DICT:Md,Z_STREAM_ERROR:de,Z_DATA_ERROR:cn,Z_MEM_ERROR:gn,Z_BUF_ERROR:Pd,Z_DEFLATED:Zs}=Bt,Ti=16180,Qs=16181,Js=16182,ea=16183,ta=16184,ia=16185,sa=16186,aa=16187,na=16188,ra=16189,_i=16190,Te=16191,Di=16192,oa=16193,Yi=16194,la=16195,ha=16196,da=16197,ua=16198,Zt=16199,Qt=16200,ca=16201,ga=16202,ma=16203,fa=16204,pa=16205,Mi=16206,wa=16207,_a=16208,F=16209,mn=16210,fn=16211,Fd=852,Ud=592,qd=15,zd=qd,ba=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function Bd(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ze=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<Ti||e.mode>fn?1:0},pn=i=>{if(Ze(i))return de;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=Ti,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Fd),e.distcode=e.distdyn=new Int32Array(Ud),e.sane=1,e.back=-1,Ke},wn=i=>{if(Ze(i))return de;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,pn(i)},_n=(i,e)=>{let t;if(Ze(i))return de;const s=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?de:(s.window!==null&&s.wbits!==e&&(s.window=null),s.wrap=t,s.wbits=e,wn(i))},bn=(i,e)=>{if(!i)return de;const t=new Bd;i.state=t,t.strm=i,t.window=null,t.mode=Ti;const s=_n(i,e);return s!==Ke&&(i.state=null),s},Xd=i=>bn(i,zd);let ya=!0,Pi,Fi;const Hd=i=>{if(ya){Pi=new Int32Array(512),Fi=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(At(dn,i.lens,0,288,Pi,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;At(un,i.lens,0,32,Fi,0,i.work,{bits:5}),ya=!1}i.lencode=Pi,i.lenbits=9,i.distcode=Fi,i.distbits=5},yn=(i,e,t,s)=>{let a;const n=i.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),s>=n.wsize?(n.window.set(e.subarray(t-n.wsize,t),0),n.wnext=0,n.whave=n.wsize):(a=n.wsize-n.wnext,a>s&&(a=s),n.window.set(e.subarray(t-s,t-s+a),n.wnext),s-=a,s?(n.window.set(e.subarray(t-s,t),0),n.wnext=s,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0},Gd=(i,e)=>{let t,s,a,n,r,o,h,l,d,c,u,g,f,y,k=0,T,v,S,w,E,M,b,D;const O=new Uint8Array(4);let I,R;const ke=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ze(i)||!i.output||!i.input&&i.avail_in!==0)return de;t=i.state,t.mode===Te&&(t.mode=Di),r=i.next_out,a=i.output,h=i.avail_out,n=i.next_in,s=i.input,o=i.avail_in,l=t.hold,d=t.bits,c=o,u=h,D=Ke;e:for(;;)switch(t.mode){case Ti:if(t.wrap===0){t.mode=Di;break}for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,O[0]=l&255,O[1]=l>>>8&255,t.check=$(t.check,O,2,0),l=0,d=0,t.mode=Qs;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){i.msg="incorrect header check",t.mode=F;break}if((l&15)!==Zs){i.msg="unknown compression method",t.mode=F;break}if(l>>>=4,d-=4,b=(l&15)+8,t.wbits===0&&(t.wbits=b),b>15||b>t.wbits){i.msg="invalid window size",t.mode=F;break}t.dmax=1<<t.wbits,t.flags=0,i.adler=t.check=1,t.mode=l&512?ra:Te,l=0,d=0;break;case Qs:for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.flags=l,(t.flags&255)!==Zs){i.msg="unknown compression method",t.mode=F;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=F;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,t.check=$(t.check,O,2,0)),l=0,d=0,t.mode=Js;case Js:for(;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,O[2]=l>>>16&255,O[3]=l>>>24&255,t.check=$(t.check,O,4,0)),l=0,d=0,t.mode=ea;case ea:for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,t.check=$(t.check,O,2,0)),l=0,d=0,t.mode=ta;case ta:if(t.flags&1024){for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(O[0]=l&255,O[1]=l>>>8&255,t.check=$(t.check,O,2,0)),l=0,d=0}else t.head&&(t.head.extra=null);t.mode=ia;case ia:if(t.flags&1024&&(g=t.length,g>o&&(g=o),g&&(t.head&&(b=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(s.subarray(n,n+g),b)),t.flags&512&&t.wrap&4&&(t.check=$(t.check,s,g,n)),o-=g,n+=g,t.length-=g),t.length))break e;t.length=0,t.mode=sa;case sa:if(t.flags&2048){if(o===0)break e;g=0;do b=s[n+g++],t.head&&b&&t.length<65536&&(t.head.name+=String.fromCharCode(b));while(b&&g<o);if(t.flags&512&&t.wrap&4&&(t.check=$(t.check,s,g,n)),o-=g,n+=g,b)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=aa;case aa:if(t.flags&4096){if(o===0)break e;g=0;do b=s[n+g++],t.head&&b&&t.length<65536&&(t.head.comment+=String.fromCharCode(b));while(b&&g<o);if(t.flags&512&&t.wrap&4&&(t.check=$(t.check,s,g,n)),o-=g,n+=g,b)break e}else t.head&&(t.head.comment=null);t.mode=na;case na:if(t.flags&512){for(;d<16;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.wrap&4&&l!==(t.check&65535)){i.msg="header crc mismatch",t.mode=F;break}l=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=Te;break;case ra:for(;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}i.adler=t.check=ba(l),l=0,d=0,t.mode=_i;case _i:if(t.havedict===0)return i.next_out=r,i.avail_out=h,i.next_in=n,i.avail_in=o,t.hold=l,t.bits=d,Md;i.adler=t.check=1,t.mode=Te;case Te:if(e===Dd||e===jt)break e;case Di:if(t.last){l>>>=d&7,d-=d&7,t.mode=Mi;break}for(;d<3;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}switch(t.last=l&1,l>>>=1,d-=1,l&3){case 0:t.mode=oa;break;case 1:if(Hd(t),t.mode=Zt,e===jt){l>>>=2,d-=2;break e}break;case 2:t.mode=ha;break;case 3:i.msg="invalid block type",t.mode=F}l>>>=2,d-=2;break;case oa:for(l>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if((l&65535)!==(l>>>16^65535)){i.msg="invalid stored block lengths",t.mode=F;break}if(t.length=l&65535,l=0,d=0,t.mode=Yi,e===jt)break e;case Yi:t.mode=la;case la:if(g=t.length,g){if(g>o&&(g=o),g>h&&(g=h),g===0)break e;a.set(s.subarray(n,n+g),r),o-=g,n+=g,h-=g,r+=g,t.length-=g;break}t.mode=Te;break;case ha:for(;d<14;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.nlen=(l&31)+257,l>>>=5,d-=5,t.ndist=(l&31)+1,l>>>=5,d-=5,t.ncode=(l&15)+4,l>>>=4,d-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=F;break}t.have=0,t.mode=da;case da:for(;t.have<t.ncode;){for(;d<3;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.lens[ke[t.have++]]=l&7,l>>>=3,d-=3}for(;t.have<19;)t.lens[ke[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,I={bits:t.lenbits},D=At(xd,t.lens,0,19,t.lencode,0,t.work,I),t.lenbits=I.bits,D){i.msg="invalid code lengths set",t.mode=F;break}t.have=0,t.mode=ua;case ua:for(;t.have<t.nlen+t.ndist;){for(;k=t.lencode[l&(1<<t.lenbits)-1],T=k>>>24,v=k>>>16&255,S=k&65535,!(T<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(S<16)l>>>=T,d-=T,t.lens[t.have++]=S;else{if(S===16){for(R=T+2;d<R;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(l>>>=T,d-=T,t.have===0){i.msg="invalid bit length repeat",t.mode=F;break}b=t.lens[t.have-1],g=3+(l&3),l>>>=2,d-=2}else if(S===17){for(R=T+3;d<R;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=T,d-=T,b=0,g=3+(l&7),l>>>=3,d-=3}else{for(R=T+7;d<R;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=T,d-=T,b=0,g=11+(l&127),l>>>=7,d-=7}if(t.have+g>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=F;break}for(;g--;)t.lens[t.have++]=b}}if(t.mode===F)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=F;break}if(t.lenbits=9,I={bits:t.lenbits},D=At(dn,t.lens,0,t.nlen,t.lencode,0,t.work,I),t.lenbits=I.bits,D){i.msg="invalid literal/lengths set",t.mode=F;break}if(t.distbits=6,t.distcode=t.distdyn,I={bits:t.distbits},D=At(un,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,I),t.distbits=I.bits,D){i.msg="invalid distances set",t.mode=F;break}if(t.mode=Zt,e===jt)break e;case Zt:t.mode=Qt;case Qt:if(o>=6&&h>=258){i.next_out=r,i.avail_out=h,i.next_in=n,i.avail_in=o,t.hold=l,t.bits=d,Cd(i,u),r=i.next_out,a=i.output,h=i.avail_out,n=i.next_in,s=i.input,o=i.avail_in,l=t.hold,d=t.bits,t.mode===Te&&(t.back=-1);break}for(t.back=0;k=t.lencode[l&(1<<t.lenbits)-1],T=k>>>24,v=k>>>16&255,S=k&65535,!(T<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(v&&!(v&240)){for(w=T,E=v,M=S;k=t.lencode[M+((l&(1<<w+E)-1)>>w)],T=k>>>24,v=k>>>16&255,S=k&65535,!(w+T<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=w,d-=w,t.back+=w}if(l>>>=T,d-=T,t.back+=T,t.length=S,v===0){t.mode=pa;break}if(v&32){t.back=-1,t.mode=Te;break}if(v&64){i.msg="invalid literal/length code",t.mode=F;break}t.extra=v&15,t.mode=ca;case ca:if(t.extra){for(R=t.extra;d<R;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=ga;case ga:for(;k=t.distcode[l&(1<<t.distbits)-1],T=k>>>24,v=k>>>16&255,S=k&65535,!(T<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(!(v&240)){for(w=T,E=v,M=S;k=t.distcode[M+((l&(1<<w+E)-1)>>w)],T=k>>>24,v=k>>>16&255,S=k&65535,!(w+T<=d);){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}l>>>=w,d-=w,t.back+=w}if(l>>>=T,d-=T,t.back+=T,v&64){i.msg="invalid distance code",t.mode=F;break}t.offset=S,t.extra=v&15,t.mode=ma;case ma:if(t.extra){for(R=t.extra;d<R;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=F;break}t.mode=fa;case fa:if(h===0)break e;if(g=u-h,t.offset>g){if(g=t.offset-g,g>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=F;break}g>t.wnext?(g-=t.wnext,f=t.wsize-g):f=t.wnext-g,g>t.length&&(g=t.length),y=t.window}else y=a,f=r-t.offset,g=t.length;g>h&&(g=h),h-=g,t.length-=g;do a[r++]=y[f++];while(--g);t.length===0&&(t.mode=Qt);break;case pa:if(h===0)break e;a[r++]=t.length,h--,t.mode=Qt;break;case Mi:if(t.wrap){for(;d<32;){if(o===0)break e;o--,l|=s[n++]<<d,d+=8}if(u-=h,i.total_out+=u,t.total+=u,t.wrap&4&&u&&(i.adler=t.check=t.flags?$(t.check,a,u,r-u):Mt(t.check,a,u,r-u)),u=h,t.wrap&4&&(t.flags?l:ba(l))!==t.check){i.msg="incorrect data check",t.mode=F;break}l=0,d=0}t.mode=wa;case wa:if(t.wrap&&t.flags){for(;d<32;){if(o===0)break e;o--,l+=s[n++]<<d,d+=8}if(t.wrap&4&&l!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=F;break}l=0,d=0}t.mode=_a;case _a:D=Yd;break e;case F:D=cn;break e;case mn:return gn;case fn:default:return de}return i.next_out=r,i.avail_out=h,i.next_in=n,i.avail_in=o,t.hold=l,t.bits=d,(t.wsize||u!==i.avail_out&&t.mode<F&&(t.mode<Mi||e!==js))&&yn(i,i.output,i.next_out,u-i.avail_out),c-=i.avail_in,u-=i.avail_out,i.total_in+=c,i.total_out+=u,t.total+=u,t.wrap&4&&u&&(i.adler=t.check=t.flags?$(t.check,a,u,i.next_out-u):Mt(t.check,a,u,i.next_out-u)),i.data_type=t.bits+(t.last?64:0)+(t.mode===Te?128:0)+(t.mode===Zt||t.mode===Yi?256:0),(c===0&&u===0||e===js)&&D===Ke&&(D=Pd),D},Vd=i=>{if(Ze(i))return de;let e=i.state;return e.window&&(e.window=null),i.state=null,Ke},Wd=(i,e)=>{if(Ze(i))return de;const t=i.state;return t.wrap&2?(t.head=e,e.done=!1,Ke):de},$d=(i,e)=>{const t=e.length;let s,a,n;return Ze(i)||(s=i.state,s.wrap!==0&&s.mode!==_i)?de:s.mode===_i&&(a=1,a=Mt(a,e,t,0),a!==s.check)?cn:(n=yn(i,e,t,t),n?(s.mode=mn,gn):(s.havedict=1,Ke))};var Kd=wn,jd=_n,Zd=pn,Qd=Xd,Jd=bn,eu=Gd,tu=Vd,iu=Wd,su=$d,au="pako inflate (from Nodeca project)",Ae={inflateReset:Kd,inflateReset2:jd,inflateResetKeep:Zd,inflateInit:Qd,inflateInit2:Jd,inflate:eu,inflateEnd:tu,inflateGetHeader:iu,inflateSetDictionary:su,inflateInfo:au};function nu(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ru=nu;const kn=Object.prototype.toString,{Z_NO_FLUSH:ou,Z_FINISH:lu,Z_OK:Ut,Z_STREAM_END:Ui,Z_NEED_DICT:qi,Z_STREAM_ERROR:hu,Z_DATA_ERROR:ka,Z_MEM_ERROR:du}=Bt;function Ht(i){this.options=Ei.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ln,this.strm.avail_out=0;let t=Ae.inflateInit2(this.strm,e.windowBits);if(t!==Ut)throw new Error(lt[t]);if(this.header=new ru,Ae.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Ft.string2buf(e.dictionary):kn.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Ae.inflateSetDictionary(this.strm,e.dictionary),t!==Ut)))throw new Error(lt[t])}Ht.prototype.push=function(i,e){const t=this.strm,s=this.options.chunkSize,a=this.options.dictionary;let n,r,o;if(this.ended)return!1;for(e===~~e?r=e:r=e===!0?lu:ou,kn.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(s),t.next_out=0,t.avail_out=s),n=Ae.inflate(t,r),n===qi&&a&&(n=Ae.inflateSetDictionary(t,a),n===Ut?n=Ae.inflate(t,r):n===ka&&(n=qi));t.avail_in>0&&n===Ui&&t.state.wrap>0&&i[t.next_in]!==0;)Ae.inflateReset(t),n=Ae.inflate(t,r);switch(n){case hu:case ka:case qi:case du:return this.onEnd(n),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||n===Ui))if(this.options.to==="string"){let h=Ft.utf8border(t.output,t.next_out),l=t.next_out-h,d=Ft.buf2string(t.output,h);t.next_out=l,t.avail_out=s-l,l&&t.output.set(t.output.subarray(h,h+l),0),this.onData(d)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(n===Ut&&o===0)){if(n===Ui)return n=Ae.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Ht.prototype.onData=function(i){this.chunks.push(i)};Ht.prototype.onEnd=function(i){i===Ut&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ei.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function gs(i,e){const t=new Ht(e);if(t.push(i),t.err)throw t.msg||lt[t.err];return t.result}function uu(i,e){return e=e||{},e.raw=!0,gs(i,e)}var cu=Ht,gu=gs,mu=uu,fu=gs,pu=Bt,wu={Inflate:cu,inflate:gu,inflateRaw:mu,ungzip:fu,constants:pu};const{Inflate:Ku,inflate:_u,inflateRaw:ju,ungzip:Zu}=wu;var bu=_u;class yu{constructor(e){this.game=e,this.app=e.app,this.overlays=e.overlays,this.info=e.info,this.map=e.map,this.camera=e.camera,this.renderer=e.renderer,this.input=e.input,this.socket=e.socket,this.pointer=e.pointer,this.audio=e.audio,this.entities=e.entities,this.bubble=e.bubble,this.menu=e.menu,this.sprites=e.sprites,this.messages=this.socket.messages,this.app.onFocus(()=>{Date.now()-this.lastEntityListRequest<4e3||(this.socket.send(p.Focus),this.lastEntityListRequest=Date.now())}),this.messages.onConnected(this.handleConnected.bind(this)),this.messages.onHandshake(this.handleHandshake.bind(this)),this.messages.onWelcome(this.handleWelcome.bind(this)),this.messages.onMap(this.handleMap.bind(this)),this.messages.onEquipment(this.handleEquipment.bind(this)),this.messages.onSpawn(this.entities.create.bind(this.entities)),this.messages.onEntityList(this.handleEntityList.bind(this)),this.messages.onSync(this.handleSync.bind(this)),this.messages.onMovement(this.handleMovement.bind(this)),this.messages.onTeleport(this.handleTeleport.bind(this)),this.messages.onDespawn(this.handleDespawn.bind(this)),this.messages.onCombat(this.handleCombat.bind(this)),this.messages.onAnimation(this.handleAnimation.bind(this)),this.messages.onPoints(this.handlePoints.bind(this)),this.messages.onNetwork(this.handleNetwork.bind(this)),this.messages.onChat(this.handleChat.bind(this)),this.messages.onCommand(this.handleCommand.bind(this)),this.messages.onContainer(this.handleContainer.bind(this)),this.messages.onAbility(this.handleAbility.bind(this)),this.messages.onQuest(this.handleQuest.bind(this)),this.messages.onAchievement(this.handleAchievement.bind(this)),this.messages.onNotification(this.handleNotification.bind(this)),this.messages.onBlink(this.handleBlink.bind(this)),this.messages.onHeal(this.handleHeal.bind(this)),this.messages.onExperience(this.handleExperience.bind(this)),this.messages.onDeath(this.handleDeath.bind(this)),this.messages.onMusic(this.handleMusic.bind(this)),this.messages.onNPC(this.handleNPC.bind(this)),this.messages.onRespawn(this.handleRespawn.bind(this)),this.messages.onTrade(this.handleTrade.bind(this)),this.messages.onEnchant(this.handleEnchant.bind(this)),this.messages.onGuild(this.handleGuild.bind(this)),this.messages.onPointer(this.handlePointer.bind(this)),this.messages.onPVP(this.handlePVP.bind(this)),this.messages.onPoison(this.handlePoison.bind(this)),this.messages.onStore(this.handleStore.bind(this)),this.messages.onOverlay(this.handleOverlay.bind(this)),this.messages.onCamera(this.handleCamera.bind(this)),this.messages.onBubble(this.handleBubble.bind(this)),this.messages.onSkill(this.handleSkill.bind(this)),this.messages.onUpdate(this.handleUpdate.bind(this)),this.messages.onMinigame(this.handleMinigame.bind(this)),this.messages.onEffect(this.handleEffect.bind(this)),this.messages.onFriends(this.handleFriends.bind(this)),this.messages.onRank(this.handleRank.bind(this)),this.messages.onCrafting(this.handleCrafting.bind(this)),this.messages.onInterface(this.handleInterface.bind(this)),this.messages.onLootBag(this.handleLootBag.bind(this)),this.messages.onCountdown(this.handleCountdown.bind(this)),this.messages.onResource(this.handleResource.bind(this))}app;overlays;info;map;camera;renderer;input;socket;pointer;audio;entities;bubble;menu;sprites;messages;lastEntityListRequest=Date.now();handleConnected(){this.socket.send(p.Handshake,{gVer:this.app.config.version})}handleHandshake(e){if(e.type!=="client"){this.app.updateLoader("Invalid client");return}if(this.app.updateLoader("Connecting to server"),this.game.timeOffset=~~performance.now()-e.serverTime,this.game.player.instance=e.instance,this.game.player.serverId=e.serverId,this.app.isGuest())return this.socket.send(p.Login,{opcode:Jt.Guest});let t=this.app.getUsername(),s=this.app.getPassword(),a=this.app.getEmail();if(this.game.player.name=t.toLowerCase(),this.app.isRegistering())return this.socket.send(p.Login,{opcode:Jt.Register,username:t,password:s,email:a});this.socket.send(p.Login,{opcode:Jt.Login,username:t,password:s})}handleWelcome(e){this.game.player.load(e),this.game.start(),this.game.postLoad()}handleMap(e){let t=window.atob(e).split("").map(n=>n.charCodeAt(0)),s=bu(new Uint8Array(t),{to:"string"}),a=JSON.parse(s);this.map.loadRegions(a),this.renderer.forceRendering=!0,this.map.hasCachedDate()||this.app.fadeMenu()}handleEquipment(e,t){switch(e){case Be.Batch:{let{data:s}=t;for(let a of s.equipments)this.game.player.equip(a);break}case Be.Equip:{let{data:s}=t;this.game.player.equip(s);break}case Be.Unequip:{let{type:s,count:a}=t;this.game.player.unequip(s,a);break}case Be.Style:{let{attackRange:s,attackStyle:a}=t;this.game.player.setAttackStyle(a),this.game.player.attackRange=s;break}}this.game.player.sync(),this.renderer.updatePlayerLight()}handleEntityList(e,t){switch(e){case zi.Spawns:{let s=new Set(Object.values(this.entities.getAll()).map(r=>r.instance)),a=new Set(t.entities.filter(r=>s.has(r))),n=t.entities.filter(r=>!a.has(r));this.entities.decrepit=Object.values(this.entities.getAll()).filter(r=>!a.has(r.instance)&&r.instance!==this.game.player.instance),this.entities.clean(),this.socket.send(p.Who,n);break}case zi.Positions:for(let s in t.positions){let a=t.positions[s],n=this.entities.get(s);if(!n||n.hasPath())return;(n.gridX!==a.x||n.gridY!==a.y)&&this.game.teleport(n,a.x,a.y)}}}handleSync(e){let t=this.entities.get(e.instance);!t||t.teleporting||t.dead||!t.ready||(t.load(e,!0),t.setSprite(this.game.sprites.get(t.getSpriteName())),this.renderer.updatePlayerLight(t))}handleMovement(e,t){let s=this.entities.get(t.instance),a;if(!s)return this.canRequestEntityList()?(this.lastEntityListRequest=Date.now(),this.socket.send(p.List)):void 0;switch(e){case ue.Move:{if(t.target===this.game.player.instance&&s.following)return;s.go(t.x,t.y,t.forced,t.instance!==this.game.player.instance);break}case ue.Follow:{if(a=this.entities.get(t.target),a){if(s.instance===this.game.player.instance&&!this.game.player.hasTarget()&&!t.forced)return;s.follow(a),s.isPet()&&a.addFollower(s)}break}case ue.Stop:return s.stop();case ue.Speed:{s.movementSpeed=t.movementSpeed;break}}}handleTeleport(e){let t=this.entities.get(e.instance);if(!t?.isMob()&&!t?.isPlayer())return;this.input.selectedCellVisible=!1;let s=t.instance===this.game.player.instance;if(t.stop(!0),t.frozen=!0,s?(this.bubble.clean(),this.game.player.disableAction=!0):this.bubble.clear(t.instance),!e.withAnimation)return this.game.teleport(t,e.x,e.y);let a=t.sprite.key;t.setSprite(this.sprites.getDeath()),t.teleporting=!0,t.animateDeath(()=>{this.game.teleport(t,e.x,e.y),t.animation=null,t.setSprite(this.sprites.get(a)),t.idle(t.orientation,!0)},160)}handleDespawn(e){let t=this.entities.get(e.instance);if(t&&!(e.regions&&!e.regions.includes(t.region))){if(t.isItem())return this.entities.removeItem(t);if(t.isChest())return this.entities.removeChest(t);if(t.isNPC())return this.entities.removeNPC(t);t.despawn(),this.bubble.clear(t.instance),this.game.player.hasTarget(t)&&this.game.player.removeTarget(),this.audio.playKillSound(t),t.sprite.hasDeathAnimation||t.setSprite(this.sprites.getDeath()),t.animateDeath(()=>this.entities.removeEntity(t))}}handleCombat(e,t){let s=this.entities.get(t.instance),a=this.entities.get(t.target);if(!s||!a||e!==va.Hit)return;let n=a.instance===this.game.player.instance,r=s.instance===this.game.player.instance,o=t.hit.type===X.Poison,h=t.hit.type===X.Freezing,l=t.hit.type===X.Burning;o&&a.addEffect(N.Poisonball),t.hit.type===X.Critical&&a.addEffect(N.Critical),!t.hit.aoe&&!o&&!h&&!l&&(s.lookAt(a),s.performAction(s.orientation,ae.Attack)),r&&t.hit.damage>0&&this.audio.playHitSound(a),n&&t.hit.damage>0&&this.audio.playSound("hurt"),this.info.create(t.hit.type,t.hit.damage,a.x,a.y,n,-1,!0,t.hit.skills),t.hit.damage>0&&a.toggleHurt(),s.triggerHealthBar(),a.triggerHealthBar(),a.addAttacker(s),s.isMob()&&s.gridX===a.gridX&&s.gridY===a.gridY&&this.game.findAdjacentTile(s)}handleAnimation(e){let t=this.entities.get(e.instance);if(t?.performAction(t.orientation,e.action),e.resourceInstance){let s=this.entities.get(e.resourceInstance);s?.shake(),s?.isTree()?this.audio.playChoppingSound(this.game.player):s?.isRock()&&this.audio.playMiningSound(this.game.player)}}handlePoints(e){let t=this.entities.get(e.instance);!t||t.dead||(e.mana&&t.setMana(e.mana,e.maxMana),e.hitPoints&&(t.setHitPoints(e.hitPoints,e.maxHitPoints),this.input.hud.updateCallback?.(e.instance,e.hitPoints)))}handleNetwork(e,t){switch(e){case ei.Ping:return this.socket.send(p.Network,[ei.Pong]);case ei.Sync:{if(!t?.timestamp)return;this.game.timeOffset=~~performance.now()-t.timestamp;return}}}handleChat(e){if(e.message=m.parseMessage(e.message),e.source)return this.input.chatHandler.add(e.source,e.message,e.colour,!0);let t=this.entities.get(e.instance);if(!t)return;let{name:s,rank:a,x:n,y:r}=t;a!==Q.None&&(s=`[${qn[a]}] ${s}`),this.input.chatHandler.add(s,e.message,e.colour),e.withBubble&&(this.bubble.create(e.instance,e.message),this.bubble.setTo(e.instance,n,r),this.audio.playSound("npctalk",t))}handleCommand(e){if(e.command.includes("toggle")&&this.game.player.hasActiveEffect())return this.game.player.removeAllEffects();switch(e.command){case"debug":{this.renderer.debugging=!this.renderer.debugging;return}case"hide":return this.game.player.setVisible(!this.game.player.isVisible())}}handleContainer(e,t){let s=t.type===G.Inventory?this.menu.getInventory():this.menu.getBank();switch(e){case Ne.Batch:{s.batch(t.data.slots);break}case Ne.Add:{s.add(t.slot);break}case Ne.Remove:{s.remove(t.slot);break}}this.menu.synchronize()}handleAbility(e,t){switch(e){case wt.Batch:{this.game.player.loadAbilities(t.abilities);break}case wt.Add:case wt.Update:{t=t,this.game.player.setAbility(t.key,t.level,t.type,t.quickSlot);break}case wt.Toggle:{this.game.player.toggleAbility(t.key);break}}this.menu.synchronize("profile")}handleQuest(e,t){switch(e){case nt.Batch:{this.game.player.loadQuests(t.quests);break}case nt.Progress:{this.game.player.setQuest(t.key,t.stage,t.subStage);break}case nt.Start:return this.menu.getQuest().handle(t)}this.menu.getQuests().handle(e,t.key)}handleAchievement(e,t){switch(e){case li.Batch:{this.game.player.loadAchievements(t.achievements);break}case li.Progress:{this.game.player.setAchievement(t.key,t.stage,t.name,t.description);break}}this.menu.getAchievements().handle(e,t.key)}handleNotification(e,t){switch(e){case Bi.Text:{let s=t.source?t.message:m.formatNotification(t.message);return t.source==="TRADE"&&(s=m.formatNotification(s)),this.input.chatHandler.add(t.source||"WORLD",m.parseMessage(s),t.colour,!0)}case Bi.Popup:return t.soundEffect&&this.audio.playSound(t.soundEffect),this.menu.getNotification().show(m.parseMessage(m.formatNotification(t.title)),m.parseMessage(m.formatNotification(t.message)),t.colour)}}handleBlink(e){this.entities.get(e)?.blink()}handleHeal(e){let t=this.entities.get(e.instance);if(t){switch(e.type){case"hitpoints":{this.info.create(X.Heal,e.amount,t.x,t.y),t.addEffect(N.Healing),this.game.player.instance===t.instance&&this.audio.playSound("heal");break}case"mana":{this.info.create(X.Mana,e.amount,t.x,t.y);break}}t.triggerHealthBar()}}handleExperience(e,t){let s=this.entities.get(t.instance);if(!s)return;let a=s.instance===this.game.player.instance;switch(e){case Xi.Sync:{s.level=t.level;break}case Xi.Skill:{a&&this.info.create(X.Profession,t.amount,s.x,s.y,!1,t.skill,!0);break}}}handleDeath(){this.audio.playSound("death"),this.game.player.stop(!0),this.game.player.removeAllEffects(),this.game.minigame.reset(),this.game.player.setSprite(this.sprites.getDeath()),this.game.player.teleporting=!0,this.game.player.setHitPoints(0),this.game.player.setMana(0),this.audio.stopMusic(),this.game.player.animateDeath(()=>{this.game.entities.unregisterPosition(this.game.player),this.game.player.despawn(),this.app.body.classList.add("death")})}handleMusic(e){this.audio.playMusic(e)}handleNPC(e,t){let s,a;switch(e){case ti.Talk:{if(s=this.entities.get(t.instance),!s)return;if(a=t.text?"npc":"npc-end",this.audio.playSound(a,s),this.game.player.disableAction=!0,!t.text)return this.bubble.clear(s.instance);this.bubble.create(s.instance,t.text),this.bubble.setTo(s.instance,s.x,s.y);break}case ti.Bank:return this.menu.getBank().show(t.slots);case ti.Enchant:{this.menu.getEnchant().show();break}}}handleRespawn(e){this.game.audio.playSound("revive"),this.game.player.setGridPosition(e.x,e.y),this.camera.centreOn(this.game.player),this.game.player.animation=null,this.game.player.setSprite(this.game.sprites.get(this.game.player.getSpriteName())),this.game.player.idle(),this.entities.addEntity(this.game.player),this.game.player.dead=!1,this.game.player.teleporting=!1}handleTrade(e,t){switch(e){case ce.Open:{let{instance:s}=t,a=this.entities.get(s);return a?this.menu.getTrade().show(this.game.player,a):void 0}case ce.Close:return this.menu.getTrade().hide(!0);case ce.Add:{let{index:s,count:a,key:n,instance:r}=t;return this.menu.getTrade().add(s,a||0,n,r!==this.game.player.instance)}case ce.Remove:{let{index:s,instance:a}=t;return this.menu.getTrade().remove(s,a!==this.game.player.instance)}case ce.Accept:{let{message:s}=t;return this.menu.getTrade().accept(m.parseMessage(m.formatNotification(s)))}}}handleEnchant(e,t){switch(e){case hi.Select:return this.menu.getEnchant().move(t.index,t.isShard)}}handleGuild(e,t){switch(e){case B.Login:{this.game.player.setGuild(t);break}case B.Join:{this.game.player.addGuildMember(t.username,t.serverId);break}case B.Rank:{this.game.player.setGuildMember(t.username,t.rank);break}}this.menu.getGuilds().handle(e,t)}handlePointer(e,t){let s;switch(e){case Ve.Entity:{if(s=this.entities.get(t.instance),!s)return;this.pointer.create(e,t.instance);break}case Ve.Location:{this.pointer.create(e,t.instance,t.x*this.map.tileSize,t.y*this.map.tileSize);break}case Ve.Remove:{this.pointer.clean();break}}}handlePVP(e){this.game.pvp=e.state,this.game.player.updateEquipmentAppearance()}handlePoison(e){this.game.player.setPoison(e!==-1)}handleStore(e,t){switch(e){case We.Open:return this.menu.getStore().show(t);case We.Update:return this.menu.getStore().update(t);case We.Select:return this.menu.getStore().move(t)}}handleOverlay(e,t){switch(e){case ii.Set:{this.overlays.update(t.image),this.renderer.updateDarkMask(t.colour),this.renderer.addPlayerLight(),this.renderer.resizeLights();break}case ii.Remove:{this.renderer.removeAllLights(),this.overlays.update();break}case ii.Lamp:{this.renderer.addLight(t.light);return}}}handleCamera(e){}handleBubble(e,t){if(!t.text)return this.bubble.clear(t.instance);let s=this.entities.get(t.instance);if(e===Ca.Entity&&!s)return;let a=s?void 0:{x:t.x*this.map.tileSize,y:t.y*this.map.tileSize};this.bubble.create(t.instance,t.text,t.duration,a),this.bubble.setTo(t.instance,a?a.x:s.x,a?a.y:s.y)}handleSkill(e,t){switch(e){case Hi.Batch:{this.game.player.loadSkills(t.skills);break}case Hi.Update:{this.game.player.setSkill(t);break}}this.game.menu.synchronize("profile")}handleUpdate(e){this.entities.cleanDisplayInfo();for(let t of e){let s=this.entities.get(t.instance);if(!s){this.entities.entityUpdateQueue[t.instance]=t;continue}s.updateDisplayInfo(t)}}handleMinigame(e,t){let{minigame:s,player:a}=this.game;switch(s.type=e,s.started=!!t.started,t.countdown&&(s.countdown=t.countdown),t.action){case _t.Score:return s.setScore(t),s.setStatus("ingame");case _t.End:case _t.Lobby:return a.nameColour="",this.pointer.clean(),s.setStatus("lobby");case _t.Exit:return s.reset()}}handleEffect(e,t){let s=t.instance===this.game.player.instance?this.game.player:this.entities.get(t.instance);if(s)switch(e){case Gi.Add:return s.addEffect(t.effect);case Gi.Remove:return s.removeEffect(t.effect)}}handleFriends(e,t){switch(e){case ge.List:{this.game.player.loadFriends(t.list);break}case ge.Add:{this.game.player.addFriend(t.username,t.status,t.serverId);break}case ge.Status:{this.game.player.setFriendStatus(t.username,t.status,t.serverId);break}}this.menu.getFriends().handle(e,t.username,t.status,t.serverId)}handleRank(e){this.game.player.setRank(e)}handleCrafting(e,t){this.menu.getCrafting().handle(e,t)}handleInterface(e,t){let s=this.menu.get(t.identifier);if(s)switch(e){case Vi.Open:return s.show(t);case Vi.Close:return s.hide()}}handleLootBag(e,t){this.menu.getLootBag().handle(e,t)}handleCountdown(e){let t=this.entities.get(e.instance);t&&t.setCountdown(e.time)}handleResource(e){let t=this.entities.get(e.instance);if(!t?.isResource())return;let s=e.state===at.Depleted;t.setExhausted(s),this.input.moveCursor(),s&&t.updateSilhouette(!1)}canRequestEntityList(){return Date.now()-this.lastEntityListRequest>5e3}}class ku{constructor(e){this.app=e,this.messages[p.Connected]=()=>this.connectedCallback,this.messages[p.Handshake]=()=>this.handshakeCallback,this.messages[p.Welcome]=()=>this.welcomeCallback,this.messages[p.Spawn]=()=>this.spawnCallback,this.messages[p.Equipment]=()=>this.equipmentCallback,this.messages[p.List]=()=>this.entityListCallback,this.messages[p.Sync]=()=>this.syncCallback,this.messages[p.Movement]=()=>this.movementCallback,this.messages[p.Teleport]=()=>this.teleportCallback,this.messages[p.Despawn]=()=>this.despawnCallback,this.messages[p.Combat]=()=>this.combatCallback,this.messages[p.Animation]=()=>this.animationCallback,this.messages[p.Points]=()=>this.pointsCallback,this.messages[p.Network]=()=>this.networkCallback,this.messages[p.Chat]=()=>this.chatCallback,this.messages[p.Command]=()=>this.commandCallback,this.messages[p.Container]=()=>this.containerCallback,this.messages[p.Ability]=()=>this.abilityCallback,this.messages[p.Quest]=()=>this.questCallback,this.messages[p.Achievement]=()=>this.achievementCallback,this.messages[p.Notification]=()=>this.notificationCallback,this.messages[p.Blink]=()=>this.blinkCallback,this.messages[p.Heal]=()=>this.healCallback,this.messages[p.Experience]=()=>this.experienceCallback,this.messages[p.Death]=()=>this.deathCallback,this.messages[p.Music]=()=>this.musicCallback,this.messages[p.NPC]=()=>this.npcCallback,this.messages[p.Respawn]=()=>this.respawnCallback,this.messages[p.Trade]=()=>this.tradeCallback,this.messages[p.Enchant]=()=>this.enchantCallback,this.messages[p.Guild]=()=>this.guildCallback,this.messages[p.Pointer]=()=>this.pointerCallback,this.messages[p.PVP]=()=>this.pvpCallback,this.messages[p.Poison]=()=>this.poisonCallback,this.messages[p.Store]=()=>this.storeCallback,this.messages[p.Map]=()=>this.mapCallback,this.messages[p.Overlay]=()=>this.overlayCallback,this.messages[p.Camera]=()=>this.cameraCallback,this.messages[p.Bubble]=()=>this.bubbleCallback,this.messages[p.Skill]=()=>this.skillCallback,this.messages[p.Update]=()=>this.updateCallback,this.messages[p.Minigame]=()=>this.minigameCallback,this.messages[p.Effect]=()=>this.effectCallback,this.messages[p.Friends]=()=>this.friendsCallback,this.messages[p.Rank]=()=>this.rankCallback,this.messages[p.Crafting]=()=>this.craftingCallback,this.messages[p.Interface]=()=>this.interfaceCallback,this.messages[p.LootBag]=()=>this.lootBagCallback,this.messages[p.Countdown]=()=>this.countdownCallback,this.messages[p.Resource]=()=>this.resourceCallback}messages=[];connectedCallback;handshakeCallback;welcomeCallback;mapCallback;spawnCallback;equipmentCallback;entityListCallback;syncCallback;movementCallback;teleportCallback;despawnCallback;combatCallback;animationCallback;pointsCallback;networkCallback;chatCallback;commandCallback;containerCallback;abilityCallback;questCallback;achievementCallback;notificationCallback;blinkCallback;healCallback;experienceCallback;deathCallback;musicCallback;npcCallback;respawnCallback;tradeCallback;enchantCallback;guildCallback;pointerCallback;pvpCallback;poisonCallback;storeCallback;overlayCallback;cameraCallback;bubbleCallback;skillCallback;updateCallback;minigameCallback;effectCallback;friendsCallback;rankCallback;craftingCallback;interfaceCallback;lootBagCallback;countdownCallback;resourceCallback;handleData(e){let t=e.shift(),s=this.messages[t]();s&&typeof s=="function"&&s.call(this,...e)}handleBulkData(e){for(let t of e)this.handleData(t)}handleCloseReason(e){switch(this.app.toggleLogin(!1),e){case"worldfull":{this.app.sendError("The servers are currently full!");break}case"error":{this.app.sendError("The server has responded with an error!");break}case"banned":{this.app.sendError("Your account has been disabled!");break}case"disabledregister":{this.app.sendError("Registration is currently disabled.");break}case"development":{this.app.sendError("The game is currently in development mode.");break}case"disallowed":{this.app.sendError("The server is currently not accepting connections!");break}case"maintenance":{this.app.sendError("BagsDungeon is currently under maintenance.");break}case"userexists":{this.app.sendError("The username you have entered already exists.");break}case"emailexists":{this.app.sendError("The email you have entered is not available.");break}case"invalidinput":{this.app.sendError("The input you have entered is invalid. Please do not use special characters.");break}case"swappedworlds":{this.app.sendError("You have recently swapped worlds, please wait 15 seconds.");break}case"loggedin":{this.app.sendError("The player is already logged in!");break}case"invalidlogin":{this.app.sendError("You have entered the wrong username or password.");break}case"toofast":{this.app.sendError("You are trying to log in too fast from the same connection.");break}case"timeout":{this.app.sendError("You have been disconnected for being inactive for too long.");break}case"updated":{this.app.sendError("The game has been updated. Please clear your browser cache.");break}case"cheating":{this.app.sendError("An error in client-server syncing has occurred.");break}case"lost":{this.app.sendError("The connection to the server has been lost.");break}case"toomany":{this.app.sendError("Too many devices from your IP address are connected.");break}case"ratelimit":{this.app.sendError("You are sending packets too fast.");break}case"invalidpassword":{this.app.sendError("The password you have entered is invalid.");break}default:{this.app.sendError("An unknown error has occurred, please submit a bug report.");break}}}onConnected(e){this.connectedCallback=e}onHandshake(e){this.handshakeCallback=e}onWelcome(e){this.welcomeCallback=e}onSpawn(e){this.spawnCallback=e}onEquipment(e){this.equipmentCallback=e}onEntityList(e){this.entityListCallback=e}onSync(e){this.syncCallback=e}onMovement(e){this.movementCallback=e}onTeleport(e){this.teleportCallback=e}onDespawn(e){this.despawnCallback=e}onCombat(e){this.combatCallback=e}onAnimation(e){this.animationCallback=e}onPoints(e){this.pointsCallback=e}onNetwork(e){this.networkCallback=e}onChat(e){this.chatCallback=e}onCommand(e){this.commandCallback=e}onContainer(e){this.containerCallback=e}onAbility(e){this.abilityCallback=e}onQuest(e){this.questCallback=e}onAchievement(e){this.achievementCallback=e}onNotification(e){this.notificationCallback=e}onBlink(e){this.blinkCallback=e}onHeal(e){this.healCallback=e}onExperience(e){this.experienceCallback=e}onDeath(e){this.deathCallback=e}onMusic(e){this.musicCallback=e}onNPC(e){this.npcCallback=e}onRespawn(e){this.respawnCallback=e}onTrade(e){this.tradeCallback=e}onEnchant(e){this.enchantCallback=e}onGuild(e){this.guildCallback=e}onPointer(e){this.pointerCallback=e}onPVP(e){this.pvpCallback=e}onPoison(e){this.poisonCallback=e}onStore(e){this.storeCallback=e}onMap(e){this.mapCallback=e}onOverlay(e){this.overlayCallback=e}onCamera(e){this.cameraCallback=e}onBubble(e){this.bubbleCallback=e}onSkill(e){this.skillCallback=e}onUpdate(e){this.updateCallback=e}onMinigame(e){this.minigameCallback=e}onEffect(e){this.effectCallback=e}onFriends(e){this.friendsCallback=e}onRank(e){this.rankCallback=e}onCrafting(e){this.craftingCallback=e}onInterface(e){this.interfaceCallback=e}onLootBag(e){this.lootBagCallback=e}onCountdown(e){this.countdownCallback=e}onResource(e){this.resourceCallback=e}}class Eu{constructor(e){this.game=e,this.config=e.app.config,this.messages=new ku(e.app)}messages;config;connection;listening=!1;async getServer(){if(this.config.hub)try{return await(await fetch(`${this.config.hub}/server`)).json()}catch{return}}async connect(e){let{host:t,port:s}=e||await this.getServer()||this.config;t||=this.config.host,s||=this.config.port;let a=new URLSearchParams(window.location.search),n=a.get("server")||window.__BAGSDUNGEON_SERVER__;if(n){let o=n.split(":");t=o[0],o[1]&&(s=parseInt(o[1],10))}let r=this.config.ssl?`wss://${t}`:`ws://${t}:${s}`;this.connection=new WebSocket(r),this.connection.addEventListener("open",this.handleConnection.bind(this)),this.connection.addEventListener("message",o=>this.receive(o.data)),this.connection.addEventListener("error",()=>this.handleConnectionError(t,s)),this.connection.addEventListener("close",o=>{o.code===1010&&o.reason&&this.messages.handleCloseReason(o.reason),this.game.handleDisconnection()}),this.game.audio.createContext()}receive(e){if(!this.listening||!e.startsWith("["))return;let t=JSON.parse(e);t.length>1?this.messages.handleBulkData(t):this.messages.handleData(t.shift())}send(e,t){this.connection?.readyState===WebSocket.OPEN&&this.connection.send(JSON.stringify([e,t]))}handleConnection(){this.listening=!0,L.info("Connection established..."),this.game.app.updateLoader("Preparing handshake")}handleConnectionError(e,t){L.info(`Failed to connect to: ${e}`),this.listening=!1,this.game.app.toggleLogin(!1),this.game.app.sendError("Could not connect to the game server.")}}class Tu{constructor(e=-1,t="exit",s=180){this.type=e,this.status=t,this.countdown=s}score=0;redTeamScore=0;blueTeamScore=0;started=!1;reset(){this.type=-1,this.status="exit",this.started=!1}setStatus(e){this.status=e}setScore(e){switch(this.type){case Nt.TeamWar:{this.redTeamScore=e.redTeamKills||-1,this.blueTeamScore=e.blueTeamKills||-1;return}case Nt.Coursing:{this.score=e.score||-1;return}}}exists(){return this.type>-1}}class Su{currentOverlay="";overlays={fog:this.load("fog")};load(e){let t=new Image,s=`/img/overlays/${e}.png`;return t.crossOrigin="Anonymous",t.src=s,t.addEventListener("load",()=>L.debug(`Loaded ${e}`)),t}hasOverlay(){return this.currentOverlay!==""}get(){return this.overlays[this.currentOverlay]}update(e=""){this.currentOverlay=e}}class Ea{id="";program;attributes={};uniforms={};constructor(e,t,s,a={}){this.id=e.canvas.id,this.program=this.compile(e,t,s,a);let n=e.getProgramParameter(this.program,e.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let o=e.getActiveAttrib(this.program,r);o&&(this.attributes[o.name]=e.getAttribLocation(this.program,o.name))}n=e.getProgramParameter(this.program,e.ACTIVE_UNIFORMS);for(let r=0;r<n;r++){let o=e.getActiveUniform(this.program,r);if(!o)continue;let h=o.name.replace("[0]",""),l=e.getUniformLocation(this.program,h);l&&(this.uniforms[h]=l)}}compile(e,t,s,a={}){let n=this.compileShader(e,e.VERTEX_SHADER,t),r=this.compileShader(e,e.FRAGMENT_SHADER,s),o=e.createProgram();if(!o){L.error("Could not create WebGL program.");return}e.attachShader(o,n),e.attachShader(o,r);for(let h in a)e.bindAttribLocation(o,a[h],h);if(e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){L.error(`Could not link the WebGL program: ${e.getProgramInfoLog(o)}`),e.deleteProgram(o),e.deleteShader(n),e.deleteShader(r);return}return e.deleteShader(n),e.deleteShader(r),o}compileShader(e,t,s){let a=e.createShader(t);if(!a){L.error(`Failed to create shader of type ${t}`);return}if(e.shaderSource(a,s),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)){L.error(`Failed to compile shader: ${e.getShaderInfoLog(a)}`);return}return a}}class vu{constructor(e,t){this.map=e,this.context=t;for(let s of this.map.tilesets)this.createTexture(s)}textures=[];createTexture(e){let t=this.context.createTexture();if(!t||!e)return L.error(`Failed to create texture for tileset: ${e.src}`);this.context.bindTexture(this.context.TEXTURE_2D,t),this.context.texImage2D(this.context.TEXTURE_2D,0,this.context.RGBA,this.context.RGBA,this.context.UNSIGNED_BYTE,e),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MAG_FILTER,this.context.NEAREST),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MIN_FILTER,this.context.NEAREST),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_WRAP_S,this.context.CLAMP_TO_EDGE),this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_WRAP_T,this.context.CLAMP_TO_EDGE),this.textures.push(t),L.debug(`Created texture for tileset: ${e.src}`)}forEachTexture(e){for(let t=0;t<this.textures.length;t++)e(this.textures[t],t)}}class En{constructor(e,t,s,a=!1,n=!1,r){this.id=e,this.index=t,this.animationInfo=s,this.isFlipped=a,this.isHighTile=n,this.postAnimationData=r}animationIndex=0;expired=!1;unused=!1;uploaded=!0;lastTime=0;lastAccessed=Date.now();animate(e){e-this.lastAccessed>5e3&&(this.unused=!0),e-this.lastTime>this.getDuration()&&(this.id=this.animationInfo[this.animationIndex].tileId,this.lastTime=e,this.uploaded=!1,this.animationIndex>=Object.keys(this.animationInfo).length-1?(this.postAnimationData&&(this.expired=!0),this.animationIndex=0):this.animationIndex++)}getDuration(){return this.animationInfo[this.animationIndex].duration}}class Iu{constructor(e){this.renderer=e,this.map=e.map,this.backgroundData=new Uint8Array(this.map.width*this.map.height*4),this.foregroundData=new Uint8Array(this.map.width*this.map.height*4),this.backgroundData.fill(255),this.foregroundData.fill(255)}map;backgroundData;foregroundData;backgroundTexture;foregroundTexture;animatedTiles={};bindTexture(e,t,s=!1){t&&(!this.backgroundTexture&&!s&&(this.backgroundTexture=e.createTexture()),!this.foregroundTexture&&s&&(this.foregroundTexture=e.createTexture()),e.bindTexture(e.TEXTURE_2D,s?this.foregroundTexture:this.backgroundTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.useProgram(t),this.upload(e,s))}upload(e,t=!1){e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.map.width,this.map.height,0,e.RGBA,e.UNSIGNED_BYTE,t?this.foregroundData:this.backgroundData)}clear(e){delete this.animatedTiles[e],e*=4,this.backgroundData[e]=this.backgroundData[e+1]=this.backgroundData[e+2]=this.backgroundData[e+3]=255,this.foregroundData[e]=this.foregroundData[e+1]=this.foregroundData[e+2]=this.foregroundData[e+3]=255}addTile(e,t,s=!1){let a=s?t.tileId:t,n=this.map.isHighTile(a),r=n?this.foregroundData:this.backgroundData,o=e*4;if(!a){r[o]=r[o+1]=r[o+2]=r[o+3]=255;return}let h=this.map.getTilesetFromId(a);if(!h)return;let l=a-h.firstGid,d=h.width/this.map.tileSize;r[o]=l%d,r[o+1]=~~(l/d),r[o+2]=h.index,r[o+3]=s?this.getFlippedFlag(t):0,!(e in this.animatedTiles)&&this.map.isAnimatedTile(a)&&(this.animatedTiles[e]=new En(a,e,this.map.getTileAnimation(a),s,n,this.map.dynamicAnimatedTiles[e]))}draw(e,t,s=!1,a=!1){if(e.bindTexture(e.TEXTURE_2D,s?this.foregroundTexture:this.backgroundTexture),e.drawArrays(e.TRIANGLES,0,6),a)return;let n=!1;for(let r in this.animatedTiles){let o=this.animatedTiles[r];if(!(o.isHighTile&&!s)){if(o.animate(t),o.expired){this.renderer.setTile(o.index,o.postAnimationData),delete this.animatedTiles[r];continue}o.uploaded||(this.addTile(o.index,o.id+1,o.isFlipped),n=!0,o.uploaded=!0)}}n&&this.upload(e,s)}getFlippedFlag(e){return(e.h?-8:0)|(e.v?4:0)|(e.d?2:0)}}var Tn=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},V=(i,e,t)=>(Tn(i,e,"read from private field"),t?t.call(i):e.get(i)),qe=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},ze=(i,e,t,s)=>(Tn(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t),Cu=(i,e,t,s)=>({set _(a){ze(i,e,a,t)},get _(){return V(i,e,s)}});class W{constructor(e=0,t=0){this.x=e,this.y=t}copy(){return new W(this.x,this.y)}dot(e){return e.x*this.x+e.y*this.y}sub(e){return new W(this.x-e.x,this.y-e.y)}add(e){return new W(this.x+e.x,this.y+e.y)}mul(e){return new W(this.x*e,this.y*e)}inv(){return this.mul(-1)}dist2(e){const t=this.x-e.x,s=this.y-e.y;return t**2+s**2}normalize(){const e=Math.sqrt(this.length2());return new W(this.x/e||0,this.y/e||0)}length2(){return this.x**2+this.y**2}toString(){return`${this.x},${this.y}`}inBound(e,t){return e.x<this.x&&this.x<t.x&&e.y<this.y&&this.y<t.y}}function qt(i,e,t){const s=`illuminated-${i}`;let a=document.querySelector(`#${s}`);a||(a=document.createElement("canvas"),a.id=s,a.width=e,a.height=t,a.style.display="none",document.body.append(a));const n=a.getContext("2d");return n.clearRect(0,0,a.width,a.height),a.width=e,a.height=t,{canvas:a,ctx:n,w:e,h:t}}const Au=(()=>{const i=document.createElement("canvas");i.width=1,i.height=1;const e=i.getContext("2d");return(t,s=1)=>{e.clearRect(0,0,1,1),e.fillStyle=t,e.fillRect(0,0,1,1);const[a,n,r]=e.getImageData(0,0,1,1).data;return`rgba(${[a,n,r,s].toString()})`}})();(()=>{const i=document.createElement("canvas");i.width=1,i.height=1;const e=i.getContext("2d");function t(s){let a=s.toString(16);return a.length===1&&(a=`0${a}`),a}return s=>{e.clearRect(0,0,1,1),e.fillStyle=s,e.fillRect(0,0,1,1);const[a,n,r,o]=e.getImageData(0,0,1,1).data;return{color:`#${t(a)}${t(n)}${t(r)}`,alpha:Math.round(1e3*o/255)/1e3}}})();var ve;class Nu{constructor(e={}){qe(this,ve,void 0);const{lights:t,color:s}=e;this.lights=t??[],this.color=s??"rgba(0,0,0,0.9)"}compute(e,t){(!V(this,ve)||V(this,ve).w!==e||V(this,ve).h!==t)&&ze(this,ve,qt("dm",e,t));const{ctx:s}=V(this,ve);s.save(),s.clearRect(0,0,e,t),s.fillStyle=this.color,s.fillRect(0,0,e,t),s.globalCompositeOperation="destination-out";for(const a of this.lights)a.hidden||a.mask(s);s.restore()}render(e){e.drawImage(V(this,ve).canvas,0,0)}getCanvas(){return V(this,ve).canvas}}ve=new WeakMap;const Lu=Math.PI*(3-Math.sqrt(5));var ai,Et;class Sn{constructor(e={}){qe(this,ai,void 0),qe(this,Et,void 0);const{position:t,distance:s,diffuse:a,samples:n,hidden:r}=e;this.position=t??new W,this.distance=s??100,this.diffuse=a??.8,this.samples=n??1,this.hidden=r??!1}render(e){}mask(e){const t=this.getVisibleMaskCache(),{x:s,y:a}=this.position;e.drawImage(t.canvas,Math.round(s-t.w/2),Math.round(a-t.h/2))}bounds(){const{position:e,distance:t}=this,{x:s,y:a}=e;return{topLeft:new W(s-t,a-t),bottomRight:new W(s+t,a+t)}}center(){const{distance:e}=this;return new W(e,e)}forEachSample(e){e(this.position)}getVisibleMaskCache(){const e=Math.floor(this.distance*1.4),t=`${e}`;if(!(e<1)){if(V(this,ai)!==t){ze(this,ai,t),ze(this,Et,qt(`vm${this.id}`,2*e,2*e));const{ctx:s,w:a,h:n}=V(this,Et),r=s.createRadialGradient(e,e,0,e,e,e);r.addColorStop(0,"rgba(0,0,0,1)"),r.addColorStop(1,"rgba(0,0,0,0)"),s.fillStyle=r,s.fillRect(0,0,a,n)}return V(this,Et)}}getHashCache(){return[this.distance,this.diffuse].toString()}}ai=new WeakMap,Et=new WeakMap;var ns,ni,ri;const vn=class extends Sn{constructor(i={}){super(i),qe(this,ni,void 0),qe(this,ri,void 0);const{id:e,color:t,radius:s,angle:a,roughness:n}=i;this.id=e??0,this.color=t??"rgba(250,220,150,0.8)",this.radius=s??0,this.angle=a??0,this.roughness=n??0,this.id===0&&(this.id=Cu(vn,ns)._++)}getHashCache(){return[this.color,this.distance,this.diffuse,this.angle,this.roughness,this.samples,this.radius].toString()}center(){const{angle:i,roughness:e,distance:t}=this;return new W((1-Math.cos(i)*e)*t,(1+Math.sin(i)*e)*t)}bounds(){const{angle:i,roughness:e,distance:t,position:s}=this,{x:a,y:n}=new W(Math.cos(i),-Math.sin(i)).mul(e*t);return{topLeft:new W(s.x+a-t,s.y+n-t),bottomRight:new W(s.x+a+t,s.y+n+t)}}mask(i){const{angle:e,roughness:t,distance:s,position:a}=this,{canvas:n,w:r,h:o}=this.getVisibleMaskCache(),{x:h,y:l}=new W(Math.cos(e),-Math.sin(e)).mul(t*s);i.drawImage(n,Math.round(a.x+h-r/2),Math.round(a.y+l-o/2))}getGradientCache(i){const e=this.getHashCache();if(V(this,ni)===e)return V(this,ri);ze(this,ni,e);const{distance:t,id:s,radius:a,color:n}=this,r=Math.round(t),o=r*2,h=qt(`gc${s}`,o,o),{ctx:l,w:d,h:c}=h,u=l.createRadialGradient(i.x,i.y,0,r,r,r);return u.addColorStop(Math.min(1,a/t),n),u.addColorStop(1,Au(n,0)),l.fillStyle=u,l.fillRect(0,0,d,c),ze(this,ri,h),h}render(i){const{x:e,y:t}=this.position,s=this.center(),{canvas:a}=this.getGradientCache(s);i.drawImage(a,Math.round(e-s.x),Math.round(t-s.y))}forEachSample(i){const{samples:e,radius:t,position:s}=this;for(let a=0;a<e;a++){const n=a*Lu,r=Math.sqrt(a/e)*t,o=new W(Math.cos(n)*r,Math.sin(n)*r);i(s.add(o))}}};let In=vn;ns=new WeakMap,ni=new WeakMap,ri=new WeakMap,qe(In,ns,0);var Ie,oi;class Ou{constructor(e={}){qe(this,Ie,void 0),qe(this,oi,void 0);const{light:t,objects:s}=e;this.light=t??new Sn,this.objects=s??[]}createCache(e,t){ze(this,Ie,qt("lc",e,t)),ze(this,oi,qt("lcc",e,t))}compute(e,t){(!V(this,Ie)||V(this,Ie).w!==e||V(this,Ie).h!==t)&&this.createCache(e,t);const{ctx:s}=V(this,Ie);s.save(),s.clearRect(0,0,s.canvas.width,s.canvas.height),this.light.render(s),s.globalCompositeOperation="destination-out",this.cast(s),s.restore()}cast(e){const{ctx:t,w:s,h:a,canvas:n}=V(this,oi),{light:r}=this,o=r.samples;t.clearRect(0,0,s,a),t.fillStyle=`rgba(0,0,0,${Math.round(100/o)/100})`;const h=r.bounds(),{topLeft:l,bottomRight:d}=h,{objects:c}=this;r.forEachSample(u=>{for(let g=0,f=c.length;g<f;g++)if(c[g].contains(u)){t.fillRect(l.x,l.y,d.x-l.x,d.y-l.y);return}for(const g of c)g.cast(t,u,h)});for(const u of c){let{diffuse:g}=u;g*=r.diffuse,t.fillStyle=`rgba(0,0,0,${1-g})`,t.beginPath(),u.path(t),t.fill()}e.drawImage(n,0,0)}render(e){e.drawImage(V(this,Ie).canvas,0,0)}getCanvas(){return V(this,Ie).canvas}}Ie=new WeakMap,oi=new WeakMap;class Cn{constructor(e,t="canvas"){this.game=e,this.type=t,this.map=e.map,this.camera=e.camera,this.grids=e.map.grids,this.tileSize=e.map.tileSize,this.actualTileSize=this.tileSize*this.camera.zoomFactor,this.ceilActualTileSize=Math.ceil(this.actualTileSize),this.loadSizes(),this.zoomIn.addEventListener("click",()=>this.game.zoom(.2)),this.zoomOut.addEventListener("click",()=>this.game.zoom(-.2)),this.camera.onZoom(()=>{this.fontSize=Math.floor(12+this.camera.zoomFactor*3),this.strokeSize=Math.floor(this.fontSize/6)})}background=document.querySelector("#background");foreground=document.querySelector("#foreground");overlay=document.querySelector("#overlay");textCanvas=document.querySelector("#text-canvas");entities=document.querySelector("#entities");entitiesFore=document.querySelector("#entities-fore");cursor=document.querySelector("#cursor");entitiesMask=document.querySelector("#entities-mask");canvases=[this.background,this.foreground,this.overlay,this.textCanvas,this.entities,this.entitiesFore,this.cursor,this.entitiesMask];entitiesContext=this.entities.getContext("2d");entitiesForeContext=this.entitiesFore.getContext("2d");overlayContext=this.overlay.getContext("2d");textContext=this.textCanvas.getContext("2d");cursorContext=this.cursor.getContext("2d");entitiesMaskContext=this.entitiesMask.getContext("2d");allContexts=[this.entitiesContext,this.entitiesForeContext,this.entitiesMaskContext,this.overlayContext,this.textContext,this.cursorContext];contexts=[this.entitiesContext,this.entitiesForeContext,this.entitiesMaskContext,this.textContext,this.overlayContext];zoomIn=document.querySelector("#zoom-in");zoomOut=document.querySelector("#zoom-out");map;camera;grids;tileSize=m.tileSize;actualTileSize=m.tileSize;ceilActualTileSize=m.tileSize;screenWidth=0;screenHeight=0;canvasWidth=0;canvasHeight=0;animateTiles=!0;renderedFrame=[];lightings={};darkMask=new Nu({lights:[],color:"rgba(0, 0, 0, 0.84)"});debugging=!1;stopRendering=!1;forceRendering=!1;drawNames=!0;drawLevels=!0;fontSize=12;strokeSize=4;mobile=le();tablet=Pn();time=Date.now();fps=0;frameCount=0;load(){}loadSizes(){this.actualTileSize=this.tileSize*this.camera.zoomFactor,this.ceilActualTileSize=Math.ceil(this.actualTileSize),this.screenWidth=this.camera.gridWidth*this.tileSize,this.screenHeight=this.camera.gridHeight*this.tileSize,this.canvasWidth=this.screenWidth*this.camera.zoomFactor,this.canvasHeight=this.screenHeight*this.camera.zoomFactor,this.forEachCanvas(e=>{e.width=this.canvasWidth,e.height=this.canvasHeight}),this.removeSmoothing(),this.resizeLights()}resize(){this.mobile=le(),this.camera.update(),this.camera.updateMinimumZoom(this.mobile),this.loadSizes(),this.camera.centreOn(this.game.player),this.forceRendering=!0,this.clearScreen(this.cursorContext)}render(){this.clear(),this.save(),this.drawDebugging(),this.drawOverlays(),this.drawHoveringCell(),this.drawSelectedCell(),this.drawEntities(),this.drawInfos(),this.drawCursor(),this.drawMinigameGUI(),this.restore()}drawDebugging(){this.debugging&&(this.drawFPS(),this.drawPathing(),!this.mobile&&(this.drawPosition(),this.drawCollisions()))}drawOverlays(){if(!this.game.overlays.hasOverlay())return;let e=this.game.overlays.get();e&&this.overlayContext.drawImage(e,0,0,this.canvasWidth,this.canvasHeight),this.overlayContext.globalCompositeOperation="lighter",this.forEachLighting(t=>this.drawLighting(t)),this.overlayContext.globalCompositeOperation="source-over",this.darkMask.compute(this.overlay.width,this.overlay.height),this.darkMask.render(this.overlayContext)}drawHoveringCell(){if(this.mobile)return;let e=this.game.input.getCoords();if(!this.game.input.isOnCanvas||this.isSelectedCell(e.gridX,e.gridY))return;let t=this.game.input.targetColour,s=this.map.isObject(e.gridX,e.gridY);s&&(t="rgba(245, 230, 66, 0.5)"),this.map.isColliding(e.gridX,e.gridY)&&!s&&(t="rgba(230, 0, 0, 0.7)"),this.drawCellHighlight(e.gridX,e.gridY,t)}drawSelectedCell(){if(!this.game.input.selectedCellVisible||this.game.input.keyMovement)return;let e=this.game.input.getTargetData();e&&(this.entitiesContext.save(),this.setCameraView(this.entitiesContext),this.entitiesContext.drawImage(e.sprite.image,e.x,e.y,e.width,e.height,e.dx,e.dy,e.dw,e.dh),this.entitiesContext.restore())}drawEntities(){this.game.player.dead||(this.setCameraView(this.entitiesContext),this.setCameraView(this.entitiesForeContext),this.forEachVisibleEntity(e=>{if(!(!e.sprite?.loaded||!e.animation||!e.isVisible())){if(this.debugging&&this.drawEntityBoundary(e),e.isTree())return this.drawTree(e);this.drawEntity(e)}}),this.entitiesMaskContext.drawImage(this.entities,0,0))}drawInfos(){this.game.info.isEmpty()||this.game.info.forEachInfo(e=>{this.textContext.save(),this.textContext.globalAlpha=e.opacity;let{x:t,y:s,fill:a,skillKey:n,skills:r,stroke:o}=e,h=n||r.length>0;if(t+=8,h){this.setCameraView(this.textContext);let l=~~((t-2)*this.camera.zoomFactor);if(t=~~(t*this.camera.zoomFactor),s=~~(s*this.camera.zoomFactor),n)this.drawInfoSkill(n,l,s);else for(let d=0;d<r.length;d++)this.drawInfoSkill(r[d],l,s,d,r.length)}this.drawText(`${e.getText()}`,t,s,!0,!h,a,o,32),this.textContext.restore()})}drawInfoSkill(e,t,s,a=0,n=0){let r=this.game.sprites.get(e);r&&(r.loaded||r.load(),n===2?a===0?t-=r.width:t+=r.width/1.5:n===3&&(a===0?t-=r.width*2:a===2&&(t+=r.width*2)),this.textContext.drawImage(r.image,t+r.offsetX,s+r.offsetY*4,r.width*2,r.height*2))}drawCursor(){if(this.tablet||this.mobile||this.game.input.isMouseRendered())return;let{cursor:e,mouse:t}=this.game.input;!e||!t||(this.clearScreen(this.cursorContext),this.cursorContext.save(),e.loaded?this.cursorContext.drawImage(e.image,0,0,this.tileSize,this.tileSize,t.x,t.y,this.actualTileSize,this.actualTileSize):e.load(),this.cursorContext.restore(),this.game.input.saveMouse())}drawFPS(){this.calculateFPS(),this.drawText(`[${this.type}, cw: ${this.camera.gridWidth}, ch: ${this.camera.gridHeight}] FPS: ${this.fps}`,50,180)}calculateFPS(){let e=Date.now();e-this.time>=1e3&&(this.fps=this.frameCount,this.frameCount=0,this.time=e),this.frameCount++}drawPosition(){let{player:e,input:t}=this.game;this.drawText(`x: ${e.gridX} y: ${e.gridY} tileIndex: ${this.map.coordToIndex(e.gridX,e.gridY)} movementSpeed: ${e.movementSpeed}`,50,240),this.drawText(`zoomFactor: ${this.camera.zoomFactor}`,50,420),this.drawText(`actulTileSize: ${this.actualTileSize}`,50,480),t.hovering&&t.entity&&(this.drawText(`x: ${t.entity.gridX} y: ${t.entity.gridY} instance: ${t.entity.instance}`,50,300),t.entity.attackRange&&this.drawText(`att range: ${t.entity.attackRange}`,50,360))}drawCollisions(){this.camera.forEachVisiblePosition((e,t)=>{this.map.isOutOfBounds(e,t)||this.map.grid[t][e]!==0&&this.drawCellHighlight(e,t,"rgba(50, 50, 255, 0.5)")})}drawEntityBoundary(e){this.entitiesContext.save(),this.entitiesContext.lineWidth=2*this.camera.zoomFactor;let t=e.getBoundingBox();this.entitiesContext.translate((t.x+t.width/2)*this.camera.zoomFactor,(t.y+t.height/2)*this.camera.zoomFactor),this.entitiesContext.strokeStyle="rgba(255, 50, 50, 0.4)";let s=e.sprite.width<e.sprite.height?e.sprite.width:e.sprite.height;this.entitiesContext.beginPath(),this.entitiesContext.arc(0,0,s/2*this.camera.zoomFactor,0,2*Math.PI),this.entitiesContext.stroke(),this.entitiesContext.restore()}drawPathing(){if(this.game.player.hasPath())for(let e of this.game.player.path)this.drawCellHighlight(e[0],e[1],"rgba(50, 255, 50, 0.5)")}drawEntity(e){let t=e.animation?.frame,s=~~(e.x*this.camera.zoomFactor),a=~~(e.y*this.camera.zoomFactor),n=s+this.actualTileSize,r=a+e.sprite.height,o=e.isNonTreeResource()&&this.game.player.gridY<e.gridY?this.entitiesForeContext:this.entitiesContext;if(o.save(),e.fading&&(o.globalAlpha=e.fadingAlpha),e.spriteFlipX?(o.translate(n,a),o.scale(-1,1)):e.spriteFlipY?(o.translate(s,r),o.scale(1,-1)):o.translate(s,a),o.scale(this.camera.zoomFactor,this.camera.zoomFactor),e.customScale&&o.scale(e.customScale,e.customScale),e.angle!==0&&o.rotate(e.angle),e.hasShadow()){let h=this.game.sprites.get("shadow");o.drawImage(h.image,0,0,h.width,h.height,0,e.shadowOffsetY,h.width,h.height)}o.drawImage(e.getSprite().image,t.x,t.y,e.sprite.width,e.sprite.height,e.sprite.offsetX,e.sprite.offsetY+e.offsetY,e.sprite.width,e.sprite.height),this.drawEntityFore(e),o.restore(),this.drawHealth(e),!(!e.isPlayer()&&!e.isMob()&&!e.isNPC()&&!e.isItem())&&(this.game.overlays.hasOverlay()||(this.game.player.instance===e.instance&&this.camera.isCentered()?this.drawPlayerName(e):this.drawName(e)))}drawTree(e){let t=e.animation?.frame,s=e.exhausted?e.exhaustedFrame:e.baseFrame,a=~~(e.x*this.camera.zoomFactor),n=~~(e.y*this.camera.zoomFactor);this.entitiesForeContext.save(),this.entitiesContext.save(),this.entitiesForeContext.translate(a,n),this.entitiesContext.translate(a,n),this.entitiesForeContext.scale(this.camera.zoomFactor,this.camera.zoomFactor),this.entitiesContext.scale(this.camera.zoomFactor,this.camera.zoomFactor),e.exhausted||this.entitiesForeContext.drawImage(e.getSprite().image,t.x,t.y,e.sprite.width,e.sprite.height,e.sprite.offsetX,e.sprite.offsetY+e.offsetY,e.sprite.width,e.sprite.height),this.entitiesContext.globalCompositeOperation="destination-over",this.entitiesContext.drawImage(e.getSprite().image,s.x,s.y,e.sprite.width,e.sprite.height,e.sprite.offsetX,e.sprite.offsetY+e.offsetY,e.sprite.width,e.sprite.height),this.entitiesForeContext.restore(),this.entitiesContext.restore()}drawEntityFore(e){if(e.isItem())return this.drawSparks();e.exclamation&&this.drawExclamation(),e.blueExclamation&&this.drawBlueExclamation(),e instanceof Le&&(e.isPlayer()&&e.forEachEquipment(t=>this.drawEquipment(e,t),!0),e.hasActiveEffect()&&this.drawEffects(e))}drawEquipment(e,t){if(e.dead||e.teleporting)return;let s=this.game.sprites.get(t.key);s&&(s.loaded||s.load(),s.image&&this.drawSprite(e,s))}drawSprite(e,t){let s=e.animation,a=t.animations[s.name];if(!a)return;let{frame:n,row:r}=s,o=n.index<a.length?n.index:n.index%a.length,h=t.width*o,l=t.height*r,d=t.width,c=t.height;this.entitiesContext.drawImage(t.image,h,l,d,c,t.offsetX,t.offsetY,d,c)}drawEffects(e){for(let t of e.statusEffects){if(t===N.Freezing&&e.hasEffect(N.SnowPotion)||t===N.Burning&&e.hasEffect(N.FirePotion))continue;let s=e.getEffect(t);if(!s)continue;let a=this.game.sprites.get(s.key);a.loaded||a.load();let{animation:n}=s,{index:r}=n.frame,o=a.width*r,h=a.height*n.row;this.entitiesContext.drawImage(a.image,o,h,a.width,a.height,a.offsetX,a.offsetY,a.width,a.height),n.update(this.game.time)}}drawSparks(){let e=this.game.sprites.get("sparks"),t=e.animations.idle_down;this.entitiesContext.drawImage(e.image,e.width*t.frame.index,e.height*t.row,e.width,e.height,0,0,e.width,e.height)}drawExclamation(){let e=this.game.sprites.get("exclamation"),t=e.animations.idle_down;this.entitiesContext.drawImage(e.image,e.width*t.frame.index,e.height*t.row,e.width,e.height,0,e.offsetY,e.width,e.height)}drawBlueExclamation(){let e=this.game.sprites.get("exclamationblue"),t=e.animations.idle_down;this.entitiesContext.drawImage(e.image,e.width*t.frame.index,e.height*t.row,e.width,e.height,0,e.offsetY,e.width,e.height)}drawCrown(e,t,s){let a=this.getCrown(e);a&&(this.setCameraView(this.textContext),this.textContext.drawImage(a.image,0,0,a.width,a.height,t*this.camera.zoomFactor-a.width,s*this.camera.zoomFactor-a.height*3,a.width*2,a.height*2),this.textContext.restore())}drawPlayerCrown(e){let t=this.getCrown(e);t&&this.textContext.drawImage(t.image,0,0,t.width,t.height,this.camera.borderOffsetWidth/2-t.width+8*this.camera.zoomFactor,this.camera.borderOffsetHeight/2-t.height*3-24*this.camera.zoomFactor,t.width*2,t.height*2)}drawHealth(e){if(!e.hitPoints||e.hitPoints<0||!e.healthBarVisible)return;let t=this.tileSize,s=e.x*this.camera.zoomFactor-t/2+8,a=(e.y-e.sprite.height/4)*this.camera.zoomFactor,n=~~(e.hitPoints/e.maxHitPoints*t*this.camera.zoomFactor),r=2*this.camera.zoomFactor;this.textContext.save(),this.setCameraView(this.textContext),this.textContext.strokeStyle="rbga(0, 0, 0, 1)",this.textContext.lineWidth=1,this.textContext.strokeRect(s,a,t*this.camera.zoomFactor,r),this.textContext.fillStyle="rgba(253, 0, 0, 1)",this.textContext.fillRect(s,a,n,r),this.textContext.restore()}drawName(e){let t=e.x+8,s=e.y-5,a="white";if(e.hasCounter())return this.drawText(`${e.counter}`,t,s,!0,!0,a);if(e.isItem()&&e.count>1)return this.drawText(`${e.count}`,t,s,!0,!0,a);if(e.hidden||e.healthBarVisible||e.exclamation||e.blueExclamation)return;let n=this.drawNames&&e.drawNames()&&!e.isItem(),r=this.drawLevels&&!e.isNPC()&&!e.isItem(),o=this.drawLevels?s-10:s-4,h=this.drawLevels?s:s-7,l=`Level ${e.level}`;e.isNPC()&&(o=s-2),e.isPlayer()&&(e.hasRank()&&(a=bs[e.rank]),n&&e.hasCrown()&&this.drawCrown(e.getCrownKey(),t,o)),e.isPlayer()&&e.rank!==Q.None&&(a=bs[e.rank]),e.instance===this.game.player.instance&&(a="rgba(252,218,92, 1)"),e.nameColour&&(a=e.nameColour),n&&this.drawText(e.name,t,o,!0,!0,a),r&&e.level&&this.drawText(l,t,h,!0,!0,a)}drawPlayerName(e){let t=this.drawLevels?22:10;this.drawNames&&(this.drawText(e.name,this.camera.borderOffsetWidth/2+8*this.camera.zoomFactor,this.camera.borderOffsetHeight/2-t*this.camera.zoomFactor,!0,!1,"rgba(252,218,92, 1)"),e.hasCrown()&&this.drawPlayerCrown(e.getCrownKey())),this.drawLevels&&e.level&&this.drawText(`Level ${e.level}`,this.camera.borderOffsetWidth/2+8*this.camera.zoomFactor,this.camera.borderOffsetHeight/2-10*this.camera.zoomFactor,!0,!1,"rgba(252,218,92, 1)")}drawMinigameGUI(){if(this.game.minigame.exists())switch(this.game.minigame.type){case Nt.TeamWar:return this.drawTeamWarGUI(this.game.minigame);case Nt.Coursing:return this.drawCoursingGUI(this.game.minigame)}}drawTeamWarGUI(e){let{status:t,started:s,countdown:a,redTeamScore:n,blueTeamScore:r}=e,o=this.textCanvas.width/6;switch(t){case"lobby":{this.drawText(s?`There is a game in progress, remaining time: ${a} seconds`:`Game starts in ${a} seconds`,o,30,!0);return}case"ingame":{this.drawText(`Red: ${n}`,o-20,30,!0,!1,"red"),this.drawText(`Blue: ${r}`,o+20,30,!0,!1,"blue"),this.drawText(`Time left: ${a} seconds`,o,50,!0,!1,"white");return}}}drawCoursingGUI(e){let{status:t,started:s,countdown:a,score:n}=e,r=this.textCanvas.width/6;switch(t){case"lobby":{this.drawText(s?`There is a game in progress, remaining time: ${a} seconds`:`Game starts in ${a} seconds`,r,30);return}case"ingame":{this.drawText(`Score: ${n}`,r,30,!0);return}}}drawLighting(e){let{light:t}=e;if(t.entity){let s=t.entity===this.game.player.instance,a=s?this.game.player:this.game.entities.get(t.entity);if(t.hidden=!a?.hasLight(),t.hidden||(s||(t.hidden=!this.camera.isVisible(a.gridX,a.gridY,4,8)),t.hidden))return;t.position=this.getLightPosition(a.x,a.y)}else{if(t.hidden=!this.camera.isVisible(t.gridX,t.gridY,4,8),t.hidden)return;let s=(t.originalX-this.camera.x)*this.camera.zoomFactor,a=(t.originalY-this.camera.y)*this.camera.zoomFactor;t.position=new W(s,a)}}drawCellHighlight(e,t,s){this.drawCellRect(e*this.actualTileSize,t*this.actualTileSize,s)}drawCellRect(e,t,s){this.entitiesContext.save(),this.setCameraView(this.entitiesContext),this.entitiesContext.lineWidth=2*this.camera.zoomFactor,this.entitiesContext.translate(e+4,t+2),this.entitiesContext.strokeStyle=s,this.entitiesContext.strokeRect(0,0,this.actualTileSize-8,this.actualTileSize-8),this.entitiesContext.restore()}drawText(e,t,s,a=!1,n=!1,r="white",o="rgba(0, 0, 0, 1)",h=this.fontSize){this.textContext.save(),a&&(this.textContext.textAlign="center"),n&&(this.setCameraView(this.textContext),t=~~(t*this.camera.zoomFactor),s=~~(s*this.camera.zoomFactor)),this.textContext.strokeStyle=o,this.textContext.lineWidth=this.strokeSize,this.textContext.font=`${h}px Quaver`,this.textContext.strokeText(e,t,s),this.textContext.fillStyle=r||"white",this.textContext.fillText(e,t,s),this.textContext.restore()}updateDarkMask(e="rgba(0, 0, 0, 0.5)"){this.darkMask.color=e}addLight(e){if(e.instance in this.lightings)return;let t=new Ou({light:new In(this.getLightData(e.x,e.y,e.distance,e.diffuse,e.colour))});return t.light.gridX=e.x,t.light.gridY=e.y,t.light.offset=m.randomInt(0,1e3),t.light.originalX=t.light.position.x,t.light.originalY=t.light.position.y,t.light.originalDistance=t.light.distance,t.light.entity=e.entity,t.light.flickerSpeed=e.flickerSpeed,t.light.flickerIntensity=e.flickerIntensity,this.lightings[e.instance]=t,this.darkMask.lights.push(t.light),t}addPlayerLight(e=this.game.player){let t=e.getLight(),s=this.overlay.width/this.tileSize/2,a=this.overlay.height/this.tileSize/2;t.outer&&this.addLight(this.getSerializedLight(e.instance,s,a,t.outer)),t.inner&&this.addLight(this.getSerializedLight(`${e.instance}inner`,s,a,t.inner))}updatePlayerLight(e=this.game.player){let t=e.getLight(),s=this.lightings[e.instance],a=this.lightings[`${e.instance}inner`];e.hasLight()&&(!s||!a)&&this.addPlayerLight(e),s&&t.outer&&(s.light.distance=t.outer.distance,s.light.originalDistance=t.outer.distance,s.light.color=t.outer.colour,s.light.flickerSpeed=t.outer.flickerSpeed,s.light.flickerIntensity=t.outer.flickerIntensity),a&&t.inner&&(a.light.distance=t.inner.distance,a.light.originalDistance=t.inner.distance,a.light.color=t.inner.colour,a.light.flickerSpeed=t.inner.flickerSpeed,a.light.flickerIntensity=t.inner.flickerIntensity),this.resizeLights()}resizeLights(){let e=this.camera.zoomFactor/rt;this.forEachLighting(t=>{t.light.distance=t.light.originalDistance*e,t.light.scaledDistance=t.light.distance,t.light.scaledFlickerIntensity=t.light.flickerIntensity*e})}removeAllLights(){this.lightings={},this.darkMask.lights=[],this.addPlayerLight()}hasRenderedFrame(){return this.forceRendering?!1:this.renderedFrame[0]===this.camera.x&&this.renderedFrame[1]===this.camera.y}removeSmoothing(){this.forAllContexts(e=>{e.imageSmoothingQuality="low",e.imageSmoothingEnabled=!1})}clear(){this.forEachContext(this.clearScreen)}clearScreen(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}save(){this.forEachContext(e=>e.save())}saveFrame(){this.renderedFrame[0]=this.camera.x,this.renderedFrame[1]=this.camera.y,this.forceRendering=!1}restore(){this.forEachContext(e=>e.restore())}setBrightness(e){e<0||e>100||this.forEachCanvas(t=>{t.style.background=`rgba(0,0,0,${.25-e/200})`})}setCameraView(e){!this.camera||this.stopRendering||e.translate(~~(-this.camera.x*this.camera.zoomFactor),~~(-this.camera.y*this.camera.zoomFactor))}getX(e,t){return e===0?0:e%t===0?t-1:e%t-1}getLightPosition(e,t){return new W((e-this.camera.x)*this.camera.zoomFactor+this.actualTileSize/2,(t-this.camera.y)*this.camera.zoomFactor)}getLightData(e,t,s,a,n){return{position:new W(e*this.tileSize+this.tileSize/2,t*this.tileSize+this.tileSize/2),distance:s,diffuse:a,color:n,radius:0,samples:2,roughness:0,angle:0}}getSerializedLight(e,t,s,a){return{instance:e,x:t,y:s,distance:a.distance,diffuse:.2,colour:a.colour,entity:e.includes("inner")?e.split("inner")[0]:e,flickerSpeed:a.flickerSpeed,flickerIntensity:a.flickerIntensity}}isSelectedCell(e,t){return this.game.input.selectedX===e&&this.game.input.selectedY===t}isWebGl(){return this.type==="webgl"}isCanvas(){return this.type==="canvas"}getCrown(e){switch(e){case"goldmedal":return this.game.sprites.get("crowns/goldmedal");case"silvermedal":return this.game.sprites.get("crowns/silvermedal");case"crown-artist":return this.game.sprites.get("crowns/artist");case"crown-tier1":return this.game.sprites.get("crowns/tier1");case"crown-tier2":return this.game.sprites.get("crowns/tier2");case"crown-tier3":return this.game.sprites.get("crowns/tier3");case"crown-tier4":return this.game.sprites.get("crowns/tier4");case"crown-tier5":return this.game.sprites.get("crowns/tier5");case"crown-tier6":return this.game.sprites.get("crowns/tier6");case"crown-tier7":return this.game.sprites.get("crowns/tier7")}}setTile(e,t){}bindTileLayers(){}forEachVisibleIndex(e,t=0){this.camera.forEachVisiblePosition((s,a)=>{e(this.map.coordToIndex(s,a))},t)}forEachVisibleEntity(e){this.camera.forEachVisiblePosition((t,s)=>{for(let a in this.grids.renderingGrid[s][t])e(this.grids.renderingGrid[s][t][a])},3,6)}forEachLighting(e){for(let t in this.lightings)e(this.lightings[t])}forEachCanvas(e){for(let t in this.canvases)e(this.canvases[t])}forAllContexts(e){for(let t in this.allContexts)e(this.allContexts[t])}forEachContext(e){for(let t in this.contexts)e(this.contexts[t])}}var Ta=`precision highp float;

attribute vec2 aPosition;\r
attribute vec2 aTexture;

uniform float uInverseTileScale;

uniform vec2 uOffset;\r
uniform vec2 uViewportSize;\r
uniform vec2 uInverseLayerTileCount;\r
uniform vec2 uInverseLayerTileSize;

varying vec2 vPixelCoord;\r
varying vec2 vTextureCoord;

void main()\r
{\r
    
    
    vec2 offset = uOffset + (uInverseTileScale / 2.0);\r
    offset -= mod(offset, uInverseTileScale);

    vPixelCoord = (aTexture * uViewportSize) + offset;\r
    vTextureCoord = vPixelCoord * uInverseLayerTileCount * uInverseLayerTileSize;

    gl_Position = vec4(aPosition, 0.0, 1.0);\r
}`,Ru=`precision mediump float;\r

const int uTilesetCount = TILESET_COUNT;

varying vec2 vPixelCoord;\r
varying vec2 vTextureCoord;

uniform sampler2D uLayer;

uniform sampler2D uTilesets[uTilesetCount];

uniform vec2 uTilesetTileSize[uTilesetCount];\r
uniform vec2 uTilesetTileOffset[uTilesetCount];\r
uniform vec2 uInverseTilesetTextureSize[uTilesetCount];\r
uniform float uAlpha;\r
uniform int uRepeatTiles;

const float Flag_FlippedAntiDiagonal = 2.0;\r
const float Flag_FlippedVertical = 4.0;\r
const float Flag_FlippedHorizontal = 8.0;\r
const vec4 c_one4 = vec4(1.0, 1.0, 1.0, 1.0);

float hasFlag(float value, float flag)\r
{\r
    float byteVal = 1.0;

    
    if (value == 0.0)\r
        return 0.0;

    
    for (int i = 0; i < 4; ++i)\r
    {\r
        if (mod(value, 2.0) > 0.0 && mod(flag, 2.0) > 0.0)\r
            return 1.0;

        value = floor(value / 2.0);\r
        flag = floor(flag / 2.0);

        if (!(value > 0.0 && flag > 0.0))\r
            return 0.0;\r
    }

    return 0.0;\r
}

vec2 getTilesetTileSize(int index)\r
{\r
    for (int i = 0; i < uTilesetCount; ++i)\r
        if (i == index)\r
            return uTilesetTileSize[i];

    return vec2(0.0, 0.0);\r
}

vec2 getTilesetTileOffset(int index)\r
{\r
    for (int i = 0; i < uTilesetCount; ++i)\r
        if (i == index)\r
            return uTilesetTileOffset[i];

    return vec2(0.0, 0.0);\r
}

vec4 getColor(int index, vec2 coord) {\r
    for (int i = 0; i < uTilesetCount; ++i)\r
        if (i == index)\r
            return texture2D(uTilesets[i], coord * uInverseTilesetTextureSize[i]);

    return vec4(0.0, 0.0, 0.0, 0.0);\r
}

void main()\r
{\r
    if (uRepeatTiles == 0 && (vTextureCoord.x < 0.0 || vTextureCoord.x > 1.0 || vTextureCoord.y < 0.0 || vTextureCoord.y > 1.0))\r
        discard;

    vec4 tile = texture2D(uLayer, vTextureCoord);

    if (tile == c_one4)\r
        discard;

    float flipFlags = floor(tile.w * 255.0);

    
    
    
    

    int imgIndex = int(floor(tile.z * 255.0));\r
    vec2 tileSize = getTilesetTileSize(imgIndex);\r
    vec2 tileOffset = getTilesetTileOffset(imgIndex);

    vec2 flipVec = vec2(hasFlag(flipFlags, Flag_FlippedHorizontal), hasFlag(flipFlags, Flag_FlippedVertical));

    vec2 tileCoord = floor(tile.xy * 255.0);

    
    tileCoord.x = (tileCoord.x * tileSize.x) + (tileCoord.x * tileOffset.x) + tileOffset.y;\r
    tileCoord.y = (tileCoord.y * tileSize.y) + (tileCoord.y * tileOffset.x) + tileOffset.y;

    vec2 offsetInTile = mod(vPixelCoord, tileSize);\r
    vec2 offsetInTileFlipped = abs((tileSize * flipVec) - offsetInTile);

    
    if (hasFlag(flipFlags, Flag_FlippedAntiDiagonal) == 1.0)\r
    {\r
        float x = offsetInTileFlipped.x;\r
        offsetInTileFlipped.x = offsetInTileFlipped.y;\r
        offsetInTileFlipped.y = x;\r
    }

    vec4 color = getColor(imgIndex, tileCoord + offsetInTileFlipped);

    gl_FragColor = vec4(color.rgb, color.a * uAlpha);\r
}`;class xu extends Cn{backContext=this.background.getContext("webgl");foreContext=this.foreground.getContext("webgl");drawingContexts=[this.backContext,this.foreContext];backShader;foreShader;tilesets={};layers=[];tilesetIndices=new Int32Array;tilesetTileSizeBuffer=new Float32Array;tilesetOffsetBuffer=new Float32Array;inverseTilesetTextureSizeBuffer=new Float32Array;inverseTileCount=new Float32Array(2);backQuadBuffer=this.backContext.createBuffer();foreQuadBuffer=this.foreContext.createBuffer();quadVertices=new Float32Array([-1,-1,0,1,1,-1,1,1,1,1,1,0,-1,-1,0,1,1,1,1,0,-1,1,0,0]);attributeIndices={aPosition:0,aTexture:1};blendMode={func:[WebGLRenderingContext.SRC_ALPHA,WebGLRenderingContext.ONE_MINUS_SRC_ALPHA],equation:WebGLRenderingContext.FUNC_ADD};constructor(e){super(e,"webgl")}load(){let e=this.map.tilesets.length;this.backShader=new Ea(this.backContext,Ta,this.getFragmentShader(e)),this.foreShader=new Ea(this.foreContext,Ta,this.getFragmentShader(e)),this.tilesetIndices=new Int32Array(e),this.tilesetTileSizeBuffer=new Float32Array(e*2),this.tilesetOffsetBuffer=new Float32Array(e*2),this.inverseTilesetTextureSizeBuffer=new Float32Array(e*2);for(let t=0;t<e;t++)this.tilesetIndices[t]=t+1,this.tilesetTileSizeBuffer[t*2]=this.map.tileSize,this.tilesetTileSizeBuffer[t*2+1]=this.map.tileSize,this.tilesetOffsetBuffer[t*2]=0,this.tilesetOffsetBuffer[t*2+1]=0,this.inverseTilesetTextureSizeBuffer[t*2]=1/this.map.tilesets[t].width,this.inverseTilesetTextureSizeBuffer[t*2+1]=1/this.map.tilesets[t].height;this.inverseTileCount[0]=1/this.map.width,this.inverseTileCount[1]=1/this.map.height,this.forEachDrawingContext(t=>{this.tilesets[t.canvas.id]=new vu(this.map,t),this.bindBuffer(t),this.bindTexture(t),this.bindTileShaders(t)})}setTile(e,t){if(this.clearTile(e),!Array.isArray(t))return this.addTile(e,t);for(let s in t)this.addTile(e,t[s],~~s)}bindBuffer(e){e.bindBuffer(e.ARRAY_BUFFER,this.getQuadBuffer(e)),e.bufferData(e.ARRAY_BUFFER,this.quadVertices,e.STATIC_DRAW)}bindTexture(e){for(let t of this.layers)t.bindTexture(e,this.getShader(e)?.program,!this.isBackgroundContext(e))}bindTileShaders(e){let t=this.getShader(e);e.useProgram(t.program);let s=new Float32Array([1/this.map.tileSize,1/this.map.tileSize]);e.uniform1i(t.uniforms.uLayer,0),e.uniform2fv(t.uniforms.uInverseLayerTileSize,s);for(let a=0;a<this.tilesetIndices.length;a++)e.uniform1i(e.getUniformLocation(t.program,`uTilesets[${a}]`),this.tilesetIndices[a]);e.uniform2fv(t.uniforms.uTilesetTileSize,this.tilesetTileSizeBuffer),e.uniform2fv(t.uniforms.uTilesetTileOffset,this.tilesetOffsetBuffer),e.uniform2fv(t.uniforms.uInverseTilesetTextureSize,this.inverseTilesetTextureSizeBuffer)}bindTileLayers(){this.forEachDrawingContext(e=>this.bindTexture(e))}resize(){super.resize(),this.forEachDrawingContext(e=>{let t=new Float32Array([this.screenWidth,this.screenHeight]),s=this.getShader(e);e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.uniform2fv(s.uniforms.uViewportSize,t),e.uniform1f(s.uniforms.uInverseTileScale,1/this.camera.zoomFactor)})}render(){this.draw(),super.render()}draw(e=this.camera.x,t=this.camera.y){this.hasRenderedFrame()&&(this.game.isLowPowerMode()||this.mobile)||(this.forEachDrawingContext(s=>{s.enable(s.BLEND),s.blendEquation(this.blendMode.equation),s.blendFunc(this.blendMode.func[0],this.blendMode.func[1]),s.bindBuffer(s.ARRAY_BUFFER,this.getQuadBuffer(s)),s.enableVertexAttribArray(this.attributeIndices.aPosition),s.enableVertexAttribArray(this.attributeIndices.aTexture),s.vertexAttribPointer(this.attributeIndices.aPosition,2,s.FLOAT,!1,16,0),s.vertexAttribPointer(this.attributeIndices.aTexture,2,s.FLOAT,!1,16,8),this.tilesets[s.canvas.id].forEachTexture((r,o)=>{s.activeTexture(s.TEXTURE1+o),s.bindTexture(s.TEXTURE_2D,r)}),s.activeTexture(s.TEXTURE0);let a=this.getShader(s),n=this.isBackgroundContext(s);s.useProgram(a.program),s.uniform1f(a.uniforms.uAlpha,n?1:1.5),s.uniform1i(a.uniforms.uRepeatTiles,1),s.uniform2fv(a.uniforms.uInverseLayerTileCount,this.inverseTileCount),s.uniform2f(a.uniforms.uOffset,e,t);for(let r of this.layers)r.draw(s,this.game.time,!n,this.game.isLowPowerMode())}),this.saveFrame())}addTile(e,t,s=0){this.layers[s]||(this.layers[s]=new Iu(this)),this.layers[s].addTile(e,t,this.map.isFlipped(t))}clearTile(e){for(let t of this.layers)t.clear(e)}isBackgroundContext(e){return e.canvas.id==="background"}getShader(e){return this.isBackgroundContext(e)?this.backShader:this.foreShader}getQuadBuffer(e){return this.isBackgroundContext(e)?this.backQuadBuffer:this.foreQuadBuffer}getFragmentShader(e){return Ru.replace("TILESET_COUNT",e.toString())}forEachDrawingContext(e){for(let t in this.drawingContexts)e(this.drawingContexts[t])}}class Du extends Cn{animatedTiles={};animatedTileIndexes={};tiles={};cells={};animatedDynamicTiles=[];backContext=this.background.getContext("2d");foreContext=this.foreground.getContext("2d");drawingContexts=[this.backContext,this.foreContext];constructor(e){super(e),this.allContexts.push(this.backContext,this.foreContext)}resize(){super.resize(),this.cells={}}render(){this.stopRendering||(super.render(),this.draw())}draw(){if(this.hasRenderedFrame())return this.drawAnimatedIndexes();this.clearDrawing(),this.saveDrawing(),this.updateDrawingView();for(let e=this.camera.gridY-2;e<this.camera.gridY+this.camera.gridHeight;e++)for(let t=this.camera.gridX-2;t<this.camera.gridX+this.camera.gridWidth;t++){if(this.map.isOutOfBounds(t,e))continue;let s=t+e*this.map.width;this.parseTile(this.map.data[s],s)}this.saveFrame(),this.restoreDrawing()}drawVisibleTile(e,t){let s=this.getFlipped(e);s.length>0&&(e=e.tileId);let a=this.map.isHighTile(e)?this.foreContext:this.backContext;this.game.overlays.hasOverlay()&&(a=this.map.isLightTile(e)?this.overlayContext:a),this.animateTiles&&this.map.isAnimatedTile(e)?this.drawAnimatedTile(e,t,s):this.drawTile(a,e,t,s)}drawAnimatedIndexes(){this.saveDrawing(),this.updateDrawingView();for(let e in this.animatedTileIndexes){let t=this.animatedTiles[e];if(t?.uploaded)continue;let s=this.animatedTileIndexes[e];for(let a of s){let n=this.cells[a];n&&(this.backContext.clearRect(n.dx,n.dy,n.width,n.height),this.foreContext.clearRect(n.dx,n.dy,n.width,n.height)),this.parseTile(this.map.data[a],a)}t.uploaded=!0}this.restoreDrawing()}drawAnimatedTile(e,t,s=[]){if(!this.animateTiles)return;let a=this.map.dynamicAnimatedTiles[t],n=a?`${e}-${t}`:e,r=this.animatedTiles[n];if(!r)return this.addAnimatedTile(e,a?t:-1);if(this.animatedTileIndexes[e]?this.animatedTileIndexes[e].includes(t)||this.animatedTileIndexes[e].push(t):this.animatedTileIndexes[e]=[],r.lastAccessed=this.game.time,s.length===0&&r.isFlipped)return;let o=r.isHighTile?this.foreContext:this.backContext;this.drawTile(o,r.id+1,t,s)}drawTile(e,t,s,a=[]){let n=this.map.getTilesetFromId(t);if(n){if(!(t in this.tiles)){let r=n.width/this.tileSize,o=t-n.firstGid;this.tiles[t]={relativeTileId:o,setWidth:r,x:this.getX(o+1,r)*this.tileSize,y:~~(o/r)*this.tileSize,width:this.tileSize,height:this.tileSize}}(!(s in this.cells)||a.length>0)&&(this.cells[s]={dx:~~(this.getX(s+1,this.map.width)*this.actualTileSize)+1,dy:~~(~~(s/this.map.width)*this.actualTileSize)+1,width:this.ceilActualTileSize,height:this.ceilActualTileSize}),this.drawImage(e,n,this.tiles[t],this.cells[s],a)}}drawImage(e,t,s,a,n=[]){let r=0,o=0,h=n.length>0;if(h){({dx:r,dy:o}=a),e.save();let l=r;for(let d=0;d<n.length;d++)switch(n[d]){case 0:{r=-r-a.width,e.scale(-1,1);break}case 1:{o=-o-a.height,e.scale(1,-1);break}case 2:{e.rotate(Math.PI/2),e.translate(0,-a.height),r=o,o=-l,n[d+1]===0?n.push(0):n.push(1);break}}}e.drawImage(t,s.x,s.y,s.width,s.height,r||a.dx,o||a.dy,a.width,a.height),h&&e.restore()}clearDrawing(){this.forEachDrawingContext(this.clearScreen)}saveDrawing(){this.forEachDrawingContext(e=>e.save())}restoreDrawing(){this.forEachDrawingContext(e=>e.restore())}updateDrawingView(){this.forEachDrawingContext(e=>this.setCameraView(e))}resetAnimatedTiles(){for(let e in this.animatedTiles){let t=this.animatedTiles[e];t.lastTime=Date.now()-t.getDuration()+24,t.animationIndex=0}}addAnimatedTile(e,t=-1){let s=t!==-1,a=s?`${e}-${t}`:e;s&&this.animatedDynamicTiles.includes(a)||(this.animatedTiles[a]=new En(e,t,this.map.getTileAnimation(e),!1,this.map.isHighTile(e),s?this.map.dynamicAnimatedTiles[t]:void 0),s&&this.animatedDynamicTiles.push(a),this.resetAnimatedTiles())}parseTile(e,t){if(e!==0){if(e.tileId)return this.drawVisibleTile(e,t);if(~~e)this.drawVisibleTile(e,t);else for(let s of e)this.drawVisibleTile(s,t)}}getFlipped(e){let t=[];return this.map.isFlipped(e)&&(e.v&&t.push(1),e.d&&t.push(2),e.h&&t.push(0)),t}forEachDrawingContext(e){for(let t in this.drawingContexts)e(this.drawingContexts[t])}}class Yu{constructor(e){this.game=e,this.tileSize=e.map.tileSize,this.sprites=e.sprites,this.renderer=e.renderer}tileSize;renderer;sprites;update(){this.game.player.dead||(this.updateEntities(),this.updateKeyboard(),this.updateAnimations(),this.updateInfos(),this.updateBubbles(),this.updateSounds(),this.updateAnimatedTiles(),this.updateLights())}updateEntities(){this.game.entities.forEachEntity(e=>{if(!e.sprite?.loaded)return;if(this.updateFading(e),e.animation?.update(this.game.time),e.isProjectile()){let r=e.speed*e.getTimeDiff(),o=e.target.x-e.x,h=e.target.y-e.y,l=Math.hypot(o,h),d=r/l;e.updateAngle(),d>1&&(d=1),e.x+=o*d,e.y+=h*d,l<5&&e.impactCallback?.(),e.lastUpdate=this.game.time;return}if(!(e instanceof Le))return;if(e.movement.inProgress)return e.movement.step(this.game.time);if(!e.hasPath())return;let t=e.orientation===A.Left||e.orientation===A.Right,s=e.orientation===A.Up||e.orientation===A.Down,a,n;t&&(a=e.orientation===A.Left),s&&(n=e.orientation===A.Up),e.movement.start(this.game.time,t?e.x+(a?-1:1):e.y+(n?-1:1),t?e.x+(a?-this.tileSize:this.tileSize):e.y+(n?-this.tileSize:this.tileSize),e.movementSpeed,r=>{t&&(e.x=r),s&&(e.y=r),e.moved()},()=>{t&&(e.x=e.movement.endValue),s&&(e.y=e.movement.endValue),e.moved(),e.nextStep()})})}updateFading(e){if(!e.fading)return;let{time:t}=this.game,s=t-e.fadingTime;s>e.fadingDuration?(e.fading=!1,e.fadingAlpha=1):e.fadingAlpha=s/e.fadingDuration}updateKeyboard(){let{player:e,input:t}=this.game,s={x:-1,y:-1,gridX:e.gridX,gridY:e.gridY};e.moving||e.teleporting||e.frozen||!e.hasKeyboardMovement()||(e.moveUp?s.gridY--:e.moveDown?s.gridY++:e.moveRight?s.gridX++:e.moveLeft&&s.gridX--,t.keyMove(s))}updateAnimations(){let e=this.game.input.targetAnimation;e&&this.game.input.selectedCellVisible&&e.update(this.game.time);for(let t of this.sprites?.preloadedAnimations||[])t.update(this.game.time)}updateInfos(){this.game.info.update(this.game.time)}updateBubbles(){this.game.bubble?.update(this.game.time),this.game.pointer?.update()}updateSounds(){this.game.audio.updatePlayerListener()}updateAnimatedTiles(){if(!(!this.renderer.isCanvas()||!this.renderer.animateTiles))for(let e in this.renderer.animatedTiles){let t=this.renderer.animatedTiles[e];if(t.expired&&(this.game.map.data[t.index]=t.postAnimationData),t.unused||t.expired){delete this.renderer.animatedTiles[e],delete this.renderer.animatedTileIndexes[e];continue}t.animate(this.game.time)}}updateLights(){this.renderer.forEachLighting(e=>{let{light:t}=e;t.flickerIntensity<0||(t.distance=t.scaledDistance+Math.sin((this.game.time+t.offset)/t.flickerSpeed)*t.scaledFlickerIntensity)})}}/**
 * A* (A-Star) algorithm for a path finder
 * @author  Andrea Giammarchi
 * @license Mit Style License
 */function Mu(i,e,t,s){let a=i[0].length,n=i.length,r=a*n,o=Math.max,h={},l=[],d=[{x:e[0],y:e[1],f:0,g:0,v:e[0]+e[1]*a}],c=1,u,g,f,y,k={x:t[0],y:t[1],v:t[0]+t[1]*a};switch(s){case"Diagonal":case"Euclidean":g=Pu;case"DiagonalFree":{u=zu;break}case"EuclideanFree":{o=Math.sqrt,u=Bu;break}default:{u=Xu,g=Uu;break}}g||=Fu;do{if(c>100)return[];let T=r,v=0;for(let S=0;S<c;++S){let w=d[S].f;w<T&&(T=w,v=S)}if([f]=d.splice(v,1),f.v===k.v){let S=c=0;do l[S++]=[f.x,f.y];while(f=f.p);l.reverse()}else{--c,y=qu(g,f.x,f.y,i,n,a);for(let S=0,w=y.length;S<w;++S){let E=y[S];E.p=f,E.f=E.g=0,E.v=E.x+E.y*a,E.v in h||(E.f=(E.g=f.g+u(E,f,Math.abs,o))+u(E,k,Math.abs,o),d[c++]=E,h[E.v]=1)}}}while(c);return l}let Pu=(i,e,t,s,a,n,r,o,h,l,d,c,u)=>(i&&(t&&!h[a][r]&&(c[u++]={x:r,y:a}),s&&!h[a][o]&&(c[u++]={x:o,y:a})),e&&(t&&!h[n][r]&&(c[u++]={x:r,y:n}),s&&!h[n][o]&&(c[u++]={x:o,y:n})),c),Fu=(i,e,t,s,a,n,r,o,h,l,d,c,u)=>(i=a>-1,e=n<l,t=r<d,s=o>-1,t&&(i&&!h[a][r]&&(c[u++]={x:r,y:a}),e&&!h[n][r]&&(c[u++]={x:r,y:n})),s&&(i&&!h[a][o]&&(c[u++]={x:o,y:a}),e&&!h[n][o]&&(c[u++]={x:o,y:n})),c),Uu=(i,e,t,s,a,n,r,o,h,l,d,c)=>c;function qu(i,e,t,s,a,n){let r=t-1,o=t+1,h=e+1,l=e-1,d=r>-1&&!s[r][e],c=o<a&&!s[o][e],u=h<n&&!s[t][h],g=l>-1&&!s[t][l],f=[],y=0;return d&&(f[y++]={x:e,y:r}),u&&(f[y++]={x:h,y:t}),c&&(f[y++]={x:e,y:o}),g&&(f[y++]={x:l,y:t}),i(d,c,u,g,r,o,h,l,s,a,n,f,y)}let zu=(i,e,t,s)=>s(t(i.x-e.x),t(i.y-e.y)),Bu=(i,e,t,s)=>{let a=i.x-e.x,n=i.y-e.y;return s(a*a+n*n)},Xu=(i,e,t)=>t(i.x-e.x)+t(i.y-e.y);class Hu{mode="DEFAULT";find(e,t,s,a,n,r=[]){this.handleIgnore(e,r,!0);let o=Mu(e,[t,s],[a,n],this.mode);return this.handleIgnore(e,r),o}handleIgnore(e,t,s=!1){for(let a of t)a.x<0||a.y<0||a.fake||(e[a.y][a.x]===0&&(a.fake=!0),e[a.y][a.x]=s?0:1)}}class Gu{constructor(e){this.app=e,this.storage=e.storage,this.useWebGl=Un()&&this.storage.isWebGl(),this.player=new Ua("",this),this.map=new Gl(this),this.camera=new Mo(this.map.width,this.map.height,this.map.tileSize),this.sprites=new xl,this.renderer=this.useWebGl?new xu(this):new Du(this),this.joystick=new Yl(this),this.menu=new Nl(this),this.input=new il(this),this.socket=new Eu(this),this.updater=new Yu(this),this.audio=new Ro(this),this.entities=new Zo(this),this.bubble=new Po(this.renderer,this.entities),this.pointer=new Ol(this.renderer,this.entities),this.connection=new yu(this),this.map.onReady(()=>{e.ready(),this.renderer.load()}),e.onLogin(this.socket.connect.bind(this.socket)),e.onResize(this.resize.bind(this)),e.onRespawn(this.respawn.bind(this)),this.player.onSync(this.handlePlayerSync.bind(this))}player;storage;map;camera;zoning=new Dl;overlays=new Su;pathfinder=new Hu;info=new Jo;sprites;minigame=new Tu;renderer;input;socket;pointer;updater;audio;entities;bubble;joystick;menu;connection;time=Date.now();timeDiff=Date.now();timeLast=Date.now();targetFPS=1e3/50;timeOffset=0;started=!1;ready=!1;pvp=!1;throttle=!1;useWebGl=!1;start(){this.started||(this.started=!0,this.tick())}tick(){if(this.started&&requestAnimationFrame(()=>this.tick()),this.time=Date.now(),this.throttle){if(this.timeDiff=this.time-this.timeLast,this.timeDiff<this.targetFPS)return;this.timeLast=this.time-this.timeDiff%this.targetFPS}this.updater.update(),this.renderer.render()}handleDisconnection(){this.app.isMenuHidden()&&location.reload()}handlePlayerSync(){this.menu.synchronize(),this.player.setSprite(this.sprites.get(this.player.getSpriteName()))}postLoad(){this.entities.addEntity(this.player),this.player.setSprite(this.sprites.get(this.player.getSpriteName())),this.player.idle(),this.storage&&(this.player.setOrientation(this.storage.data.player.orientation),this.camera.setZoom(this.storage.data.player.zoom),this.renderer.resize(),this.pointer.resize(),this.bubble.resize()),this.camera.centreOn(this.player),this.player.handler=new Ml(this.player),this.socket.send(p.Ready,{regionsLoaded:this.map.regionsLoaded,userAgent:Me}),this.storage.isNew()&&this.menu.getWelcome().show(),this.storage.data.new&&(this.storage.data.new=!1,this.storage.save()),this.map.hasCachedDate()&&this.app.fadeMenu(),this.menu.synchronize(),this.forceRendering()}findPath(e,t,s,a=[],n=""){let r=[];if(r=this.pathfinder.find(this.map.grid,e.gridX,e.gridY,t,s,a),r.length===0)return r;if(n==="fishing"){let o=r.at(-2);this.map.isColliding(o[0],o[1])&&r.pop()}return r}findAdjacentTile(e){this.map.isColliding(e.gridX+1,e.gridY)?this.map.isColliding(e.gridX-1,e.gridY)?this.map.isColliding(e.gridX,e.gridY+1)?this.map.isColliding(e.gridX,e.gridY-1)||e.go(e.gridX,e.gridY-1):e.go(e.gridX,e.gridY+1):e.go(e.gridX-1,e.gridY):e.go(e.gridX+1,e.gridY)}updateCameraBounds(){if(!this.zoning)return;let e=this.player.gridX-this.camera.gridX,t=this.player.gridY-this.camera.gridY;e===0?this.zoning.setLeft():e===this.camera.gridWidth-2?this.zoning.setRight():t===0?this.zoning.setUp():t===this.camera.gridHeight-2&&this.zoning.setDown(),this.zoning.direction!==null&&(this.camera.zone(this.zoning.getDirection()),this.zoning.reset())}respawn(){this.audio.playSound("revive"),this.app.body.classList.remove("death"),this.socket.send(p.Respawn,[])}resize(){this.renderer.resize(),this.pointer.resize(),this.bubble.resize(),this.menu.resize()}getEntityAt(e,t){if(!this.entities)return;let s=this.entities.grids.renderingGrid[t][e],a=Object.keys(s),n=a.indexOf(this.player.instance);return n!==-1&&a.splice(n,1),s[a[0]]}searchForEntityAt(e,t=3){let s=this.entities.grids.getEntitiesAround(e.gridX,e.gridY,t),a;for(let n of s){if(n.isProjectile()||n.isPet()||this.isMainPlayer(n.instance)||n.isResource()&&n.exhausted)continue;let r=n.getBoundingBox(),o=r.x+r.width/2,h=r.y+r.height/2,l=m.distance(e.x,e.y,o,h),d=(n.sprite.width<n.sprite.height?n.sprite.width:n.sprite.height)/2;l>d||(!a||l<a.distance)&&(a=n,a.distance=l)}return a}teleport(e,t,s){this.entities.unregisterPosition(e),e.setGridPosition(t,s),this.entities.registerPosition(e),e.frozen=!1,e.teleporting=!1,e.instance===this.player.instance&&(e.clearHealthBar(),this.player.moving=!1,this.player.disableAction=!1,this.camera.centreOn(this.player)),this.forceRendering()}zoom(e){this.camera.zoom(e),this.storage.setZoom(this.camera.zoomFactor),this.pointer.resize(),this.renderer.resize()}isLowPowerMode(){return!this.camera.isCentered()&&!this.renderer.animateTiles}isMainPlayer(e){return this.player.instance===e}forceRendering(){let e=0,t=setInterval(()=>{this.renderer.forceRendering=!0,e++,e>10&&clearInterval(t)},100)}}let Sa=location.pathname.slice(1,3);Sa&&await Lo(Sa);function Vu(){return window.parent!==window||new URLSearchParams(window.location.search).has("embed")}window.addEventListener("load",()=>{let i=new Oo;Vu()&&(document.body.classList.add("embed-mode"),i.autoLogin()),new Gu(i)});
//# sourceMappingURL=hoisted.ee602cf6.js.map
